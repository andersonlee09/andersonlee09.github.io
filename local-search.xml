<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ReentrantLockæ·±åº¦å‰–æ</title>
    <link href="/2022/03/08/JUC/ReentrantLock%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/"/>
    <url>/2022/03/08/JUC/ReentrantLock%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>åœ¨å¼€å§‹ä¹‹å‰æˆ‘ä»¬å…ˆæ¥å¤§æ¦‚å°†ä¸€è®²å•¥æ˜¯ReentrantLock</p><p>ReentrantLockåŸºäº<strong>AQS</strong>ï¼Œå¯¹äºAQSä¸äº†è§£çš„å¯ä»¥çœ‹<a href="https://andersonlee09.github.io/2022/03/05/JUC/AQS%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/">è¿™é‡Œ</a>ã€‚åœ¨å¹¶å‘ç¼–ç¨‹ä¸­å®ƒå¯ä»¥å®ç°<strong>å…¬å¹³é”</strong>å’Œ<strong>éå…¬å¹³é”</strong>æ¥å¯¹å…±äº«èµ„æºè¿›è¡ŒåŒæ­¥ï¼ŒåŒæ—¶ï¼Œå®ƒä¸synchronizdä¸€æ ·ï¼ŒReentrantLockæ”¯æŒ<strong>å¯é‡å…¥</strong>ï¼Œé™¤æ­¤ä¹‹å¤–ï¼ŒReentrantLockåœ¨<strong>è°ƒåº¦</strong>ä¸Šæ›´åŠ çµæ´»ï¼Œæ”¯æŒæ›´å¤šä¸°å¯Œçš„åŠŸèƒ½ã€‚</p><img src="/2022/03/08/JUC/ReentrantLock%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220308221113973.png" class><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ ¹æ®ä»¥ä¸Šæ€ç»´å¯¼å›¾æ¥è¿›è¡Œè®²è§£ã€‚</p><h2 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h2><img src="/2022/03/08/JUC/ReentrantLock%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220308221251242.png" class><p>å¯ä»¥çœ‹åˆ°ReentrantLockå®ç°äº†Lockæ¥å£ï¼Œé‚£ä»€ä¹ˆ æ˜¯Lockå‘¢ï¼Ÿ</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs mipsasm">&#123;@code Lock&#125; implementations provide more <span class="hljs-keyword">extensive </span>locking operations than can <span class="hljs-keyword">be </span>obtained using &#123;@code <span class="hljs-keyword">synchronized&#125; </span>methods <span class="hljs-keyword">and </span>statements.  They allow more flexible structuring, may have quite <span class="hljs-keyword">different </span>properties, <span class="hljs-keyword">and </span>may support <span class="hljs-keyword">multiple </span>associated &#123;@link Condition &#125; objects.<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯Lockæ¥å£æœ€å¼€å¤´çš„ä¸€æ®µå†…å®¹ï¼Œå®ƒçš„æ„æ€æ˜¯è¯´ï¼š</p><p>{@code Lock} å®ç°äº†åŒºåˆ«äº {@code synchronized} çš„å¦ä¸€ç§å…·æœ‰æ›´å¤šå¹¿æ³›æ“ä½œçš„åŒæ­¥æ–¹å¼ï¼Œå®ƒå…è®¸æ›´çµæ´»çš„ç»“æ„ï¼Œå¯èƒ½æœ‰å®Œå…¨ä¸åŒçš„å±æ€§ï¼Œå¹¶ä¸”å¯èƒ½æ”¯æŒå¤šä¸ªå…³è”çš„ {@link Condition} å¯¹è±¡ã€‚</p><p><img src="/03/08/JUC/ReentrantLock%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/Users\æç‘èˆª\Desktop\image-20220308222000247.png" alt="image-20220308222000247"></p><p>Lockæ–¹æ³•æœ‰å…­ä¸ªæ–¹æ³•</p><p>lockæ–¹æ³•ç”¨äºè·å–é”ï¼ŒåŠ å…¥å½“å‰é”è¢«å…¶ä»–çº¿ç¨‹ï¼Œé‚£å®ƒå°±ä¼šå»ç­‰å¾…ï¼Œç›´åˆ°è·å–é”</p><p>lockInterruptiblyç±»ä¼¼äºlockï¼Œä½†åŒºåˆ«åœ¨äºå‡å¦‚å½“å‰çº¿ç¨‹åœ¨ç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­ï¼Œé‚£å®ƒå°±ä¼šé€€å‡ºç­‰å¾…ï¼Œå¹¶ä¸”æŠ›å‡ºå¼‚å¸¸</p><p>tryLockæ— å‚æ–¹æ³•å°è¯•è·å–é”ï¼Œè¿”å›ä¸ºboolç±»å‹ä»£è¡¨æ˜¯å¦è·å¾—é”</p><p>tryLockæœ‰å‚æ•°æ–¹æ³•ï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…å°è¯•è·å–é”ï¼Œå‡å¦‚ç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸</p><p>unlocké‡Šæ”¾é”</p><p>newConditionæ–¹æ³•æ–°å»ºä¸€ä¸ªç»‘å®šåœ¨å½“å‰Lockä¸Šçš„Conditionå¯¹è±¡ï¼ŒConditionå¯¹è±¡æœ‰ä»€ä¹ˆç”¨ï¼Ÿå®ƒè¡¨ç¤ºä¸€ä¸ªç­‰å¾…çŠ¶æ€ï¼Œè·å¾—é”çº¿ç¨‹åœ¨æŸäº›æ—¶åˆ»éœ€è¦ç­‰å¾…ä¸€äº›æ¡ä»¶å®Œæˆæ‰èƒ½ç»§ç»­è¿è¡Œï¼Œé‚£å®ƒé€šè¿‡awaitæ–¹æ³•æ³¨å†Œåœ¨conditionå¯¹è±¡ä¸Šè¿›è¡Œç­‰å¾…ï¼Œé€šè¿‡conditionå¯¹è±¡çš„signalæ–¹æ³•å°†å…¶å”¤é†’ï¼Œè¿™ä¸€ç‚¹ç±»ä¼¼äºObjectçš„waitæ–¹æ³•å’Œnotifyæ–¹æ³•ã€‚ä½†ä¸åŒçš„æ˜¯ä¸€ä¸ªLockå¯¹è±¡å¯ä»¥å…³è”å¤šä¸ªConditionã€‚å¤šä¸ªçº¿ç¨‹å¯ä»¥è¢«ç»‘å®šåœ¨ä¸åŒçš„Conditionå¯¹è±¡å®ç°åˆ†ç»„åŠŸèƒ½ã€‚</p><h2 id="Sync"><a href="#Sync" class="headerlink" title="Sync"></a>Sync</h2><p>ReentrantLockåªæœ‰ä¸€ä¸ªå±æ€§ï¼šsyncï¼Œå®ƒfinalä¿®é¥°ï¼Œä¸€æ—¦åˆå§‹åŒ–ï¼Œå°±ä¸èƒ½è¢«ä¿®æ”¹ã€‚</p><img src="/2022/03/08/JUC/ReentrantLock%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220308223528777.png" class><p>Syncç»§æ‰¿AQS</p><img src="/2022/03/08/JUC/ReentrantLock%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220308223457935.png" class><p>Syncæœ‰ä¸¤ä¸ªå­ç±»ï¼Œä¸€ä¸ªNonfairSyncä¸€ä¸ªFairSync.</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹Syncçš„nonfairTryAcquireæ–¹æ³•ï¼Œå³ä¸å…¬å¹³è·å–é”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ReservedStackAccess</span><br><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">nonfairTryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> &#123;<br>    <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();<br>    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, acquires)) &#123;<br>            setExclusiveOwnerThread(current);<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;<br>        <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>) <span class="hljs-comment">// overflow</span><br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Maximum lock count exceeded&quot;</span>);<br>        setState(nextc);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®ƒé¦–å…ˆè·å–state,è¿™é‡Œçš„stateä¸AQSä¸­stateä¸€æ ·ï¼Œç”¨äºè¡¨ç¤ºå½“å‰çº¿ç¨‹çŠ¶æ€</p><p>å®ƒå…ˆåˆ¤æ–­ å½“stateä¸º0ï¼Œè¡¨ç¤ºé”æ˜¯ç©ºé—²çš„ï¼Œä¾¿å¯ä»¥è¿›è¡Œä¸€æ¬¡CASæ¥åŸå­åœ°æ›´æ”¹stateï¼Œå¦‚æœè·å–æˆåŠŸï¼Œé‚£å°±setExclusiveOwnerThreadå°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºç‹¬å çº¿ç¨‹ï¼Œå¹¶ä¸”è¿”å›true</p><p>å½“stateä¸ä¸º0ï¼Œå®ƒä¼šå»åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æ˜¯ç‹¬å çº¿ç¨‹ï¼Œä¸ºä»€ä¹ˆè¦è¿›ä¸€æ­¥åˆ¤æ–­å‘¢ï¼Ÿè¿™å°±æ˜¯å¯¹<strong>å¯é‡å…¥</strong>çš„å®ç°ï¼Œè¿™é‡Œåˆ¤æ–­çš„æ˜¯ç‹¬å é”çš„äººæ˜¯ä¸æ˜¯è‡ªå·±ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£å°±å°è¯•è·å–å¤±è´¥ï¼Œè¿”å›flaseã€‚å¦‚æœæ­£æ˜¯è‡ªå·±ï¼Œé‚£å°±èƒ½å¤Ÿæ»¡è¶³å¯é‡å…¥æ€§ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™éœ€è¦ç´¯åŠ stateæ¥è®°å½•é‡å…¥çš„æ¬¡æ•°,å› ä¸ºå®ƒéœ€è¦é‡Šæ”¾ç›¸åŒæ¬¡æ•°ã€‚</p><p>è¿™é‡Œå®ƒåˆ¤æ–­äº†ä¸€æ¬¡state&lt;0ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢é‡å…¥çš„æ¬¡æ•°è¿‡å¤šé€ æˆæ•´æ•°æº¢å‡ºï¼Œæ‰€ä»¥å®ƒé‡å…¥æœ€å¤§æ¬¡æ•°ä¸º2^31-1ï¼Œè¿™é‡Œä¸å¾—ä¸æ„Ÿå¹ä¸€å¥ï¼Œè®¾è®¡æ¡†æ¶çš„äººå¯¹äºç»†èŠ‚çš„æŠŠæ¡çœŸçš„å¾ˆåˆ°ä½ã€‚</p><blockquote><p> å¯é‡å…¥æŒ‡çš„æ˜¯ï¼šå•ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œé‡æ–°è¿›å…¥åŒä¸€ä¸ªå­ç¨‹åºä»ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒAåœ¨æŸä¸Šä¸‹æ–‡è·å¾—äº†æŸé”ï¼Œå½“Aæƒ³å†æ¬¡è·å¾—é”çš„æ—¶å€™ï¼Œä¸ä¼šå› ä¸ºé”å·²ç»è¢«è‡ªå·±å ç”¨ï¼Œè€Œéœ€è¦å…ˆå»ç­‰å¾…é”çš„é‡Šæ”¾ã€‚Aå¦‚æœå·²ç»è·å¾—äº†é”ï¼Œåˆå»ç­‰å¾…è‡ªå·±é‡Šæ”¾é”ï¼Œå°±ä¼šé€ æˆæ­»é”ã€‚ç®€å•çš„æ¥è¯´å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å¯ä»¥ä¸ç”¨é‡Šæ”¾ï¼Œè·å¾—ä¸€ä¸ªé”Næ¬¡ã€‚ä½†æ˜¯å®ƒéœ€è¦é‡Šæ”¾Næ¬¡ã€‚</p></blockquote><p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹Syncçš„tryReleaseæ–¹æ³•ï¼Œå³å°è¯•é‡Šæ”¾é”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@ReservedStackAccess</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState() - releases;<br>    <span class="hljs-keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();<br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">free</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) &#123;<br>        free = <span class="hljs-literal">true</span>;<br>        setExclusiveOwnerThread(<span class="hljs-literal">null</span>);<br>    &#125;<br>    setState(c);<br>    <span class="hljs-keyword">return</span> free;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„è¿”å›å€¼æŒ‡çš„æ˜¯é‡Šæ”¾å®Œå…¨é‡Šæ”¾ï¼Œè€Œä¸æ˜¯æ˜¯å¦æˆåŠŸé‡Šæ”¾ä¸€æ¬¡ã€‚</p><h2 id="å…¬å¹³å’Œéå…¬å¹³é”"><a href="#å…¬å¹³å’Œéå…¬å¹³é”" class="headerlink" title="å…¬å¹³å’Œéå…¬å¹³é”"></a>å…¬å¹³å’Œéå…¬å¹³é”</h2><p>å…¬å¹³é”ï¼šæŒ‰é”çš„è¯·æ±‚é¡ºåºè¿›è¡Œæ’é˜Ÿï¼Œæ‹¥æœ‰ç¨³å®šè·å–é”çš„æœºä¼šï¼Œä½†æ€§èƒ½æ¯”è¾ƒä½ã€‚AQSçš„FIFOé˜Ÿåˆ—å°±å¯ä»¥å®ç°ã€‚</p><p>éå…¬å¹³é”ï¼šä¸ä¸€å®šæŒ‰ç…§é”çš„è¯·æ±‚é¡ºåºè¿›è¡Œåˆ†é…ï¼Œä½†æ˜¯æ€§èƒ½é«˜ã€‚å› ä¸ºåè¯·æ±‚é”çš„çº¿ç¨‹å¯èƒ½åœ¨å‰é¢ä¼‘çœ çº¿ç¨‹æ¢å¤å‰å°±æ‹¿åˆ°é”ï¼Œè¿™æ ·å¯ä»¥æé«˜æ€§èƒ½ã€‚çº¿ç¨‹é—´çš„åˆ‡æ¢å¯èƒ½ä¼šé€ æˆå»¶æ—¶ã€‚</p><h2 id="NonfairSync"><a href="#NonfairSync" class="headerlink" title="NonfairSync"></a>NonfairSync</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">7316153563782823691L</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> &#123;<br>        <span class="hljs-keyword">return</span> nonfairTryAcquire(acquires);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å®ƒåªæ˜¯é‡å†™äº†tryAcquireæ–¹æ³•ï¼Œè¿™é‡Œçš„nonfairTryAcquireæˆ‘ä»¬åœ¨ä¸Šé¢å·²ç»è®²è¿‡ï¼Œè¿™é‡Œä¸è¿›è¡Œèµ˜è¿°ã€‚</p><h2 id="FairSync"><a href="#FairSync" class="headerlink" title="FairSync"></a>FairSync</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> -<span class="hljs-number">3000897897090466540L</span>;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Fair version of tryAcquire.  Don&#x27;t grant access unless</span><br><span class="hljs-comment">     * recursive call or no waiters or is first.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@ReservedStackAccess</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> getState();<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">if</span> (!hasQueuedPredecessors() &amp;&amp;<br>                compareAndSetState(<span class="hljs-number">0</span>, acquires)) &#123;<br>                setExclusiveOwnerThread(current);<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">nextc</span> <span class="hljs-operator">=</span> c + acquires;<br>            <span class="hljs-keyword">if</span> (nextc &lt; <span class="hljs-number">0</span>)<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Maximum lock count exceeded&quot;</span>);<br>            setState(nextc);<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å®ƒåªæ˜¯é‡å†™äº†tryAcquireæ–¹æ³•ï¼Œä½†é‡å†™æ–¹å¼ç•¥æœ‰ä¸åŒï¼Œé€»è¾‘å¦‚ä¸‹ï¼š</p><p>å¦‚æœé”æ˜¯ç©ºé—²çš„ï¼Œä¸”FIFOé˜Ÿåˆ—ä¸­æ²¡æœ‰æ’åœ¨å½“å‰çº¿ç¨‹ä¹‹å‰çš„çº¿ç¨‹ï¼Œé‚£å°±å…è®¸å½“å‰çº¿ç¨‹å»å°è¯•è·å–é”ã€‚å¦‚æœæ˜¯å½“å‰çº¿ç¨‹æ­£åœ¨ä½¿ç”¨é”é‚£å°±stateè¿›è¡Œç´¯åŠ ï¼Œå¦åˆ™ç›´æ¥è¿”å›false</p><h2 id="ReentrantLock"><a href="#ReentrantLock" class="headerlink" title="ReentrantLock"></a>ReentrantLock</h2><p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥å®ç°çš„å·²ç»å®ç°çš„å·®ä¸å¤šäº†ï¼ŒReentrantLockç›´æ¥è°ƒç”¨FairSyncã€NonfairSyncå°±å¯ä»¥äº†ã€‚</p><img src="/2022/03/08/JUC/ReentrantLock%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220308231815738.png" class><p>ReentrantLockå®ç°äº†ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œæ— å‚ä¸ºéå…¬å¹³æ¨¡å¼ï¼Œ</p><h2 id="Javaä¸­æ–­æœºåˆ¶"><a href="#Javaä¸­æ–­æœºåˆ¶" class="headerlink" title="Javaä¸­æ–­æœºåˆ¶"></a>Javaä¸­æ–­æœºåˆ¶</h2><img src="/2022/03/08/JUC/ReentrantLock%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220308232322877.png" class><p>å‡å¦‚ç°åœ¨æœ‰ä¸€æ¡çº¿ç¨‹æ­£åœ¨è¿è¡Œä¸­ï¼Œä½ å¯¹å®ƒè°ƒç”¨interruptæ–¹æ³•ï¼Œé‚£å®ƒä¼šç»§ç»­è¿è¡Œï¼Œå¹¶ä¸ä¼šæŠ›å‡ºä¸­æ–­å¼‚å¸¸ã€‚è€Œæ˜¯ä¿®æ”¹threadå¯¹è±¡çš„ä¸€ä¸ªä¸­æ–­çŠ¶æ€booleanå€¼ï¼Œtrueä»£è¡¨è¢«ä¸­æ–­ï¼Œfalseè¡¨ç¤ºæœªè¢«ä¸­æ–­ã€‚isinterruptedä¼šè¿”å›è¿™ä¸ªçŠ¶æ€å€¼ï¼Œisinterruptedä¼šè¿”å›è¿™ä¸ªçŠ¶æ€å€¼ï¼Œå¹¶å°†å…¶æ”¹ä¸ºfalseã€‚</p><p>å¦‚æœéœ€è¦è§‚å¯ŸæŸä¸ªçº¿ç¨‹åœ¨RunnableçŠ¶æ€ä¸‹ä¸­æ–­çŠ¶æ€ï¼Œå¯ä»¥ç”¨isinterruptedæ–¹æ³•ã€‚åˆå‡å¦‚ç°åœ¨æœ‰ä¸€æ¡çº¿ç¨‹ï¼Œå®ƒçš„çŠ¶æ€æ—¶blockedæˆ–waitingä¹Ÿå°±æ˜¯é˜»å¡æˆ–è€…ç­‰å¾…ï¼Œå¦‚æœæ­¤æ—¶å¯¹å®ƒè¿›è¡Œinterruptï¼Œå¦‚æœçº¿ç¨‹æ˜¯è°ƒç”¨sleep\wait\joinæ–¹æ³•è¿›å…¥çš„é˜»å¡æˆ–è€…ç­‰å¾…ï¼Œé‚£å°±ä¼šæŠ›å‡ºä¸­æ–­å¼‚å¸¸ï¼Œå‡å¦‚æ˜¯é€šè¿‡LockSupport.parkæ–¹æ³•è¿›å…¥é˜»å¡çŠ¶æ€è¢«interruptæ—¶ï¼Œé‚£å®ƒä¸ä¼šå‘ç”Ÿå¼‚å¸¸ï¼Œè€Œæ—¶æ”¹å˜çº¿ç¨‹çŠ¶æ€çš„å€¼ã€‚</p><p>å†™è¿™ç¯‡æ–‡ç« æˆ‘å¤§æ¦‚ç”¨äº†ä¸¤ä¸ªå°æ—¶ï¼Œå®å±ä¸æ˜“ï¼Œå¦‚æœå¤§å®¶æœ‰ä»€ä¹ˆå¼‚è®®è¿˜è¯·æå‡º~</p>]]></content>
    
    
    <categories>
      
      <category>JUC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JUC</tag>
      
      <tag>ReentrantLock</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CopyOnWriteArrayList</title>
    <link href="/2022/03/08/Java%E9%9B%86%E5%90%88/CopyOnWriteArrayList/"/>
    <url>/2022/03/08/Java%E9%9B%86%E5%90%88/CopyOnWriteArrayList/</url>
    
    <content type="html"><![CDATA[<p>ä¸Šæ¬¡CVTEé¢è¯•çš„æ—¶å€™ï¼Œé¢è¯•å®˜é—®æˆ‘ArrayListæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</p><p>æˆ‘å›ç­”ï¼šä¸æ˜¯</p><p>ä»–è¯´å‡è®¾æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªåœºæ™¯éœ€è¦ç”¨é›†åˆå¹¶ä¸”è¦çº¿ç¨‹å®‰å…¨ï¼Œæœ‰ä»€ä¹ˆæ–¹æ³•</p><p>æˆ‘ä¼šçš„ï¼šå¯ä»¥åŠ synchronizedé”ï¼Œæˆ–è€…ç”¨CASçš„æ–¹æ³•</p><p>ä»–é—®æˆ‘æœ‰æ²¡æœ‰å®‰å…¨çš„å®¹å™¨</p><p>æˆ‘æƒ³äº†æƒ³ï¼Œç¡®å®æˆ‘ä¸çŸ¥é“ï¼Œç„¶åGäº†</p><p>åé¢æˆ‘å¤ç›˜äº†ä¸€ä¸‹ï¼Œå‘ç°å®‰å…¨çš„å®¹å™¨æœ‰vectorå’ŒCopyOnWriteArrayListï¼Œvectoræˆ‘æœ¬æ¥å°±çŸ¥é“ï¼Œä½†æ˜¯å®ƒå‡ ä¹å·²ç»è¢«å¼ƒç”¨äº†ï¼Œæ‰€ä»¥æˆ‘æ²¡æœ‰è¯´ï¼Œä»Šå¤©æˆ‘ä»¬æ¥å¥½å¥½æ‰’ä¸€æ‰’è¿™ä¸ªCopyOnWriteArrayList</p><p>CopyOnWriteArrayListå¹¶å‘å®¹å™¨ç”¨äºè¯»å¤šå†™å°‘çš„å¹¶å‘åœºæ™¯ã€‚</p><ul><li>çº¿ç¨‹å®‰å…¨çš„ArrayList</li><li>å†™æœ‰é”ï¼Œè¯»æ— é”è¯»å†™ä¹‹é—´ä¸é˜»å¡ï¼Œä¼˜äºè¯»å†™é”</li><li>å†™å…¥æ—¶ï¼Œå…ˆcopyä¸€ä¸ªå‰¯æœ¬å®¹å™¨ï¼Œå†æ·»åŠ æ–°å…ƒç´ ï¼Œæœ€åæ›¿æ¢å¼•ç”¨</li><li>ä½¿ç”¨æ–¹å¼ä¸ArrayListæ— å¼‚</li></ul><p>ä¸‹é¢æˆ‘ä»¬å…ˆæ¥åˆ†æä¸€ä¸‹addæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">add</span><span class="hljs-params">(E e)</span> &#123;<br>    <span class="hljs-keyword">synchronized</span> (lock) &#123;<br>        Object[] es = getArray();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> es.length;<br>        es = Arrays.copyOf(es, len + <span class="hljs-number">1</span>);<br>        es[len] = e;<br>        setArray(es);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®ƒå…ˆç”¨synchronizedæŠŠå®¹å™¨é”ä½ï¼Œç„¶åå…ˆæŠŠåŸæ¥çš„å®¹å™¨ç»™å¤åˆ¶ä¸€ä»½ï¼Œå¤åˆ¶åˆ°esï¼Œç„¶åæŠŠesçš„æœ€åä¸€ä¸ªå…ƒç´ æ·»åŠ e,æœ€åæŠŠåŸæ•°ç»„å¼•ç”¨æŒ‡å‘esï¼Œè¿™æ ·å°±ğŸ†—äº†</p><p>ä¸‹é¢çœ‹ä¸€ä¸‹getæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> E <span class="hljs-title function_">get</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span> &#123;<br>    <span class="hljs-keyword">return</span> elementAt(getArray(), index);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªgetæ–¹æ³•éå¸¸æœ´ç´ ï¼Œæ²¡æœ‰ä»»ä½•é”ï¼Œç›´æ¥è¿”å›ä¸‹æ ‡æ‰€åœ¨çš„å€¼</p><p>æ‰€ä»¥ç›¸è¾ƒäºæˆ‘ä»¬è‡ªå·±åŠ çš„è¯»å†™é”ï¼Œå®ƒåªæœ‰åœ¨å†™çš„æ—¶å€™åŠ é”ï¼Œè¿™æ ·æ•ˆç‡ä¼šæ¯”è¾ƒé«˜ä¸€ç‚¹</p><p>ä¸‹é¢çœ‹ä¸€ä¸‹removeæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> E <span class="hljs-title function_">remove</span><span class="hljs-params">(<span class="hljs-type">int</span> index)</span> &#123;<br>    <span class="hljs-keyword">synchronized</span> (lock) &#123;<br>        Object[] es = getArray();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> es.length;<br>        <span class="hljs-type">E</span> <span class="hljs-variable">oldValue</span> <span class="hljs-operator">=</span> elementAt(es, index);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">numMoved</span> <span class="hljs-operator">=</span> len - index - <span class="hljs-number">1</span>;<br>        Object[] newElements;<br>        <span class="hljs-keyword">if</span> (numMoved == <span class="hljs-number">0</span>)<br>            newElements = Arrays.copyOf(es, len - <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">else</span> &#123;<br>            newElements = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[len - <span class="hljs-number">1</span>];<br>            System.arraycopy(es, <span class="hljs-number">0</span>, newElements, <span class="hljs-number">0</span>, index);<br>            System.arraycopy(es, index + <span class="hljs-number">1</span>, newElements, index,<br>                             numMoved);<br>        &#125;<br>        setArray(newElements);<br>        <span class="hljs-keyword">return</span> oldValue;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å®ƒçš„removeæ–¹æ³•ç±»ä¼¼ï¼Œå®ƒè¿™é‡Œéå¸¸ç»†èŠ‚ï¼Œå¦‚æœnumMoved &#x3D;&#x3D; 0å³åˆ é™¤çš„å…ƒç´ ä¸ºæœ€åä¸€ä¸ªï¼Œé‚£å°±ç›´æ¥å¤åˆ¶ä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œå¦åˆ™å°±ä»åˆ é™¤å¤„åˆ†å‰²ä¸€ä¸‹ï¼Œå¤åˆ¶ä¸¤æ¬¡ã€‚</p><p><strong>æ€»ç»“</strong></p><p>CopyOnWriteArrayListå†™æ“ä½œæ˜¯åœ¨é”çš„ä¿æŠ¤ä¸‹è¿›è¡Œçš„ï¼Œè¿™æ ·å¯ä»¥é¿å…åœ¨é«˜å¹¶å‘addçš„æ—¶å€™ï¼Œå¤åˆ¶å¤šä¸ªå‰¯æœ¬å‡ºæ¥ï¼ŒæŠŠæ•°æ®æä¹±ï¼Œå¯¼è‡´æœ€ç»ˆæ•°æ®ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„</p><p>ç”±äºæ‰€æœ‰é”æ“ä½œéƒ½æ˜¯åœ¨å†™çš„æ—¶å€™è¿›è¡Œï¼Œåˆ†ä»¥ä¸‹å‡ ç§æƒ…å†µ</p><ul><li>å†™æ“ä½œæœªå®Œæˆ</li></ul><p>ç›´æ¥è¯»å–åŸæ•°æ®</p><ul><li>å†™æ“ä½œå·²ç»å®Œæˆï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æŒ‡å‘æ–°çš„æ•°ç»„</li></ul><p>é‚£ä¹Ÿæ˜¯è¯»å–åŸæ•°ç»„</p><ul><li>å†™æ“ä½œå·²ç»å®Œæˆä¸”æŒ‡å‘æ–°æ•°ç»„</li></ul><p>é‚£å°±ä»æ–°æ•°ç»„ä¸­è¯»å–æ•°æ®</p><p>æœ€åæ€»ç»“ä¸€ä¸‹CopyOnWriteArrayListçš„æ€æƒ³</p><ol><li>è¯»å†™åˆ†ç¦»ï¼Œè¯»å’Œå†™åˆ†å¼€</li><li>æœ€ç»ˆä¸€è‡´æ€§</li><li>ä½¿ç”¨å¦å¤–å¼€è¾Ÿç©ºé—´çš„æ€è·¯ï¼Œæ¥è§£å†³å¹¶å‘å†²çª</li></ol><p>æœ€åé¡ºå¸¦æä¸€å¥ï¼Œæˆ‘åœ¨å†™è¿™ä¸ªæ–‡ç« ä¹‹å‰çœ‹è¿‡å¾ˆå¤šè§£æï¼Œéƒ½è¯´ä»€ä¹ˆè¯»å†™åˆ†ç¦»ï¼Œè¿˜å›¾æ–‡å¹¶èŒ‚ï¼Œä½†éƒ½ä¸å¦‚æˆ‘ç›´æ¥çœ‹æºç æ¥çš„æ¸…æ™°ï¼Œæ‰€ä»¥æˆ‘éå¸¸é¼“åŠ±å¤§å®¶å»è¯»æºç ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Javaé›†åˆ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Javaé›†åˆ</tag>
      
      <tag>CopyOnWriteArrayList</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RedisåŸºç¡€</title>
    <link href="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/"/>
    <url>/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><h3 id="è¿æ¥redisé‡åˆ°çš„é—®é¢˜"><a href="#è¿æ¥redisé‡åˆ°çš„é—®é¢˜" class="headerlink" title="è¿æ¥redisé‡åˆ°çš„é—®é¢˜"></a>è¿æ¥redisé‡åˆ°çš„é—®é¢˜</h3><p><a href="https://www.cnblogs.com/invban/p/14187524.html">https://www.cnblogs.com/invban/p/14187524.html</a></p><h2 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h2><p>å®‰è£…å®Œæˆåï¼Œåœ¨ä»»æ„ç›®å½•è¾“å…¥redis-serverå‘½ä»¤å³å¯å¯åŠ¨Redisï¼š</p><figure class="highlight axapta"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs axapta">redis-<span class="hljs-keyword">server</span><br></code></pre></td></tr></table></figure><p>Rediså®‰è£…å®Œæˆåå°±è‡ªå¸¦äº†å‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼šredis-cliï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">redis-cli [options] [commonds]<br></code></pre></td></tr></table></figure><p>å…¶ä¸­å¸¸è§çš„optionsæœ‰ï¼š</p><ul><li><code>-h 127.0.0.1</code>ï¼šæŒ‡å®šè¦è¿æ¥çš„redisèŠ‚ç‚¹çš„IPåœ°å€ï¼Œé»˜è®¤æ˜¯127.0.0.1</li><li><code>-p 6379</code>ï¼šæŒ‡å®šè¦è¿æ¥çš„redisèŠ‚ç‚¹çš„ç«¯å£ï¼Œé»˜è®¤æ˜¯6379</li><li><code>-a 123321</code>ï¼šæŒ‡å®šredisçš„è®¿é—®å¯†ç </li></ul><h2 id="Redisæ•°æ®ç±»å‹"><a href="#Redisæ•°æ®ç±»å‹" class="headerlink" title="Redisæ•°æ®ç±»å‹"></a>Redisæ•°æ®ç±»å‹</h2><ul><li>String: å­—ç¬¦ä¸²</li><li>Hash: æ•£åˆ—</li><li>List: åˆ—è¡¨</li><li>Set: é›†åˆ</li><li>Sorted Set: æœ‰åºé›†åˆ</li></ul><h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>Stringç±»å‹çš„ä¸‰ç§æ ¼å¼ï¼š</p><ul><li><p>å­—ç¬¦ä¸²</p></li><li><p>int</p></li><li><p>float</p></li></ul><p>lSETï¼šæ·»åŠ æˆ–è€…ä¿®æ”¹å·²ç»å­˜åœ¨çš„ä¸€ä¸ªStringç±»å‹çš„é”®å€¼å¯¹</p><p>lGETï¼šæ ¹æ®keyè·å–Stringç±»å‹çš„value</p><p>lMSETï¼šæ‰¹é‡æ·»åŠ å¤šä¸ªStringç±»å‹çš„é”®å€¼å¯¹</p><p>lMGETï¼šæ ¹æ®å¤šä¸ªkeyè·å–å¤šä¸ªStringç±»å‹çš„value</p><p>DEL : åˆ é™¤é”®å€¼å¯¹</p><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308161749004.png" class><h3 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h3><p>Hashç±»å‹ï¼Œä¹Ÿå«æ•£åˆ—ï¼Œå…¶valueæ˜¯ä¸€ä¸ªæ— åºå­—å…¸ï¼Œç±»ä¼¼äºJavaä¸­çš„HashMapç»“æ„ã€‚</p><p>Stringç»“æ„æ˜¯å°†å¯¹è±¡åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²åå­˜å‚¨ï¼Œå½“éœ€è¦ä¿®æ”¹å¯¹è±¡æŸä¸ªå­—æ®µæ—¶å¾ˆä¸æ–¹ä¾¿ï¼š</p><p>Hashç»“æ„å¯ä»¥å°†å¯¹è±¡ä¸­çš„æ¯ä¸ªå­—æ®µç‹¬ç«‹å­˜å‚¨ï¼Œå¯ä»¥é’ˆå¯¹å•ä¸ªå­—æ®µåšCRUDï¼š</p><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308162117682.png" class><p>lHSET key field valueï¼šæ·»åŠ æˆ–è€…ä¿®æ”¹hashç±»å‹keyçš„fieldçš„å€¼</p><p>lHGET key fieldï¼šè·å–ä¸€ä¸ªhashç±»å‹keyçš„fieldçš„å€¼</p><p>lHMSETï¼šæ‰¹é‡æ·»åŠ å¤šä¸ªhashç±»å‹keyçš„fieldçš„å€¼</p><p>lHMGETï¼šæ‰¹é‡è·å–å¤šä¸ªhashç±»å‹keyçš„fieldçš„å€¼</p><p>lHGETALLï¼šè·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„fieldå’Œvalue</p><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308162358308.png" class><h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><p>Redisä¸­çš„Listç±»å‹ä¸Javaä¸­çš„LinkedListç±»ä¼¼ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ç»“æ„ã€‚æ—¢å¯ä»¥æ”¯æŒæ­£å‘æ£€ç´¢å’Œä¹Ÿå¯ä»¥æ”¯æŒåå‘æ£€ç´¢ã€‚</p><p>ç‰¹å¾ä¹Ÿä¸LinkedListç±»ä¼¼ï¼š</p><ul><li><p>æœ‰åº</p></li><li><p>å…ƒç´ å¯ä»¥é‡å¤</p></li><li><p>æ’å…¥å’Œåˆ é™¤å¿«</p></li><li><p>æŸ¥è¯¢é€Ÿåº¦ä¸€èˆ¬</p></li></ul><p>å¸¸ç”¨æ¥å­˜å‚¨ä¸€ä¸ªæœ‰åºæ•°æ®ï¼Œä¾‹å¦‚ï¼šæœ‹å‹åœˆç‚¹èµåˆ—è¡¨ï¼Œè¯„è®ºåˆ—è¡¨ç­‰ã€‚</p><p>lLPUSH key element â€¦ ï¼šå‘åˆ—è¡¨å·¦ä¾§æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </p><p>lLPOP keyï¼šç§»é™¤å¹¶è¿”å›åˆ—è¡¨å·¦ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰åˆ™è¿”å›nil</p><p>lRPUSH key element â€¦ ï¼šå‘åˆ—è¡¨å³ä¾§æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </p><p>lRPOP keyï¼šç§»é™¤å¹¶è¿”å›åˆ—è¡¨å³ä¾§çš„ç¬¬ä¸€ä¸ªå…ƒç´ </p><p>lLRANGE key star endï¼šè¿”å›ä¸€æ®µè§’æ ‡èŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ </p><p>lBLPOPå’ŒBRPOPï¼šä¸LPOPå’ŒRPOPç±»ä¼¼ï¼Œåªä¸è¿‡åœ¨æ²¡æœ‰å…ƒç´ æ—¶ç­‰å¾…æŒ‡å®šæ—¶é—´ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›nil</p><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308162613985.png" class><h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><p>Redisçš„Setç»“æ„ä¸Javaä¸­çš„HashSetç±»ä¼¼ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªvalueä¸ºnullçš„HashMapã€‚å› ä¸ºä¹Ÿæ˜¯ä¸€ä¸ªhashè¡¨ï¼Œå› æ­¤å…·å¤‡ä¸HashSetç±»ä¼¼çš„ç‰¹å¾ï¼š</p><ul><li><p>æ— åº</p></li><li><p>å…ƒç´ ä¸å¯é‡å¤</p></li><li><p>æŸ¥æ‰¾å¿«</p></li><li><p>æ”¯æŒäº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰åŠŸèƒ½</p></li></ul><p>lSADD key member â€¦ ï¼šå‘setä¸­æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </p><p>lSREM key member â€¦ : ç§»é™¤setä¸­çš„æŒ‡å®šå…ƒç´ </p><p>lSCARD keyï¼š è¿”å›setä¸­å…ƒç´ çš„ä¸ªæ•°</p><p>lSISMEMBER key memberï¼šåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºsetä¸­</p><p>lSMEMBERSï¼šè·å–setä¸­çš„æ‰€æœ‰å…ƒç´ </p><p>lSINTER key1 key2 â€¦ ï¼šæ±‚key1ä¸key2çš„äº¤é›†</p><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308162926178.png" class><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308164338195.png" class><h2 id="Javaè¿æ¥Redis"><a href="#Javaè¿æ¥Redis" class="headerlink" title="Javaè¿æ¥Redis"></a>Javaè¿æ¥Redis</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>redis.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jedis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.7.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestConnection</span> &#123;<br>    <span class="hljs-keyword">private</span> Jedis jedis;<br>    <span class="hljs-meta">@BeforeEach</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUp</span><span class="hljs-params">()</span> &#123;    <span class="hljs-comment">// å»ºç«‹è¿æ¥</span><br>        jedis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jedis</span>(<span class="hljs-string">&quot;192.168.23.131&quot;</span>, <span class="hljs-number">6379</span>);<br>        System.out.println(jedis.ping());<br>        <span class="hljs-comment">// è®¾ç½®å¯†ç </span><br><span class="hljs-comment">//        jedis.auth(&quot;xxxx&quot;);</span><br>        <span class="hljs-comment">// é€‰æ‹©åº“</span><br>        jedis.select(<span class="hljs-number">0</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">TestConnection</span> <span class="hljs-variable">testConnection</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestConnection</span>();<br>        testConnection.setUp();<br>        testConnection.testString();<br>        testConnection.tearDown();<br>    &#125;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testString</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;start&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> jedis.set(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;ander&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;res = &quot;</span> + res);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> jedis.get(<span class="hljs-string">&quot;name&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;name = &quot;</span> + name);<br>    &#125;<br></code></pre></td></tr></table></figure><h2 id="Spring-Boot-æ•´åˆRedis"><a href="#Spring-Boot-æ•´åˆRedis" class="headerlink" title="Spring Boot æ•´åˆRedis"></a>Spring Boot æ•´åˆRedis</h2><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308185546271.png" class><p>pom.xmlé‡ŒåŠ å…¥è¿™ä¸ª</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-comment">&lt;!--      è¿æ¥æ± ä¾èµ–--&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.commons<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-pool2<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">redis:</span><br>    <span class="hljs-attr">host:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.23</span><span class="hljs-number">.131</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-number">6379</span><br>    <span class="hljs-attr">lettuce:</span><br>      <span class="hljs-attr">pool:</span><br>        <span class="hljs-attr">max-active:</span> <span class="hljs-number">8</span>  <span class="hljs-comment"># æœ€å¤§è¿æ¥</span><br>        <span class="hljs-attr">max-idle:</span> <span class="hljs-number">8</span>  <span class="hljs-comment"># æœ€å¤§ç©ºé—²è¿æ¥</span><br>        <span class="hljs-attr">min-idle:</span> <span class="hljs-number">0</span>  <span class="hljs-comment"># æœ€å°ç©ºé—²è¿æ¥</span><br>        <span class="hljs-attr">max-wait:</span> <span class="hljs-number">100</span>  <span class="hljs-comment"># è¿æ¥ç­‰å¾…æ—¶é—´</span><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">QuickStart</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RedisTemplate redisTemplate;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">testString</span><span class="hljs-params">()</span> &#123;<br>        redisTemplate.opsForValue().set(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;æå››&quot;</span>);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> redisTemplate.opsForValue().get(<span class="hljs-string">&quot;name&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;name= &quot;</span> + name);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰RedisTemplate"><a href="#è‡ªå®šä¹‰RedisTemplate" class="headerlink" title="è‡ªå®šä¹‰RedisTemplate"></a>è‡ªå®šä¹‰RedisTemplate</h3><p>RedisTemplateå¯ä»¥æ¥æ”¶ä»»æ„Objectä½œä¸ºå€¼å†™å…¥Redisï¼Œåªä¸è¿‡å†™å…¥å‰ä¼šæŠŠObjectåºåˆ—åŒ–ä¸ºå­—èŠ‚å½¢å¼ï¼Œé»˜è®¤æ˜¯é‡‡ç”¨JDKåºåˆ—åŒ–ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯è¿™æ ·çš„ï¼š</p><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308192222115.png" class><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="hljs-title function_">redisTemplate</span><span class="hljs-params">(RedisConnectionFactory redisConnectionFactory)</span>        <span class="hljs-keyword">throws</span> UnknownHostException &#123;    <span class="hljs-comment">// åˆ›å»ºTemplate</span><br>    RedisTemplate&lt;String, Object&gt; redisTemplate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedisTemplate</span>&lt;&gt;();    <span class="hljs-comment">// è®¾ç½®è¿æ¥å·¥å‚</span><br>    redisTemplate.setConnectionFactory(redisConnectionFactory);<br>    <span class="hljs-comment">// è®¾ç½®åºåˆ—åŒ–å·¥å…·</span><br>    <span class="hljs-type">GenericJackson2JsonRedisSerializer</span> <span class="hljs-variable">jsonRedisSerializer</span> <span class="hljs-operator">=</span> <br><span class="hljs-keyword">new</span> <span class="hljs-title class_">GenericJackson2JsonRedisSerializer</span>();<br>    <span class="hljs-comment">// keyå’Œ hashKeyé‡‡ç”¨ stringåºåˆ—åŒ–</span><br>    redisTemplate.setKeySerializer(RedisSerializer.string()); <br>    redisTemplate.setHashKeySerializer(RedisSerializer.string());<br>    <span class="hljs-comment">// valueå’Œ hashValueé‡‡ç”¨ JSONåºåˆ—åŒ–</span><br>    redisTemplate.setValueSerializer(jsonRedisSerializer);<br>    redisTemplate.setHashValueSerializer(jsonRedisSerializer);<br>    <br>    <span class="hljs-keyword">return</span> redisTemplate;<br>&#125;<br><br></code></pre></td></tr></table></figure><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308193212205.png" class><p>ä¸ºäº†åœ¨ååºåˆ—åŒ–æ—¶çŸ¥é“å¯¹è±¡çš„ç±»å‹ï¼ŒJSONåºåˆ—åŒ–å™¨ä¼šå°†ç±»çš„classç±»å‹å†™å…¥jsonç»“æœä¸­ï¼Œå­˜å…¥Redisï¼Œä¼šå¸¦æ¥é¢å¤–çš„å†…å­˜å¼€é”€ã€‚</p><h3 id="æ‰‹åŠ¨ä½¿ç”¨StringRedisTemplateï¼ˆæ¨èï¼‰"><a href="#æ‰‹åŠ¨ä½¿ç”¨StringRedisTemplateï¼ˆæ¨èï¼‰" class="headerlink" title="æ‰‹åŠ¨ä½¿ç”¨StringRedisTemplateï¼ˆæ¨èï¼‰"></a>æ‰‹åŠ¨ä½¿ç”¨StringRedisTemplateï¼ˆæ¨èï¼‰</h3><p>å†™å…¥Redisæ—¶ï¼Œæ‰‹åŠ¨æŠŠå¯¹è±¡åºåˆ—åŒ–ä¸ºJSON</p><p>è¯»å–Redisæ—¶ï¼Œæ‰‹åŠ¨æŠŠè¯»å–åˆ°çš„JSONååºåˆ—åŒ–ä¸ºå¯¹è±¡</p><p>ä¸ºäº†èŠ‚çœå†…å­˜ç©ºé—´ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šä½¿ç”¨JSONåºåˆ—åŒ–å™¨æ¥å¤„ç†valueï¼Œè€Œæ˜¯ç»Ÿä¸€ä½¿ç”¨Stringåºåˆ—åŒ–å™¨ï¼Œè¦æ±‚åªèƒ½å­˜å‚¨Stringç±»å‹çš„keyå’Œvalueã€‚å½“éœ€è¦å­˜å‚¨Javaå¯¹è±¡æ—¶ï¼Œæ‰‹åŠ¨å®Œæˆå¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308193323552.png" class><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br><span class="hljs-keyword">private</span> StringRedisTemplate stringRedisTemplate;<br><span class="hljs-comment">// JSONå·¥å…·</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">mapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>();<br><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testStringTemplate</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> JsonProcessingException &#123;<br>    <span class="hljs-comment">// å‡†å¤‡å¯¹è±¡</span><br>    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;è™å“¥&quot;</span>, <span class="hljs-number">18</span>);<br>    <span class="hljs-comment">// æ‰‹åŠ¨åºåˆ—åŒ–</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> mapper.writeValueAsString(user);<br>    <span class="hljs-comment">// å†™å…¥ä¸€æ¡æ•°æ®åˆ°redis</span><br>    stringRedisTemplate.opsForValue().set(<span class="hljs-string">&quot;user:200&quot;</span>, json);<br>    <span class="hljs-comment">// è¯»å–æ•°æ®</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">val</span> <span class="hljs-operator">=</span> stringRedisTemplate.opsForValue().get(<span class="hljs-string">&quot;user:200&quot;</span>);<br>    <span class="hljs-comment">// ååºåˆ—åŒ–</span><br>    <span class="hljs-type">User</span> <span class="hljs-variable">user1</span> <span class="hljs-operator">=</span> mapper.readValue(val, User.class);<br>    System.out.println(<span class="hljs-string">&quot;user1 = &quot;</span> + user1);<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ‡è®°ï¼šæ­¤æ—¶è¿™ä¸ªç±»å¿…é¡»è¦<strong>æ·»åŠ æ— å‚çš„æ„é€ å‡½æ•°</strong>ã€‚å¦åˆ™ä¼šæŠ¥é”™ï¼</p><img src="/2022/03/08/Redis/Redis%E5%9F%BA%E7%A1%80/image-20220308195026207.png" class><p>å¯ä»¥çœ‹åˆ°ååºåˆ—åŒ–åçš„å¯¹è±¡æ­£å¸¸è¾“å‡º</p>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Leetcode082åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ II</title>
    <link href="/2022/03/07/Algo/Leetcode082%E5%88%A0%E9%99%A4%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0II/"/>
    <url>/2022/03/07/Algo/Leetcode082%E5%88%A0%E9%99%A4%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0II/</url>
    
    <content type="html"><![CDATA[<p>æœ‰ä¸¤ä¸ªå‘¨æ²¡æœ‰åˆ·ç®—æ³•é¢˜äº†ï¼Œä»Šå¤©åœ¨å‰‘æŒ‡offeræ‰¾åˆ°äº†è¿™é“é¢˜ï¼š<a href="https://leetcode-cn.com/problems/remove-duplicates-from-sorted-list/">åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ </a>ï¼Œå½“æ—¶è§‰å¾—å¾ˆç®€å•ï¼Œä½†æ˜¯çœ‹åˆ°ç¬¬äºŒé“é¢˜çš„æ—¶å€™æˆ‘æœ¬æ¥ä»¥ä¸ºå¾ˆç®€å•ï¼Œä½†æ˜¯åšäº†ä¸€ä¼šå„¿å´è§‰å¾—æ— ä»ä¸‹æ‰‹ã€‚ä¸¤é“é¢˜åŒºåˆ«ä¸ºï¼šç®€å•ç‰ˆæœ¬æ˜¯æŠŠé‡å¤å…ƒç´ åˆ é™¤åˆ°å‰©ä¸‹ä¸€ä¸ªï¼Œè€Œå¤æ‚ç‰ˆæœ¬æ˜¯æŠŠé‡å¤çš„å…ƒç´ å…¨éƒ¨åˆ é™¤ã€‚</p><p>å…¶å®çœ‹åˆ°è¿™ç§é¢˜ç›®ç¬¬ä¸€æ­¥è‚¯å®šæ˜¯åˆ›å»ºä¸€ä¸ªdummyHeadï¼Œå› ä¸ºå½“ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯é‡å¤èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæœ‰äº†ä¸€ä¸ªå‡çš„å¤´èŠ‚ç‚¹ä¼šæ¯”è¾ƒå¥½å¤„ç†ï¼Œå³æœ€åå¯ä»¥è¿”å›dummyHead.nextã€‚</p><h4 id="åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ -II"><a href="#åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ -II" class="headerlink" title="åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  II"></a><a href="https://leetcode-cn.com/problems/remove-duplicates-from-sorted-list-ii/">åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´  II</a></h4><h3 id="æ€æƒ³"><a href="#æ€æƒ³" class="headerlink" title="æ€æƒ³"></a>æ€æƒ³</h3><p>æ³¨æ„è¿™é‡Œæ˜¯ä¸€ä¸ªæ’åºé“¾è¡¨ï¼Œ<strong>æ‰€ä»¥å®ƒç›¸åŒçš„å€¼çš„èŠ‚ç‚¹éƒ½æ˜¯è¿ç»­çš„</strong>ï¼Œè¿™å¯¹äºæˆ‘ä»¬è§£é¢˜è‡³å…³é‡è¦</p><p>æˆ‘ä»¬å¯ä»¥å…ˆåˆ›å»ºä¸€ä¸ªprevèŠ‚ç‚¹ï¼Œç„¶åæ ¹æ®prevèŠ‚ç‚¹åé¢çš„ä¸åŒçŠ¶å†µæ¥åšå‡ºä¸åŒçš„å¤„ç†</p><p>å‡è®¾æœ‰ä¸€ä¸ªé“¾è¡¨å¦‚å›¾æ‰€ç¤ºï¼š</p><ul><li>æƒ…å†µä¸€</li></ul><img src="/2022/03/07/Algo/Leetcode082%E5%88%A0%E9%99%A4%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0II/image-20220307230111383.png" class><p>æˆ‘ä»¬ç°åœ¨å‡è®¾prevèŠ‚ç‚¹ä¸º1ï¼ŒheadèŠ‚ç‚¹ä¸º2ï¼Œæ­¤æ—¶è®©headä¸€ç›´å‘nextç§»åŠ¨ï¼Œç›´åˆ°ç§»åˆ°ä¸ä¸º2çš„èŠ‚ç‚¹ï¼Œå…¶å®å°±æ˜¯å®ƒæœ¬èº«å“ˆå“ˆã€‚è¿™ä¸ªæ—¶å€™å¾ˆç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥è®©prevå’Œheadå‘åç§»åŠ¨å°±å¯ä»¥äº†</p><ul><li>æƒ…å†µäºŒ</li></ul><img src="/2022/03/07/Algo/Leetcode082%E5%88%A0%E9%99%A4%E6%8E%92%E5%BA%8F%E9%93%BE%E8%A1%A8%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0II/image-20220307231356886.png" class><p>æˆ‘ä»¬ç°åœ¨å‡è®¾prevèŠ‚ç‚¹ä¸º2ï¼ŒheadèŠ‚ç‚¹ä¸º3ï¼Œæ­¤æ—¶è®©headä¸€ç›´å‘nextç§»åŠ¨ï¼Œç›´åˆ°ç§»åˆ°ä¸ä¸º3çš„èŠ‚ç‚¹ï¼Œå³ç§»åŠ¨åˆ°çº¢è‰²çš„3èŠ‚ç‚¹å¤„ï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥è®©prevçš„next &#x3D; çº¢è‰²èŠ‚ç‚¹çš„nextï¼Œç„¶åheadåç§»å°±å¯ä»¥äº†</p><p>ä»£ç å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;<br>    <span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">deleteDuplicates</span><span class="hljs-params">(ListNode head)</span> &#123;<br>        <span class="hljs-keyword">if</span> (head == <span class="hljs-literal">null</span> || head.next == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> head;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">dummyHead</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(-<span class="hljs-number">1</span>, head);<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">prev</span> <span class="hljs-operator">=</span> dummyHead;<br>        <span class="hljs-keyword">while</span> (head != <span class="hljs-literal">null</span> &amp;&amp; head.next != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-type">ListNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> head;  <span class="hljs-comment">// node ä¸´æ—¶å­˜å‚¨head</span><br>            <span class="hljs-keyword">while</span> (head.next != <span class="hljs-literal">null</span> &amp;&amp; head.val == head.next.val) head = head.next;<br>            <span class="hljs-keyword">if</span> (head == node) &#123;  <span class="hljs-comment">// æ²¡æœ‰é‡å¤</span><br>                prev = prev.next;  <br>            &#125; <span class="hljs-keyword">else</span> &#123;  <span class="hljs-comment">// æœ‰é‡å¤</span><br>                prev.next = head.next;<br>            &#125;<br>            head = head.next;<br>        &#125;<br>        <span class="hljs-keyword">return</span> dummyHead.next;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è‡³æ­¤æœ¬é“é¢˜è§£æç»“æŸ,åœ¨è¿™é‡Œå¤šæä¸€å¥ï¼Œå†™è¿™ç§ç®—æ³•é¢˜çš„è§£ææ„Ÿè§‰çœŸçš„å¾ˆæ¯”å¹³æ—¶å†™åˆ«çš„æ–‡ç« éº»çƒ¦å¾ˆå¤šå•Šï¼Œä½†æˆ‘ç›¸ä¿¡å¤šå¤šæ²‰æ·€æ€»æ˜¯å¥½çš„</p>]]></content>
    
    
    <categories>
      
      <category>algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>algorithm</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AQSæºç å‰–æ</title>
    <link href="/2022/03/05/JUC/AQS%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/"/>
    <url>/2022/03/05/JUC/AQS%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="AQSæºç å‰–æ"><a href="#AQSæºç å‰–æ" class="headerlink" title="AQSæºç å‰–æ"></a>AQSæºç å‰–æ</h1><h2 id="ä»€ä¹ˆæ˜¯AQS"><a href="#ä»€ä¹ˆæ˜¯AQS" class="headerlink" title="ä»€ä¹ˆæ˜¯AQS"></a>ä»€ä¹ˆæ˜¯AQS</h2><p>AQS (AbstractQueuedSynchronizer)æ˜¯ä¸€ä¸ªé”æ¡†æ¶ï¼Œå®ƒå®šä¹‰äº†é”çš„æœºåˆ¶ï¼Œå¼€æ”¾å‡ºäº†å¯ä»¥æ‹“å±•çš„åœ°æ–¹ï¼ŒAQSå¼€æ”¾å‡ºæ¥stateå­—æ®µï¼Œè®©å­ç±»å¯ä»¥æ ¹æ®stateå­—æ®µå†³å®šæ˜¯å¦å¯ä»¥è·å–é”ï¼Œå¯¹äºè·å–ä¸åˆ°çš„ä¼šè¿›è¡Œè‡ªåŠ¨ç®¡ç†ï¼Œå­ç±»æ— éœ€æ‹…å¿ƒã€‚æ¥ä¸‹æ¥æˆ‘ä¼šåœ¨æºç ä¸Šå¸¦å¤§å®¶ä¸€èµ·äº†è§£ä¸€ä¸‹AQS</p><blockquote><p>åœ¨çœ‹çš„æ—¶å€™æˆ‘ååˆ†å¸Œæœ›ä½ ä¹Ÿç‚¹è¿›æºç é‡Œå»çœ‹ä¸€çœ‹ï¼Œä½ ä¼šå‘ç°ä¸ä¸€æ ·çš„ä¸–ç•Œã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Head of the wait queue, lazily initialized.  Except for</span><br><span class="hljs-comment"> * initialization, it is modified only via method setHead.  Note:</span><br><span class="hljs-comment"> * If head exists, its waitStatus is guaranteed not to be</span><br><span class="hljs-comment"> * CANCELLED.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * ç­‰å¾…é˜Ÿåˆ—çš„å¤´éƒ¨ï¼Œå»¶è¿Ÿåˆå§‹åŒ–ã€‚ é™¤äº†</span><br><span class="hljs-comment">  * åˆå§‹åŒ–ï¼Œåªèƒ½é€šè¿‡setHeadæ–¹æ³•ä¿®æ”¹ã€‚ </span><br><span class="hljs-comment">  ç¬”è®°ï¼š</span><br><span class="hljs-comment">  * å¦‚æœheadå­˜åœ¨ï¼Œåˆ™ä¿è¯å…¶waitStatusä¸èƒ½è¢«å–æ¶ˆ</span><br><span class="hljs-comment">  */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node head;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Tail of the wait queue, lazily initialized.  Modified only via</span><br><span class="hljs-comment"> * method enq to add new wait node.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * ç­‰å¾…é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œå»¶è¿Ÿåˆå§‹åŒ–ã€‚ ä»…é€šè¿‡ä¿®æ”¹</span><br><span class="hljs-comment">  * æ–¹æ³• enq æ·»åŠ æ–°çš„ç­‰å¾…èŠ‚ç‚¹ã€‚</span><br><span class="hljs-comment">  */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> <span class="hljs-keyword">volatile</span> Node tail;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The synchronization state.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * åŒæ­¥çŠ¶æ€ã€‚</span><br><span class="hljs-comment">  */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> state;<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯AQSæºç é‡Œçš„ä¸‰ä¸ªæˆå‘˜å±æ€§</p><p>stateç”¨äºåˆ¤æ–­å…±äº«èµ„æºæ˜¯å¦è¢«æ­£åœ¨å ç”¨çš„æ ‡è®°ä½ï¼Œvolatileä¿è¯çº¿ç¨‹å¯è§æ€§ï¼Œ</p><p>èµ„æºå ç”¨æœ‰ä¸¤ç§æ¨¡å¼ï¼Œç‹¬å ï¼ˆè‡ªå·±å ç”¨åˆ«äººå°±ä¸èƒ½å ç”¨ï¼‰ï¼Œå…±äº«ï¼ˆè‡ªå·±å ç”¨ï¼Œå…¶ä»–å…±äº«çº¿ç¨‹ä¹Ÿèƒ½å ç”¨ï¼‰</p><p>å› æ­¤å…±äº«æ¨¡å¼ä¸‹å¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹æ­£åœ¨å…±äº«èµ„æºï¼Œè€Œint ç±»å‹åˆ™èƒ½è¡¨ç¤ºå…±äº«çº¿ç¨‹æ•°ç›®ã€‚</p><p>å¦‚æœä¸€ä¸ªçº¿ç¨‹åœ¨å½“å‰æ—¶åˆ»æ²¡æœ‰è·å–åˆ°å…±äº«èµ„æºï¼Œé‚£å®ƒå°±å¯ä»¥æ’é˜Ÿï¼Œè€ŒAQSæ˜¯ä¸€ä¸ªFIFO(å…ˆè¿›å…ˆå‡º)çš„åŒå‘é“¾è¡¨ï¼Œhead å’Œ tailåˆ†åˆ«ä¸ºå¤´å’Œå°¾ã€‚</p><p>Nodeæºç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">/** waitStatus value to indicate thread has cancelled. */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CANCELLED</span> <span class="hljs-operator">=</span>  <span class="hljs-number">1</span>;<br><span class="hljs-comment">/** waitStatus value to indicate successor&#x27;s thread needs unparking. */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SIGNAL</span>    <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br><span class="hljs-comment">/** waitStatus value to indicate thread is waiting on condition. */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CONDITION</span> <span class="hljs-operator">=</span> -<span class="hljs-number">2</span>;<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * waitStatus value to indicate the next acquireShared should</span><br><span class="hljs-comment"> * unconditionally propagate.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">PROPAGATE</span> <span class="hljs-operator">=</span> -<span class="hljs-number">3</span>;<br><span class="hljs-comment">// ç­‰å¾…çŠ¶æ€</span><br><span class="hljs-keyword">volatile</span> <span class="hljs-type">int</span> waitStatus;<br><span class="hljs-comment">// å‰æŒ‡é’ˆ</span><br><span class="hljs-keyword">volatile</span> Node prev;<br><span class="hljs-comment">// åæŒ‡é’ˆ</span><br><span class="hljs-keyword">volatile</span> Node next;<br><span class="hljs-comment">// çº¿ç¨‹å¯¹è±¡</span><br><span class="hljs-keyword">volatile</span> Thread thread;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢å››ä¸ªä¸ºæšä¸¾å€¼ï¼Œç”¨æ¥è¡¨ç¤ºçº¿ç¨‹çš„çŠ¶æ€</p><h2 id="acquireæ–¹æ³•"><a href="#acquireæ–¹æ³•" class="headerlink" title="acquireæ–¹æ³•"></a>acquireæ–¹æ³•</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»acquireæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">acquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> &#123;<br>    <span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp;<br>        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))<br>        selfInterrupt();<br>&#125;<br></code></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•ä¸ºfinalæ–¹æ³•ï¼Œä¸å…è®¸å­ç±»è¿›è¡Œé‡å†™</p><p>å¦‚æœacquireQueuedå°è¯•è·å¾—é”æˆåŠŸé‚£å°±ä¼šç›´æ¥è·³å‡ºåˆ¤æ–­ä¸å†æ‰§è¡Œåé¢</p><p>å¦‚æœè·å¾—å¤±è´¥é‚£å°±ä¼šacquireQueuedè¿›å…¥ç­‰å¾…é˜Ÿåˆ—</p><p>ä¸‹é¢æˆ‘ä»¬è¯¦ç»†åˆ†æacquireQueuedå’ŒaddWaiteræ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">private</span> Node <span class="hljs-title function_">addWaiter</span><span class="hljs-params">(Node mode)</span> &#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>(mode);<br><br>        <span class="hljs-keyword">for</span> (;;) &#123;<br>            <span class="hljs-type">Node</span> <span class="hljs-variable">oldTail</span> <span class="hljs-operator">=</span> tail;<br>            <span class="hljs-keyword">if</span> (oldTail != <span class="hljs-literal">null</span>) &#123;<br>                node.setPrevRelaxed(oldTail);<br>                <span class="hljs-keyword">if</span> (compareAndSetTail(oldTail, node)) &#123;<br>                    oldTail.next = node;<br>                    <span class="hljs-keyword">return</span> node;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                initializeSyncQueue();<br>            &#125;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯addWaiteræºç ï¼Œä½œç”¨æ˜¯å°†å½“å‰çº¿ç¨‹å°è£…ä¸ºä¸€ä¸ªnodeï¼Œæ’å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œæœ€åè¿”å›å°¾èŠ‚ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">acquireQueued</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Node node, <span class="hljs-type">int</span> arg)</span> &#123;<br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">interrupted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">for</span> (;;) &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> node.predecessor();<br>            <span class="hljs-keyword">if</span> (p == head &amp;&amp; tryAcquire(arg)) &#123;<br>                setHead(node);<br>                p.next = <span class="hljs-literal">null</span>; <span class="hljs-comment">// help GC</span><br>                <span class="hljs-keyword">return</span> interrupted;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (shouldParkAfterFailedAcquire(p, node))<br>                interrupted |= parkAndCheckInterrupt();<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (Throwable t) &#123;<br>        cancelAcquire(node);<br>        <span class="hljs-keyword">if</span> (interrupted)<br>            selfInterrupt();<br>        <span class="hljs-keyword">throw</span> t;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯å¤´èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸”å½“å‰çº¿ç¨‹å°è¯•è·å–é”æˆåŠŸäº†ï¼Œé‚£å°±ç›´æ¥è¿”å›å½“å‰èŠ‚ç‚¹ã€‚åœ¨è¿™é‡Œå¼ºè°ƒä¸€ä¸‹ï¼Œå¤´èŠ‚ç‚¹æ˜¯ä¸€ä¸ª<strong>è™šèŠ‚ç‚¹</strong>ï¼Œæ„æ€æ˜¯ï¼Œå¤´èŠ‚ç‚¹å¹¶ä¸æ˜¯å½“å‰éœ€è¦å»æ‹¿é”çš„èŠ‚ç‚¹ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå ä½æ‘†è®¾ï¼Œè€Œç¬¬äºŒä¸ªèŠ‚ç‚¹æ‰æ˜¯çœŸæ­£è¦æ‹¿é”çš„èŠ‚ç‚¹ï¼Œå½“å®ƒæ‹¿åˆ°é”ä»¥åï¼Œå®ƒå°±ä¼šå˜æˆå¤´èŠ‚ç‚¹ï¼Œå¤´èŠ‚ç‚¹å°±ä¼šå‡ºé˜Ÿï¼Œæ‰€ä»¥åœ¨AQSæºç ç»å¸¸ä¼šçœ‹åˆ°åˆ¤æ–­å‰ç½®èŠ‚ç‚¹æ˜¯å¦ä¸ºå¤´èŠ‚ç‚¹çš„ä»£ç ã€‚</p><p>if (shouldParkAfterFailedAcquire(p, node))çº¿ç¨‹å¦‚æœè·å–é”å¤±è´¥åï¼Œé‚£å°±è¦åˆ¤æ–­çº¿ç¨‹æ˜¯å¦éœ€è¦æŒ‚èµ·äº†ï¼Œä¸ºä»€ä¹ˆä¸è‡ªæ—‹ï¼Ÿå› ä¸ºè‡ªæ—‹æ˜¯ä¸€ä¸ªå¾ˆè€—è´¹CPUçš„æ“ä½œï¼Œå¦‚æœå¤§é‡çº¿ç¨‹è‡ªæ—‹ï¼Œé‚£ä¼šå¾ˆè€—è´¹CPUï¼Œè€ŒæŒ‚èµ·ï¼Œåœ¨åˆé€‚çš„é€‚åˆå«é†’ï¼Œé‚£å°±ä¼šå¾ˆå¥½ç¼“è§£è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä»€ä¹ˆæ—¶å€™éœ€è¦æŒ‚èµ·å‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">shouldParkAfterFailedAcquire</span><span class="hljs-params">(Node pred, Node node)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> pred.waitStatus;<br>    <span class="hljs-keyword">if</span> (ws == Node.SIGNAL)<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * This node has already set status asking a release</span><br><span class="hljs-comment">         * to signal it, so it can safely park.</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">if</span> (ws &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * Predecessor was cancelled. Skip over predecessors and</span><br><span class="hljs-comment">         * indicate retry.</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-keyword">do</span> &#123;<br>            node.prev = pred = pred.prev;<br>        &#125; <span class="hljs-keyword">while</span> (pred.waitStatus &gt; <span class="hljs-number">0</span>);<br>        pred.next = node;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * waitStatus must be 0 or PROPAGATE.  Indicate that we</span><br><span class="hljs-comment">         * need a signal, but don&#x27;t park yet.  Caller will need to</span><br><span class="hljs-comment">         * retry to make sure it cannot acquire before parking.</span><br><span class="hljs-comment">         */</span><br>        pred.compareAndSetWaitStatus(ws, Node.SIGNAL);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœå½“å‰èŠ‚ç‚¹å‰ç½®èŠ‚ç‚¹çŠ¶æ€ä¸ºSIGNALï¼Œå³å‰ç½®èŠ‚ç‚¹ä¹Ÿåœ¨ç­‰å¾…é”ï¼Œé‚£å°±å½“å‰èŠ‚ç‚¹è‚¯å®šæ‹¿ä¸åˆ°é”ï¼Œå½“å‰çº¿ç¨‹å°±æ˜¯å¯ä»¥ç›´æ¥æŒ‚èµ·çš„ã€‚</p><p>å¦‚æœå®ƒçŠ¶æ€å¤§äº0ï¼Œé‚£çŠ¶æ€åªèƒ½æ˜¯CANCELï¼Œå°±æŠŠå®ƒä»é˜Ÿåˆ—åˆ é™¤ï¼Œå¦‚æœæ˜¯å…¶ä»–çŠ¶æ€ï¼Œæ—¢ç„¶å½“å‰èŠ‚ç‚¹å·²ç»åŠ å…¥äº†ï¼Œé‚£å®ƒçš„å‰ç½®èŠ‚ç‚¹å°±åº”è¯¥åšå¥½ç­‰å¾…è·å–é”ï¼Œé€šè¿‡CASçš„æ–¹æ³•å°†å‰ç½®èŠ‚ç‚¹ä¿®æ”¹ä¸ºSIGNALï¼Œè¿™ä¸¤ç§æƒ…å†µè¿”å›çš„æ˜¯falseã€‚</p><img src="/2022/03/05/JUC/AQS%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/image-20220305222310019.png" class><blockquote><p>æ³¨ï¼šè¿™é‡Œæç¤ºä¸€ä¸‹ï¼Œä»¥å‰çœ‹åˆ°è¿™å¼ å›¾çš„æ—¶å€™ï¼Œæˆ‘ä»¥ä¸ºæ‰€æœ‰nodeå…¬ç”¨ä¸€ä¸ªstate,å…¶å®æ¯ä¸ªnodeéƒ½æœ‰ä¸€ä¸ªstate</p></blockquote><p>é€šè¿‡åˆ†æacquireæ–¹æ³•ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ‰€åœ¨èŠ‚ç‚¹å¤„äºå¤´èŠ‚ç‚¹çš„åé¢ä¸€ä¸ªï¼Œé‚£å°±ä¼šä¸æ–­å°è¯•è¿›è¡Œæ‹¿é”ï¼Œç›´åˆ°æˆåŠŸï¼Œå¦åˆ™å°±ä¼šè¿›è¡ŒæŒ‚èµ·ï¼Œå¦‚ä½•åˆ¤æ–­æ˜¯å¦éœ€è¦æŒ‚èµ·å‘¢ï¼Ÿé‚£å°±æ˜¯å½“å‰èŠ‚ç‚¹ä¹‹å‰é™¤äº†headè¿˜æœ‰åˆ«çš„èŠ‚ç‚¹ï¼Œä¸”çŠ¶æ€ä¸ºSINGLEé‚£å½“å‰èŠ‚ç‚¹å°±éœ€è¦è¢«æŒ‚èµ·ï¼Œè¿™æ ·å°±èƒ½è®©headååªèƒ½æœ‰ä¸€ä¸ªèŠ‚ç‚¹æ¥è·å–é”ï¼Œè¿™æ ·å°±èƒ½é¿å…è‡ªæ—‹æ¶ˆè€—CPUï¼Œ</p><h2 id="release"><a href="#release" class="headerlink" title="release"></a>release</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">release</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> &#123;<br>    <span class="hljs-keyword">if</span> (tryRelease(arg)) &#123;<br>        <span class="hljs-type">Node</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-keyword">if</span> (h != <span class="hljs-literal">null</span> &amp;&amp; h.waitStatus != <span class="hljs-number">0</span>)<br>            unparkSuccessor(h);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>releaseæ˜¯ç”¨æ¥é‡Šæ”¾é”çš„ï¼ŒåŠ å…¥å°è¯•é‡Šæ”¾é”æˆåŠŸï¼Œé‚£ä¸‹ä¸€æ­¥å°±è¦å»ç­‰å¾…å…¶ä»–çš„èŠ‚ç‚¹ï¼Œè¿™é‡Œæ¥åˆ†æä¸€ä¸‹unparkSuccessoræ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unparkSuccessor</span><span class="hljs-params">(Node node)</span> &#123;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     * If status is negative (i.e., possibly needing signal) try</span><br><span class="hljs-comment">     * to clear in anticipation of signalling.  It is OK if this</span><br><span class="hljs-comment">     * fails or if status is changed by waiting thread.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">ws</span> <span class="hljs-operator">=</span> node.waitStatus;<br>    <span class="hljs-keyword">if</span> (ws &lt; <span class="hljs-number">0</span>)<br>        node.compareAndSetWaitStatus(ws, <span class="hljs-number">0</span>);<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">     * Thread to unpark is held in successor, which is normally</span><br><span class="hljs-comment">     * just the next node.  But if cancelled or apparently null,</span><br><span class="hljs-comment">     * traverse backwards from tail to find the actual</span><br><span class="hljs-comment">     * non-cancelled successor.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">          * unpark çš„çº¿ç¨‹ç”±åç»§ä¿æŒï¼Œè¿™å¾ˆæ­£å¸¸</span><br><span class="hljs-comment">          * å¦‚æœåªå”¤é†’ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚ ä½†å¦‚æœå–æ¶ˆæˆ–æ˜æ˜¾ä¸ºç©ºï¼Œ</span><br><span class="hljs-comment">          * ä»å°¾éƒ¨å‘åéå†æ‰¾åˆ°å®é™…çš„</span><br><span class="hljs-comment">          * æœªå–æ¶ˆçš„ç»§ä»»è€…ã€‚</span><br><span class="hljs-comment">          */</span><br>    <span class="hljs-type">Node</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> node.next;<br>    <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">null</span> || s.waitStatus &gt; <span class="hljs-number">0</span>) &#123;<br>        s = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">Node</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> tail; p != node &amp;&amp; p != <span class="hljs-literal">null</span>; p = p.prev)<br>            <span class="hljs-keyword">if</span> (p.waitStatus &lt;= <span class="hljs-number">0</span>)<br>                s = p;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (s != <span class="hljs-literal">null</span>)<br>        LockSupport.unpark(s.thread);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„å‚æ•°nodeæ˜¯acquireQueuedçš„å¹¸è¿å„¿ï¼Œå®ƒæ—©å°±è·å¾—äº†é”ï¼Œå®ƒæ˜¯é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œå®ƒé¦–å…ˆé€šè¿‡CASçš„æ–¹æ³•æŠŠwså˜ä¸ºäº†0ï¼Œè¿™æ ·å°±ä¸ä¼šå½±å“å…¶ä»–å‡½æ•°çš„åˆ¤æ–­ã€‚ç„¶åä¸åœçš„å‘åæ‰¾ï¼Œæ‰¾ä¸€ä¸ªé™¤äº†headå¤–æœ€é å‰çš„èŠ‚ç‚¹ï¼Œä¸”waitStatus&lt;&#x3D;0çš„èŠ‚ç‚¹ï¼Œç„¶åå¯¹å…¶LockSupport.unpark(s.thread);å°±æ˜¯å”¤é†’å®ƒï¼Œè®©å®ƒå»äº‰æŠ¢é”ï¼Œè¢«å”¤é†’çš„çº¿ç¨‹ä¼šå»æ‰§è¡Œacquireå°è¯•è‡ªæ—‹è·å–ï¼Œè¿™å°±å½¢æˆäº†ä¸€ä¸ªå¾ªç¯ï¼Œè¿˜æœ‰å€¼å¾—ä¸€æçš„æ˜¯è¿™é‡Œçš„å”¤é†’æ˜¯ä»å°¾éƒ¨å‘å‰å”¤é†’è·å–çš„ï¼Œè¯·çœ‹æ³¨é‡Šï¼</p><h2 id="tryAcquireæ–¹æ³•"><a href="#tryAcquireæ–¹æ³•" class="headerlink" title="tryAcquireæ–¹æ³•"></a>tryAcquireæ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™å¾ˆç®€å•ï¼Œå°±æ˜¯è®©å­ç±»å»ç»§æ‰¿çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå‚æ•°intè¡¨ç¤ºå¯¹stateçš„ä¿®æ”¹ï¼Œè¿”å›å€¼æ˜¯boolè¡¨ç¤ºæ˜¯å¦è·å–é”ï¼Œè¿™å°±æ˜¯è®©å­ç±»å»é‡å†™è¿™ä¸ªæ–¹æ³•å¦åˆ™å°±æŠ›å‡ºä¸æ”¯æŒè¯¥æ“ä½œçš„å¼‚å¸¸ã€‚æ‹¿è¿™å°±ç»™äº†ä¸Šå±‚å¾ˆå¤§çš„æ–½å±•ç©ºé—´ã€‚</p><h2 id="tryRelase"><a href="#tryRelase" class="headerlink" title="tryRelase"></a>tryRelase</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•ä¸tryAcquireç±»ä¼¼ï¼Œè¿™é‡Œä¸è¿›è¡Œè®²è§£</p>]]></content>
    
    
    <categories>
      
      <category>JUC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>AQS</tag>
      
      <tag>JUC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çº¿ç¨‹æ± </title>
    <link href="/2022/03/05/JUC/%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
    <url>/2022/03/05/JUC/%E7%BA%BF%E7%A8%8B%E6%B1%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± </h1><p>æœ€è¿‘æˆ‘å»äº†ä¸€å®¶å°å…¬å¸ï¼Œé‡åˆ°é©°å“¥ï¼ˆæˆ‘çš„å°leaderï¼‰ï¼Œé©°å“¥äººéå¸¸Nice,å¤§æ¦‚å¤§æˆ‘ä¸¤å²å“ˆå“ˆã€‚è®²äº†å¾ˆå¤šæˆ‘ä»¥åå¯èƒ½ä¼šé‡åˆ°çš„å›°éš¾ï¼Œæˆ‘è¿›å»å°±é—®ä»–äº†çº¿ç¨‹æ± çš„ç›¸å…³å†…å®¹ï¼Œä»–ä¹Ÿä»”ç»†ä¸ºæˆ‘è®²è§£äº†ä¸€ç•ªï¼Œæ¥ä¸‹æ¥æˆ‘å†™ä¸€ç¯‡æ–‡ç« è¯¦ç»†è®°å½•ä¸€ä¸‹ã€‚</p><p>åˆšå¼€å§‹æˆ‘ä»¥ä¸ºçº¿ç¨‹æ± å¾ˆéš¾ï¼Œä½†æ˜¯æ·±å…¥äº†è§£ä»¥åå‘ç°ä¹Ÿå°±é‚£æ ·å§~</p><p>ä¸‹é¢å¼€å§‹æ­£æ–‡</p><p>Javaè¯­è¨€è™½ç„¶å†…ç½®äº†å¤šçº¿ç¨‹æ”¯æŒï¼Œå¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯ï¼Œåˆ›å»ºçº¿ç¨‹éœ€è¦æ“ä½œç³»ç»Ÿèµ„æºï¼ˆçº¿ç¨‹èµ„æºï¼Œæ ˆç©ºé—´ç­‰ï¼‰ï¼Œé¢‘ç¹åˆ›å»ºå’Œé”€æ¯å¤§é‡çº¿ç¨‹éœ€è¦æ¶ˆè€—å¤§é‡æ—¶é—´ã€‚</p><img src="/2022/03/05/JUC/%E7%BA%BF%E7%A8%8B%E6%B1%A0/image-20220305172101024.png" class><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠå¾ˆå¤šå°ä»»åŠ¡è®©ä¸€ç»„çº¿ç¨‹æ¥æ‰§è¡Œï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä»»åŠ¡å¯¹åº”ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚è¿™ç§èƒ½æ¥æ”¶å¤§é‡å°ä»»åŠ¡å¹¶è¿›è¡Œåˆ†å‘å¤„ç†çš„å°±æ˜¯çº¿ç¨‹æ± ã€‚</p><p>ç®€å•åœ°è¯´ï¼Œçº¿ç¨‹æ± å†…éƒ¨ç»´æŠ¤äº†è‹¥å¹²ä¸ªçº¿ç¨‹ï¼Œæ²¡æœ‰ä»»åŠ¡çš„æ—¶å€™ï¼Œè¿™äº›çº¿ç¨‹éƒ½å¤„äºç­‰å¾…çŠ¶æ€ã€‚å¦‚æœæœ‰æ–°ä»»åŠ¡ï¼Œå°±åˆ†é…ä¸€ä¸ªç©ºé—²çº¿ç¨‹æ‰§è¡Œã€‚å¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½å¤„äºå¿™ç¢ŒçŠ¶æ€ï¼Œæ–°ä»»åŠ¡è¦ä¹ˆæ”¾å…¥é˜Ÿåˆ—ç­‰å¾…ï¼Œè¦ä¹ˆå¢åŠ ä¸€ä¸ªæ–°çº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚</p><p>å°±åƒæ˜¯ä½ å¼€äº†ä¸€ä¸ªé¥­é¦†ï¼ˆè¿è¡Œçš„ç¨‹åºï¼‰ï¼Œæœ‰ä¸€ç¾¤äººè¿‡æ¥åƒé¥­ï¼ˆå¤šä¸ªä»»åŠ¡ï¼‰ï¼Œæ¯ä¸€ä¸ªäººéƒ½éœ€è¦ä¸€ä¸ªæœåŠ¡å‘˜ï¼ˆéœ€è¦å¤šçº¿ç¨‹ï¼‰ï¼Œä½ ç°åœ¨æ¯æ¬¡è¿‡æ¥ä¸€ä¸ªäººå°±æ‹›è˜ä¸€ä¸ªæœåŠ¡å‘˜ç„¶åç”¨å®Œåå°†æœåŠ¡å‘˜è¾é€€ï¼Œè¿™æ ·å°±ä¼šæ¶ˆè€—å¤§é‡èµ„æºã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ¢ä¸€ç§æ–¹å¼ï¼Œæˆ‘ä»¬ç»™é¤é¦†é‡Œå…ˆæ”¾å‡ ä¸ªæœåŠ¡å‘˜ï¼Œå½“æœåŠ¡å‘˜æœåŠ¡å®Œä»¥åå°±è®©å®ƒæœåŠ¡ä¸‹ä¸€ä¸ªæˆ–è€…ä¼‘æ¯ï¼Œè¿™æ ·å°±èƒ½å‡å°‘æ‹›è˜å’Œè¾é€€çš„æ—¶é—´å¼€é”€äº†</p><h2 id="çº¿ç¨‹æ± çš„å‚æ•°"><a href="#çº¿ç¨‹æ± çš„å‚æ•°" class="headerlink" title="çº¿ç¨‹æ± çš„å‚æ•°"></a>çº¿ç¨‹æ± çš„å‚æ•°</h2><h3 id="ThreadPoolExecutorçš„æ„é€ æ–¹æ³•æºç "><a href="#ThreadPoolExecutorçš„æ„é€ æ–¹æ³•æºç " class="headerlink" title="ThreadPoolExecutorçš„æ„é€ æ–¹æ³•æºç "></a><strong>ThreadPoolExecutorçš„æ„é€ æ–¹æ³•æºç </strong></h3><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><pre><code class="hljs Java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Creates a new &#123;<span class="hljs-doctag">@code</span> ThreadPoolExecutor&#125; with the given initial</span><br><span class="hljs-comment">     * parameters, the default thread factory and the default rejected</span><br><span class="hljs-comment">     * execution handler.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * &lt;p&gt;It may be more convenient to use one of the &#123;<span class="hljs-doctag">@link</span> Executors&#125;</span><br><span class="hljs-comment">     * factory methods instead of this general purpose constructor.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> corePoolSize the number of threads to keep in the pool, even</span><br><span class="hljs-comment">     *        if they are idle, unless &#123;<span class="hljs-doctag">@code</span> allowCoreThreadTimeOut&#125; is set</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> maximumPoolSize the maximum number of threads to allow in the</span><br><span class="hljs-comment">     *        pool</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> keepAliveTime when the number of threads is greater than</span><br><span class="hljs-comment">     *        the core, this is the maximum time that excess idle threads</span><br><span class="hljs-comment">     *        will wait for new tasks before terminating.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> unit the time unit for the &#123;<span class="hljs-doctag">@code</span> keepAliveTime&#125; argument</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> workQueue the queue to use for holding tasks before they are</span><br><span class="hljs-comment">     *        executed.  This queue will hold only the &#123;<span class="hljs-doctag">@code</span> Runnable&#125;</span><br><span class="hljs-comment">     *        tasks submitted by the &#123;<span class="hljs-doctag">@code</span> execute&#125; method.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> IllegalArgumentException if one of the following holds:&lt;br&gt;</span><br><span class="hljs-comment">     *         &#123;<span class="hljs-doctag">@code</span> corePoolSize &lt; 0&#125;&lt;br&gt;</span><br><span class="hljs-comment">     *         &#123;<span class="hljs-doctag">@code</span> keepAliveTime &lt; 0&#125;&lt;br&gt;</span><br><span class="hljs-comment">     *         &#123;<span class="hljs-doctag">@code</span> maximumPoolSize &lt;= 0&#125;&lt;br&gt;</span><br><span class="hljs-comment">     *         &#123;<span class="hljs-doctag">@code</span> maximumPoolSize &lt; corePoolSize&#125;</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> NullPointerException if &#123;<span class="hljs-doctag">@code</span> workQueue&#125; is null</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ThreadPoolExecutor</span><span class="hljs-params">(<span class="hljs-type">int</span> corePoolSize,</span><br><span class="hljs-params">                              <span class="hljs-type">int</span> maximumPoolSize,</span><br><span class="hljs-params">                              <span class="hljs-type">long</span> keepAliveTime,</span><br><span class="hljs-params">                              TimeUnit unit,</span><br><span class="hljs-params">                              BlockingQueue&lt;Runnable&gt; workQueue)</span> &#123;<br>        <span class="hljs-built_in">this</span>(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,<br>             Executors.defaultThreadFactory(), defaultHandler);<br>    &#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸Šé¢æœ‰ä¸ƒä¸ªå‚æ•°</p><p><strong>æ ¸å¿ƒçº¿ç¨‹æ•°ï¼šcorePoolSize</strong></p><p>çº¿ç¨‹æ± ä¸­æ´»è·ƒçš„çº¿ç¨‹æ•°ï¼Œå³ä½¿å®ƒä»¬æ˜¯ç©ºé—²çš„ï¼Œé™¤éè®¾ç½®äº†allowCoreThreadTimeOutä¸ºtrueã€‚allowCoreThreadTimeOutçš„å€¼æ˜¯æ§åˆ¶æ ¸å¿ƒçº¿ç¨‹æ•°æ˜¯å¦åœ¨æ²¡æœ‰ä»»åŠ¡æ—¶æ˜¯å¦åœæ­¢æ´»è·ƒçš„çº¿ç¨‹ï¼Œå½“å®ƒçš„å€¼ä¸ºtrueæ—¶ï¼Œåœ¨çº¿ç¨‹æ± æ²¡æœ‰ä»»åŠ¡æ—¶ï¼Œæ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹éƒ½ä¼šåœæ­¢ã€‚</p><p><strong>æœ€å¤§çº¿ç¨‹æ•°ï¼šmaximumPoolSize</strong></p><p>çº¿ç¨‹æ± æ‰€å…è®¸å­˜åœ¨çš„æœ€å¤§çº¿ç¨‹æ•°ã€‚</p><p>éæ ¸å¿ƒçº¿ç¨‹æ•°é‡&#x3D;maximumPoolSize-corePoolSize</p><p><strong>å¤šä½™çº¿ç¨‹å­˜æ´»æ—¶é•¿ï¼škeepAliveTime</strong></p><p>çº¿ç¨‹æ± ä¸­é™¤æ ¸å¿ƒçº¿ç¨‹æ•°ä¹‹å¤–çš„çº¿ç¨‹ï¼ˆå¤šä½™çº¿ç¨‹ï¼‰çš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼Œå¦‚æœåœ¨è¿™ä¸ªæ—¶é—´èŒƒå›´å†…ï¼Œå¤šä½™çº¿ç¨‹æ²¡æœ‰ä»»åŠ¡éœ€è¦æ‰§è¡Œï¼Œåˆ™å¤šä½™çº¿ç¨‹å°±ä¼šåœæ­¢ã€‚(æ³¨æ„ï¼šå¤šä½™çº¿ç¨‹æ•° &#x3D; æœ€å¤§çº¿ç¨‹æ•° - æ ¸å¿ƒçº¿ç¨‹æ•°)</p><p><strong>æ—¶é—´å•ä½ï¼šunit</strong></p><p>å¤šä½™çº¿ç¨‹å­˜æ´»æ—¶é—´çš„å•ä½ï¼Œå¯ä»¥æ˜¯åˆ†é’Ÿã€ç§’ã€æ¯«ç§’ç­‰ã€‚</p><p><strong>ä»»åŠ¡é˜Ÿåˆ—ï¼šworkQueue</strong></p><p>ArrayBlockingQueue,LinkBlockingQueue</p><p>çº¿ç¨‹æ± çš„ä»»åŠ¡é˜Ÿåˆ—ï¼Œä½¿ç”¨çº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œä»»åŠ¡ä¼šå…ˆæäº¤åˆ°è¿™ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç„¶åå·¥ä½œçº¿ç¨‹å–å‡ºä»»åŠ¡è¿›è¡Œæ‰§è¡Œï¼Œå½“è¿™ä¸ªé˜Ÿåˆ—æ»¡äº†ï¼Œçº¿ç¨‹æ± å°±ä¼šæ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚</p><p><strong>çº¿ç¨‹å·¥å‚ï¼šthreadFactory</strong></p><p>åˆ›å»ºçº¿ç¨‹æ± çš„å·¥å‚ï¼Œçº¿ç¨‹æ± å°†ä½¿ç”¨è¿™ä¸ªå·¥å‚æ¥åˆ›å»ºçº¿ç¨‹æ± ï¼Œè‡ªå®šä¹‰çº¿ç¨‹å·¥å‚éœ€è¦å®ç°ThreadFactoryæ¥å£ã€‚</p><p><strong>æ‹’ç»æ‰§è¡Œå¤„ç†å™¨ï¼ˆä¹Ÿç§°æ‹’ç»ç­–ç•¥ï¼‰ï¼šhandler</strong></p><ul><li>AbortPolicyï¼šçº¿ç¨‹ä»»åŠ¡ä¸¢å¼ƒæŠ¥é”™ï¼ˆé»˜è®¤ï¼‰</li><li>DiscardPolicyï¼šçº¿ç¨‹ä»»åŠ¡ä¸¢å¼ƒä¸æŠ¥é”™ </li><li>DiscardOldestPolicyï¼šå°†worlQueueé˜Ÿé¦–ä»»åŠ¡ä¸¢å¼ƒï¼Œå°†æœ€æ–°çš„çº¿ç¨‹ä»»åŠ¡åŠ å…¥åˆ°çº¿ç¨‹é˜Ÿåˆ—</li><li>CallerRunsPolicyï¼šçº¿ç¨‹æ± å¤–çš„çº¿ç¨‹ç›´æ¥è°ƒç”¨runæ–¹æ³•æ‰§è¡Œ</li></ul><p>å½“çº¿ç¨‹æ± æ— ç©ºé—²çº¿ç¨‹ï¼Œå¹¶ä¸”ä»»åŠ¡é˜Ÿåˆ—å·²æ»¡ï¼Œæ­¤æ—¶å°†çº¿ç¨‹æ± å°†ä½¿ç”¨è¿™ä¸ªå¤„ç†å™¨æ¥å¤„ç†æ–°æäº¤çš„ä»»åŠ¡ã€‚</p><h2 id="çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹"><a href="#çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹" class="headerlink" title="çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹"></a>çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹</h2><img src="/2022/03/05/JUC/%E7%BA%BF%E7%A8%8B%E6%B1%A0/image-20220305174918009.png" class><ol><li>çº¿ç¨‹æ± æ‰§è¡Œexecute&#x2F;submitæ–¹æ³•å‘çº¿ç¨‹æ± æ·»åŠ ä»»åŠ¡ï¼Œå½“çº¿ç¨‹æ•°å°äºcorePoolSizeçš„æ—¶å€™ï¼Œçº¿ç¨‹æ± å°±å¯ä»¥åˆ›å»ºæ–°çš„çº¿ç¨‹</li><li>å½“ä»»åŠ¡å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œå°±å‘é˜Ÿåˆ—æ·»åŠ ä»»åŠ¡</li><li>å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œå°±è¦é€šè¿‡æ¯”è¾ƒmaxinumPolSizeï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ•°å°äºmaxinumPolSizeåœ¨çº¿ç¨‹æ± åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œå¦åˆ™å°±ä¼šæ‰§è¡Œé¥±å’Œç­–ç•¥</li></ol><p>åœ¨è¿™é‡Œä¸¾ä¸ªé©°å“¥ç»™æˆ‘è®²çš„ä¾‹å­ï¼šå‡å¦‚ç°åœ¨æœ‰é“¶è¡Œå°±æ˜¯æˆ‘ä»¬çš„çº¿ç¨‹æ± ï¼Œç°åœ¨é“¶è¡Œæœ‰5ä¸ªä¸šåŠ¡å‘˜ï¼ˆcorePoolSizeï¼‰ï¼Œ50ä¸ªåº§ä½ï¼ˆworkQueueï¼‰ï¼Œè¿˜æœ‰5ä¸ªåŠå…¬åº§ä½ä½†æ˜¯ä»–ä»¬éƒ½å»ä¼‘å‡äº†ï¼ˆmaximumPoolSize-corePoolSizeï¼‰ï¼Œç°åœ¨æœ‰50ä¸ªäººå»åŠç†ä¸šåŠ¡ï¼Œåˆšå¼€å§‹5ä¸ªè¥ä¸šå‘˜å…¨éƒ¨ä¸Šé˜µï¼Œå³corePoolSizeå…¨éƒ¨æŒ‚èµ·ï¼Œä½†æ˜¯äººå®åœ¨æ˜¯å¤ªå¤šäº†ï¼Œç”¨æˆ·å°±ä¸å¾—ä¸ååˆ°åº§ä½ä¸Šå»æ’é˜Ÿï¼Œå¤šä½™çš„è¿›å…¥é˜»å¡é˜Ÿåˆ—workQueueï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™åº§ä½ä¹Ÿä¸å¤Ÿç”¨äº†ï¼Œè¡Œé•¿ä¼šç«‹åˆ»æŠŠå…¶ä»–çš„5ä¸ªä¼‘å‡çš„å‘˜å·¥å…¨éƒ¨å«å›æ¥å·¥ä½œï¼Œç„¶åè®©æ­¤æ—¶è¿˜æ²¡æœ‰åä¸‹æˆ–è€…åŠç†ä¸šåŠ¡çš„ç›´æ¥å›å®¶ï¼ŒåŒæ—¶é“¶è¡Œå…³é—¨ï¼ˆAbortPolicyï¼‰ï¼Œæˆ–è€…ç„¶åè®©æ­¤æ—¶è¿˜æ²¡æœ‰åä¸‹æˆ–è€…åŠç†ä¸šåŠ¡çš„ç›´æ¥å›å®¶ï¼Œä½†æ˜¯é“¶è¡Œä¸å…³é—¨ï¼ˆAbortPolicyï¼‰ï¼Œæˆ–è€…è®©æ­£åœ¨åŠç†çš„ç›´æ¥åœæ­¢åŠç†ï¼Œè®©å…¶ä»–è¿˜æ²¡åä¸‹çš„è¿›è¡ŒåŠç†ï¼ˆAbortPolicyï¼‰ã€‚å½“åŠç†çš„å·®ä¸å¤šçš„æ—¶å€™ï¼Œé“¶è¡Œè¿˜åœ¨ä¼‘å‡å´è¢«è¿«å«å›æ¥å·¥ä½œçš„äººå½“é—²ç½®è¶…è¿‡ä¸€å®šæ—¶é—´(keepAliveTime)å,è¡Œé•¿å°±ä¼šå«ä»–ä»¬å›å»ä¼‘æ¯ã€‚</p><h2 id="çº¿ç¨‹æ± ç±»å‹"><a href="#çº¿ç¨‹æ± ç±»å‹" class="headerlink" title="çº¿ç¨‹æ± ç±»å‹"></a>çº¿ç¨‹æ± ç±»å‹</h2><p>å½“å¤§å®¶çœ‹åˆ°è¿™äº›çº¿ç¨‹æ± ç±»å‹çš„æ—¶å€™ä¸è¦å®³æ€•ï¼Œå…¶å®å°±æ˜¯æå‰æŠŠä¸€äº›æ ¸å¿ƒçº¿ç¨‹è§„å®šæ­»äº†ï¼ŒExecutorsç±»ä¸­å­˜å‚¨äº†å„ç§ç±»å‹å‚æ•°ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šåœ¨æºç å±‚é¢æ¥å‰–æä¸‹é¢çš„å‡ ç§çº¿ç¨‹</p><h3 id="newFixedThreadPool"><a href="#newFixedThreadPool" class="headerlink" title="newFixedThreadPool"></a>newFixedThreadPool</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title function_">newFixedThreadPool</span><span class="hljs-params">(<span class="hljs-type">int</span> nThreads)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(nThreads, nThreads,<br>                                  <span class="hljs-number">0L</span>, TimeUnit.MILLISECONDS,<br>                                  <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;());<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title function_">newFixedThreadPool</span><span class="hljs-params">(<span class="hljs-type">int</span> nThreads, ThreadFactory threadFactory)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(nThreads, nThreads,<br>                                      <span class="hljs-number">0L</span>, TimeUnit.MILLISECONDS,<br>                                      <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(),<br>                                      threadFactory);<br>    &#125;<br></code></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹ä¸Šé¢çš„æ„é€ æ–¹æ³•</p><p>æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸ºåŒä¸€ä¸ªå€¼ä¸”è‡ªå·±æŒ‡å®š</p><p>ç›¸æ¯”ä¸‹é¢å°†è¦ä»‹ç»çš„newCachedThreadPoolï¼ŒnewFixedThreadPool å¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œå½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°è¾¾åˆ°å…¶è®¾å®šå¤§å°æ—¶ï¼Œå…¶ä½™æ–°åˆ›å»ºçš„çº¿ç¨‹ä¼šåœ¨LinkedBlockingQueueé˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚å½“çº¿ç¨‹æ± ä¸­çš„æŸä¸ªçº¿ç¨‹å¤±è´¥è€Œç»ˆæ­¢æ—¶ï¼Œæ–°çš„çº¿ç¨‹ä¼šä»£æ›¿å®ƒæ‰§è¡Œå‰©ä¸‹çš„ä»»åŠ¡ã€‚çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹åªæœ‰åœ¨æ˜¾å¼è°ƒç”¨shutdownå‡½æ•°æ—¶æ‰ä¼šé€€å‡ºçº¿ç¨‹æ± </p><h3 id="newCachedThreadPool"><a href="#newCachedThreadPool" class="headerlink" title="newCachedThreadPool"></a>newCachedThreadPool</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title function_">newCachedThreadPool</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(<span class="hljs-number">0</span>, Integer.MAX_VALUE,<br>                                  <span class="hljs-number">60L</span>, TimeUnit.SECONDS,<br>                                  <span class="hljs-keyword">new</span> <span class="hljs-title class_">SynchronousQueue</span>&lt;Runnable&gt;());<br>&#125;<br></code></pre></td></tr></table></figure><p>æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œæœ€å¤§çº¿ç¨‹æ•°2^31-1,æœ€å¤§ç©ºé—²æ—¶é—´60s</p><p>åˆ›å»º <strong>å¯ç¼“å­˜</strong>çº¿ç¨‹æ± ï¼Œå½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡60sï¼Œä¾¿ä¼šç»ˆæ­¢è¯¥ç©ºé—²çº¿ç¨‹å¹¶ä»ç¼“å­˜çº¿ç¨‹æ± ä¸­ç§»é™¤</p><p>è¯¥çº¿ç¨‹æ± <strong>å¯æ ¹æ®éœ€è¦ï¼Œåˆ›å»ºæ–°çº¿ç¨‹</strong>ï¼Œä»ä¸Šé¢ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œå…¶çº¿ç¨‹æ•°æœ€å¤§å¯ä¸ºInteger.MAX_VALUEï¼Œå¦‚æœæ§åˆ¶ä¸å¥½ï¼Œä½¿ç”¨è¯¥çº¿ç¨‹æ± å¯èƒ½å¯¼è‡´çº¿ç¨‹åˆ›å»ºè¿‡å¤šï¼Œåè€Œå½±å“æ€§èƒ½ã€‚å› æ­¤ï¼Œå¯ä»¥æ³¨æ„ä¸€ä¸‹è¯¥çº¿ç¨‹æ± çš„ä½¿ç”¨åœºæ™¯ï¼šå¯¹äº<strong>å¤§é‡çŸ­æš‚å¼‚æ­¥ä»»åŠ¡</strong>çš„ç¨‹åºæ¥è¯´ï¼Œä½¿ç”¨è¯¥çº¿ç¨‹æ± èƒ½å¤Ÿ<strong>å¤§å¤§æé«˜æ€§èƒ½</strong> </p><p>åœ¨ä½¿ç”¨CachedThreadPoolæ—¶ï¼Œä¸€å®šè¦æ³¨æ„æ§åˆ¶ä»»åŠ¡çš„æ•°é‡ï¼Œå¦åˆ™ï¼Œç”±äºå¤§é‡çº¿ç¨‹åŒæ—¶è¿è¡Œï¼Œå¾ˆæœ‰ä¼šé€ æˆç³»ç»ŸOOMã€‚</p><h3 id="newSingleThreadExecutor"><a href="#newSingleThreadExecutor" class="headerlink" title="newSingleThreadExecutor"></a>newSingleThreadExecutor</h3><p>åˆ›å»º<strong>å•çº¿ç¨‹</strong>çš„çº¿ç¨‹æ±  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ExecutorService <span class="hljs-title function_">newSingleThreadExecutor</span><span class="hljs-params">(ThreadFactory threadFactory)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FinalizableDelegatedExecutorService</span><br>        (<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>,<br>                                <span class="hljs-number">0L</span>, TimeUnit.MILLISECONDS,<br>                                <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(),<br>                                threadFactory));<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ„é€ å‡½æ•°é‡Œåªå…è®¸ä¸€ä¸ªçº¿ç¨‹</p><p>è¯¥å•çº¿ç¨‹åœ¨shutdownä¹‹å‰ç”±äºå¤±è´¥è€Œç»ˆæ­¢æ—¶ï¼Œå°†ä¼šæœ‰æ–°çš„çº¿ç¨‹æ¥ä»£æ›¿å®ƒæ‰§è¡Œå‰©ä¸‹ä»»åŠ¡ã€‚åŠ å…¥åˆ°è¯¥çº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹ä¼šæŒ‰é¡ºåºæ‰§è¡Œï¼Œä¸€ä¸ªæ—¶åˆ»ä¿è¯ <strong>åªæœ‰ä¸€ä¸ªçº¿ç¨‹</strong>åœ¨è¿è¡Œ</p><h3 id="newScheduledThreadPool"><a href="#newScheduledThreadPool" class="headerlink" title="newScheduledThreadPool"></a>newScheduledThreadPool</h3><p>åˆ›å»º <strong>å›ºå®šå¤§å°</strong>ä¸”èƒ½å¤Ÿæ‰§è¡Œ <strong>å®šæ—¶æˆ–å‘¨æœŸæ€§</strong>ä»»åŠ¡çš„çº¿ç¨‹æ±  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ScheduledExecutorService <span class="hljs-title function_">newScheduledThreadPool</span><span class="hljs-params">(</span><br><span class="hljs-params">        <span class="hljs-type">int</span> corePoolSize, ThreadFactory threadFactory)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScheduledThreadPoolExecutor</span>(corePoolSize, threadFactory);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡ŒæŒ‡å®šäº†corePoolSize å’Œå·¥å‚ç±»å‹</p><h2 id="çº¿ç¨‹æ± å¸¸ç”¨é˜»å¡é˜Ÿåˆ—"><a href="#çº¿ç¨‹æ± å¸¸ç”¨é˜»å¡é˜Ÿåˆ—" class="headerlink" title="çº¿ç¨‹æ± å¸¸ç”¨é˜»å¡é˜Ÿåˆ—"></a>çº¿ç¨‹æ± å¸¸ç”¨é˜»å¡é˜Ÿåˆ—</h2><h3 id="ArrayBlockingQueue"><a href="#ArrayBlockingQueue" class="headerlink" title="ArrayBlockingQueue"></a>ArrayBlockingQueue</h3><p>æ˜¯ä¸€ä¸ªåŸºäºæ•°ç»„ç»“æ„çš„<strong>æœ‰ç•Œ</strong>é˜»å¡é˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—æŒ‰ FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰åŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚</p><img src="/2022/03/05/JUC/%E7%BA%BF%E7%A8%8B%E6%B1%A0/image-20220305193326775.png" class><ul><li>ArrayBlockingQueueæ˜¯ä¸€ä¸ªç”¨æ•°ç»„å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</li><li>é˜Ÿåˆ—æ…¢æ—¶æ’å…¥æ“ä½œè¢«é˜»å¡ï¼Œé˜Ÿåˆ—ç©ºæ—¶ï¼Œç§»é™¤æ“ä½œè¢«é˜»å¡ã€‚</li><li>æŒ‰ç…§å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰åŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚</li><li>é»˜è®¤ä¸ä¿è¯çº¿ç¨‹å…¬å¹³çš„è®¿é—®é˜Ÿåˆ—ã€‚</li><li>å…¬å¹³è®¿é—®é˜Ÿåˆ—ï¼šæŒ‰ç…§é˜»å¡çš„å…ˆåé¡ºåºè®¿é—®é˜Ÿåˆ—ï¼Œå³å…ˆé˜»å¡çš„çº¿ç¨‹å…ˆè®¿é—®é˜Ÿåˆ—ã€‚</li><li>éå…¬å¹³æ€§æ˜¯å¯¹å…ˆç­‰å¾…çš„çº¿ç¨‹æ˜¯éå…¬å¹³çš„ï¼Œå½“é˜Ÿåˆ—å¯ç”¨æ—¶ï¼Œé˜»å¡çš„çº¿ç¨‹éƒ½å¯ä»¥äº‰å¤ºè®¿é—®é˜Ÿåˆ—çš„èµ„æ ¼ã€‚æœ‰å¯èƒ½å…ˆé˜»å¡çš„çº¿ç¨‹æœ€åæ‰è®¿é—®è®¿é—®é˜Ÿåˆ—ã€‚</li><li>å…¬å¹³æ€§ä¼šé™ä½ååé‡ã€‚</li></ul><h3 id="LinkedBlockingQueue"><a href="#LinkedBlockingQueue" class="headerlink" title="LinkedBlockingQueue"></a>LinkedBlockingQueue</h3><p>ä¸€ä¸ªåŸºäºé“¾è¡¨ç»“æ„çš„é˜»å¡é˜Ÿåˆ—ï¼Œæ­¤é˜Ÿåˆ—æŒ‰ FIFO æ’åºå…ƒç´ ï¼Œååé‡é€šå¸¸è¦é«˜äº ArrayBlockingQueueã€‚é™æ€å·¥å‚æ–¹æ³• Executors.newFixedThreadPool() ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚ï¼ˆnewFixedThreadPool ç”¨äºåˆ›å»ºå›ºå®šçº¿ç¨‹æ•°ï¼‰</p><img src="/2022/03/05/JUC/%E7%BA%BF%E7%A8%8B%E6%B1%A0/image-20220305193501103.png" class><ul><li>LinkedBlockingQueueå…·æœ‰å•é“¾è¡¨å’Œ<strong>æ— ç•Œ</strong>é˜»å¡é˜Ÿåˆ—çš„åŠŸèƒ½ã€‚</li><li>é˜Ÿåˆ—æ…¢æ—¶æ’å…¥æ“ä½œè¢«é˜»å¡ï¼Œé˜Ÿåˆ—ç©ºæ—¶ï¼Œç§»é™¤æ“ä½œè¢«é˜»å¡ã€‚</li><li>é»˜è®¤å’Œæœ€å¤§é•¿åº¦ä¸ºInteger.MAX_VALUEï¼Œç›¸å½“äºæ— ç•Œ(å€¼éå¸¸å¤§ï¼š2^31-1)ã€‚</li></ul><h3 id="SynchronousQueue"><a href="#SynchronousQueue" class="headerlink" title="SynchronousQueue"></a>SynchronousQueue</h3><p>ä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚æ¯ä¸ªæ’å…¥æ“ä½œå¿…é¡»ç­‰åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ç§»é™¤æ“ä½œï¼Œå¦åˆ™æ’å…¥æ“ä½œä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ï¼Œååé‡é€šå¸¸è¦é«˜äº LinkedBlockingQueueï¼Œé™æ€å·¥å‚æ–¹æ³• Executors.newCachedThreadPool ä½¿ç”¨è¿™ä¸ªé˜Ÿåˆ—ã€‚ï¼ˆnewCachedThreadPool ç”¨äºæ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹ï¼‰</p><img src="/2022/03/05/JUC/%E7%BA%BF%E7%A8%8B%E6%B1%A0/image-20220305194503741.png" class><h3 id="PriorityBlockingQueue"><a href="#PriorityBlockingQueue" class="headerlink" title="PriorityBlockingQueue"></a>PriorityBlockingQueue</h3><p>ä¸€ä¸ªå…·æœ‰ä¼˜å…ˆçº§çš„æ— é™é˜»å¡é˜Ÿåˆ—ã€‚</p><h2 id="å¦‚ä½•åˆç†é…ç½®çº¿ç¨‹æ± å‚æ•°"><a href="#å¦‚ä½•åˆç†é…ç½®çº¿ç¨‹æ± å‚æ•°" class="headerlink" title="å¦‚ä½•åˆç†é…ç½®çº¿ç¨‹æ± å‚æ•°"></a>å¦‚ä½•åˆç†é…ç½®çº¿ç¨‹æ± å‚æ•°</h2><p>è‡ªå®šä¹‰çº¿ç¨‹æ± éœ€è¦é…ç½®maxinumPoolSize</p><h3 id="CPUå¯†é›†å‹"><a href="#CPUå¯†é›†å‹" class="headerlink" title="CPUå¯†é›†å‹"></a>CPUå¯†é›†å‹</h3><p>CPUå¯†é›†å‹æ„æ€æ˜¯è¯¥ä»»åŠ¡éœ€è¦å¤§é‡çš„è¿ç®—ï¼Œæ²¡æœ‰é˜»å¡ï¼ŒCPUä¸€ç›´å…¨é€Ÿè¿è¡Œï¼ŒCPUå¯†é›†å‹åªæœ‰åœ¨å¤šæ ¸CPUæ‰å¯ä»¥åŠ é€Ÿï¼Œè€Œå•æ ¸CPUæ— è®ºå‡ ä¸ªçº¿ç¨‹éƒ½ä¸å¯èƒ½åŠ é€Ÿã€‚</p><h3 id="IOå¯†é›†å‹"><a href="#IOå¯†é›†å‹" class="headerlink" title="IOå¯†é›†å‹"></a>IOå¯†é›†å‹</h3><p>å³è¯¥ä»»åŠ¡éœ€è¦å¤§é‡IOï¼Œå³å¤§é‡çš„é˜»å¡ï¼Œå•çº¿ç¨‹ä¸Šè¿è¡ŒIOå¯†é›†å‹ä»»åŠ¡ä¼šå¯¼è‡´å¤§é‡CPUæµªè´¹åœ¨é˜»å¡ä¸Šï¼Œæ‰€ä»¥å¤šçº¿ç¨‹å¯ä»¥ä½¿ç”¨IOå¯†é›†å‹</p><p>IOå¯†é›†å‹å…¬å¼å¦‚ä¸‹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">CPU</span>æ ¸æ•°*<span class="hljs-number">2</span><br><br><span class="hljs-attribute">CPU</span>æ ¸æ•°/ï¼ˆ<span class="hljs-number">1</span>-é˜»å¡ç³»æ•°ï¼‰é˜»å¡ç³»æ•°é€šå¸¸åœ¨<span class="hljs-number">0</span>.<span class="hljs-number">8</span>~<span class="hljs-number">0</span>.<span class="hljs-number">9</span> <br></code></pre></td></tr></table></figure><h3 id="å¾—åˆ°è‡ªå·±çš„CPUæ ¸æ•°"><a href="#å¾—åˆ°è‡ªå·±çš„CPUæ ¸æ•°" class="headerlink" title="å¾—åˆ°è‡ªå·±çš„CPUæ ¸æ•°"></a>å¾—åˆ°è‡ªå·±çš„CPUæ ¸æ•°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getCpuCoreNumber</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(Runtime.getRuntime().availableProcessors());<br>    &#125;<br></code></pre></td></tr></table></figure><img src="/2022/03/05/JUC/%E7%BA%BF%E7%A8%8B%E6%B1%A0/image-20220305195451067.png" class><p>å¯ä»¥çœ‹åˆ°æˆ‘çš„ç”µè„‘ä¸º8æ ¸</p>]]></content>
    
    
    <categories>
      
      <category>JUC</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JUC</tag>
      
      <tag>çº¿ç¨‹æ± </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stream</title>
    <link href="/2022/03/04/Java%E5%9F%BA%E7%A1%80/Stream/"/>
    <url>/2022/03/04/Java%E5%9F%BA%E7%A1%80/Stream/</url>
    
    <content type="html"><![CDATA[<h1 id="Java8æ–°ç‰¹æ€§"><a href="#Java8æ–°ç‰¹æ€§" class="headerlink" title="Java8æ–°ç‰¹æ€§"></a>Java8æ–°ç‰¹æ€§</h1><p>é€Ÿåº¦æ›´å¿«</p><p><strong>lanbdaè¡¨è¾¾å¼</strong></p><p><strong>å¼ºå¤§çš„Stream API</strong></p><p>ä¾¿äºå¹¶è¡Œ</p><p>æœ€å¤§åŒ–å‡å°‘ç©ºæŒ‡é’ˆå¼‚å¸¸ Optional</p><h2 id="lambdaè¡¨è¾¾å¼"><a href="#lambdaè¡¨è¾¾å¼" class="headerlink" title="lambdaè¡¨è¾¾å¼"></a>lambdaè¡¨è¾¾å¼</h2><p>å³ä¸€ç§åŒ¿åå‡½æ•°ï¼Œå¯ä»¥å°†å…¶ç†è§£ä¸ºä¸€æ®µå¯ä»¥ä¼ é€’çš„åˆ°å—ã€‚å¯ä»¥ç”¨é€šè¿‡å®ƒå†™å‡ºæ›´åŠ ç®€ä»‹çµæ´»çš„ä»£ç ã€‚</p><figure class="highlight livescript"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-function"><span class="hljs-params">(å‚æ•°ç±»å‹ï¼Œå‚æ•°åç§°)</span> -&gt;</span>&#123;ä»£ç ä½“&#125;<br></code></pre></td></tr></table></figure><p><strong>æ ¼å¼è¯´æ˜</strong></p><ul><li>(å‚æ•°ç±»å‹ï¼Œå‚æ•°åç§°)ï¼š å‚æ•°åˆ—è¡¨</li><li>{ä»£ç ä½“}ï¼šæ–¹æ³•ä½“</li><li>-&gt;åˆ†å‰²å‚æ•°å’Œä»£ç </li></ul><h2 id="lambdaå¸¸ç”¨æ–¹æ³•ä¸¾ä¾‹"><a href="#lambdaå¸¸ç”¨æ–¹æ³•ä¸¾ä¾‹" class="headerlink" title="lambdaå¸¸ç”¨æ–¹æ³•ä¸¾ä¾‹"></a>lambdaå¸¸ç”¨æ–¹æ³•ä¸¾ä¾‹</h2><h3 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">threadTest2</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// å‡†å¤‡ä¸€ä¸ªé›†åˆï¼ŒæŒ‰ç…§å¹´é¾„è¿›è¡Œæ’åº</span><br>    <span class="hljs-type">List</span> <span class="hljs-variable">persons</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();<br>    persons.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">3</span>));<br>    persons.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">2</span>));<br>    persons.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">3</span>));<br>    persons.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">4</span>));<br>    Collections.sort(persons, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparator</span>&lt;Person&gt;() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(Person o1, Person o2)</span> &#123;<br>            <span class="hljs-keyword">return</span> o2.getAge() - o1.getAge();<br>        &#125;<br>    &#125;);<br>    <span class="hljs-comment">// lambdaæ–¹æ³•</span><br>    Collections.sort(persons, ((Person o1, Person o2) -&gt; o1.getAge() - o2.getAge()));<br>    <span class="hljs-comment">// Comparatoræ–¹æ³•</span><br>    Collections.sort(persons, (Comparator.comparingInt(Person::getAge)));<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">threadTest</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;run.&quot;</span>);<br>        &#125;<br>    &#125;).start();<br>&#125;<br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">threadTest1</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(()-&gt; System.out.println(<span class="hljs-string">&quot;run...&quot;</span>)).start();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Streamæµ"><a href="#Streamæµ" class="headerlink" title="Streamæµ"></a>Streamæµ</h2><img src="/2022/03/04/Java%E5%9F%BA%E7%A1%80/Stream/image-20220304142440618.png" class><p>streamæµå¼æ€æƒ³ç±»ä¼¼äº<strong>ç”Ÿäº§æµæ°´çº¿</strong>ï¼ŒStreamæµä¸æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œä¸ä¿å­˜æ•°æ®ï¼Œè€Œæ˜¯å¯¹æ•°æ®è¿›è¡ŒåŠ å·¥ å¤„ç†ã€‚Streamå¯ä»¥çœ‹ä½œæ˜¯æµæ°´çº¿ä¸Šçš„ä¸€ä¸ªå·¥åºã€‚åœ¨æµæ°´çº¿ä¸Šï¼Œé€šè¿‡å¤šä¸ªå·¥åºè®©ä¸€ä¸ªåŸææ–™åŠ å·¥æˆä¸€ä¸ªå•†å“ã€‚</p><p>Stream APIèƒ½è®©æˆ‘ä»¬å¿«é€Ÿå®Œæˆè®¸å¤šå¤æ‚çš„æ“ä½œï¼Œå¦‚ç­›é€‰ã€åˆ‡ç‰‡ã€æ˜ å°„ã€æŸ¥æ‰¾ã€å»é™¤é‡å¤ï¼Œç»Ÿè®¡ï¼ŒåŒ¹é…å’Œå½’çº¦ã€‚</p><h3 id="è·å–streamæµä¸¤ç§æ–¹å¼"><a href="#è·å–streamæµä¸¤ç§æ–¹å¼" class="headerlink" title="è·å–streamæµä¸¤ç§æ–¹å¼"></a>è·å–streamæµä¸¤ç§æ–¹å¼</h3><h4 id="æ ¹æ®Collectionè·å–æµ"><a href="#æ ¹æ®Collectionè·å–æµ" class="headerlink" title="æ ¹æ®Collectionè·å–æµ"></a>æ ¹æ®Collectionè·å–æµ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-comment">// é›†åˆè·å–æµ</span><br><span class="hljs-comment">// Collectionæ¥å£ä¸­çš„æ–¹æ³•: default Stream&lt;E&gt; stream() è·å–æµ</span><br>List&lt;String&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><span class="hljs-comment">// ...</span><br>Stream&lt;String&gt; stream1 = list.stream();<br>Set&lt;String&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();<br><span class="hljs-comment">// ...</span><br>Stream&lt;String&gt; stream2 = set.stream();<br>Vector&lt;String&gt; vector = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vector</span>&lt;&gt;();<br><span class="hljs-comment">// ...</span><br>Stream&lt;String&gt; stream3 = vector.stream();<br>&#125;<br></code></pre></td></tr></table></figure><p><code>java.util.Map</code> æ¥å£ä¸æ˜¯ Collection çš„å­æ¥å£ï¼Œæ‰€ä»¥è·å–å¯¹åº”çš„æµéœ€è¦åˆ†keyã€valueæˆ–entryç­‰æƒ…å†µï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-comment">// Mapè·å–æµ</span><br>Map&lt;String, String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><span class="hljs-comment">// ...</span><br>Stream&lt;String&gt; keyStream = map.keySet().stream();<br>Stream&lt;String&gt; valueStream = map.values().stream();<br>Stream&lt;Map.Entry&lt;String, String&gt;&gt; entryStream = map.entrySet().stream();<br>&#125;<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123; <span class="hljs-comment">// Mapè·å–æµ Map map = new HashMap&lt;&gt;(); // ... Stream keyStream = map.keySet().stream(); Stream valueStream = map.values().stream(); Stream&gt; entryStream = map.entrySet().stream(); &#125;</span><br></code></pre></td></tr></table></figure><h4 id="æ–¹å¼2-Streamä¸­çš„é™æ€æ–¹æ³•ofè·å–æµ"><a href="#æ–¹å¼2-Streamä¸­çš„é™æ€æ–¹æ³•ofè·å–æµ" class="headerlink" title="æ–¹å¼2 : Streamä¸­çš„é™æ€æ–¹æ³•ofè·å–æµ"></a>æ–¹å¼2 : Streamä¸­çš„é™æ€æ–¹æ³•ofè·å–æµ</h4><p>ç”±äºæ•°ç»„å¯¹è±¡ä¸å¯èƒ½æ·»åŠ é»˜è®¤æ–¹æ³•ï¼Œæ‰€ä»¥ Stream æ¥å£ä¸­æä¾›äº†é™æ€æ–¹æ³• of ï¼Œä½¿ç”¨å¾ˆç®€å•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-comment">// Streamä¸­çš„é™æ€æ–¹æ³•: static Stream of(T... values)</span><br>Stream&lt;String&gt; stream6 = Stream.of(<span class="hljs-string">&quot;aa&quot;</span>, <span class="hljs-string">&quot;bb&quot;</span>, <span class="hljs-string">&quot;cc&quot;</span>);<br>String[] arr = &#123;<span class="hljs-string">&quot;aa&quot;</span>, <span class="hljs-string">&quot;bb&quot;</span>, <span class="hljs-string">&quot;cc&quot;</span>&#125;;<br>Stream&lt;String&gt; stream7 = Stream.of(arr);<br>Integer[] arr2 = &#123;<span class="hljs-number">11</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>&#125;;<br>Stream&lt;Integer&gt; stream8 = Stream.of(arr2);<br><span class="hljs-comment">// æ³¨æ„:åŸºæœ¬æ•°æ®ç±»å‹çš„æ•°ç»„ä¸è¡Œ</span><br><span class="hljs-type">int</span>[] arr3 = &#123;<span class="hljs-number">11</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>&#125;;<br>Stream&lt;<span class="hljs-type">int</span>[]&gt; stream9 = Stream.of(arr3);<br></code></pre></td></tr></table></figure><blockquote><p> å¤‡æ³¨ï¼š of æ–¹æ³•çš„å‚æ•°å…¶å®æ˜¯ä¸€ä¸ªå¯å˜å‚æ•°ï¼Œæ‰€ä»¥æ”¯æŒæ•°ç»„ã€‚</p></blockquote><h3 id="stream-å¸¸ç”¨æ–¹æ³•"><a href="#stream-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="stream å¸¸ç”¨æ–¹æ³•"></a>stream å¸¸ç”¨æ–¹æ³•</h3><table><thead><tr><th>æ–¹æ³•å</th><th>æ–¹æ³•ä½œç”¨</th><th>è¿”å›å€¼</th><th>æ–¹æ³•ç§ç±»</th></tr></thead><tbody><tr><td>forEach</td><td>é€ä¸€å¤„ç†</td><td>void</td><td>ç»ˆç»“</td></tr><tr><td>count</td><td>ç»Ÿè®¡ä¸ªæ•°</td><td>long</td><td>ç»ˆç»“</td></tr><tr><td>filter</td><td>è¿‡æ»¤</td><td>Stream</td><td>å‡½æ•°æ‹¼æ¥</td></tr><tr><td>limit</td><td>å–ç”¨å‰å‡ ä¸ª</td><td>Stream</td><td>å‡½æ•°æ‹¼æ¥</td></tr><tr><td>skip</td><td>è·³è¿‡å‰å‡ ä¸ª</td><td>Stream</td><td>å‡½æ•°æ‹¼æ¥</td></tr><tr><td>map</td><td>æ˜ å°„</td><td>Stream</td><td>å‡½æ•°æ‹¼æ¥</td></tr><tr><td>concat</td><td>ç»„åˆ</td><td>Stream</td><td>å‡½æ•°æ‹¼æ¥</td></tr></tbody></table><p>ç»ˆç»“æ–¹æ³•ï¼šè¿”å›å€¼ç±»å‹ä¸å†æ˜¯ Stream ç±»å‹çš„æ–¹æ³•ï¼Œä¸å†æ”¯æŒé“¾å¼è°ƒç”¨ã€‚æœ¬å°èŠ‚ä¸­ï¼Œç»ˆç»“æ–¹æ³•åŒ…æ‹¬ count å’Œ forEach æ–¹æ³•ã€‚ </p><p>éç»ˆç»“æ–¹æ³•ï¼šè¿”å›å€¼ç±»å‹ä»ç„¶æ˜¯ Stream ç±»å‹çš„æ–¹æ³•ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨ã€‚ï¼ˆé™¤äº†ç»ˆç»“æ–¹æ³•å¤–ï¼Œå…¶ä½™æ–¹æ³•å‡ä¸ºéç»ˆç»“ æ–¹æ³•ã€‚ï¼‰</p><h3 id="streamæ³¨æ„äº‹é¡¹"><a href="#streamæ³¨æ„äº‹é¡¹" class="headerlink" title="streamæ³¨æ„äº‹é¡¹"></a>streamæ³¨æ„äº‹é¡¹</h3><ol><li>Streamåªèƒ½æ“ä½œä¸€æ¬¡ </li><li>Streamæ–¹æ³•è¿”å›çš„æ˜¯æ–°çš„æµ</li><li>ä¸è°ƒç”¨ç»ˆç»“æ–¹æ³•ï¼Œä¸­é—´çš„æ“ä½œä¸ä¼šæ‰§è¡Œ</li></ol><h3 id="é«˜çº§é›†åˆçš„streamæ–¹æ³•"><a href="#é«˜çº§é›†åˆçš„streamæ–¹æ³•" class="headerlink" title="é«˜çº§é›†åˆçš„streamæ–¹æ³•"></a>é«˜çº§é›†åˆçš„streamæ–¹æ³•</h3><h4 id="forEach"><a href="#forEach" class="headerlink" title="forEach"></a>forEach</h4><p>forEach ç”¨æ¥éå†æµä¸­çš„æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testForEach</span><span class="hljs-params">()</span> &#123;<br>        List&lt;String&gt; one = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        Collections.addAll(one, <span class="hljs-string">&quot;è¿ªä¸½çƒ­å·´&quot;</span>, <span class="hljs-string">&quot;å®‹è¿œæ¡¥&quot;</span>, <span class="hljs-string">&quot;è‹æ˜Ÿæ²³&quot;</span>, <span class="hljs-string">&quot;è€å­&quot;</span>, <span class="hljs-string">&quot;åº„å­&quot;</span>, <span class="hljs-string">&quot;å­™å­&quot;</span>);<br>        one.stream().forEach((String s) -&gt; &#123;<br>            System.out.println(s);<br>        &#125;);<br>        <span class="hljs-comment">// ç®€å†™</span><br>        one.stream().forEach(s -&gt; System.out.println(s));<br>        one.stream().forEach(System.out::println);<br>        one.forEach(System.out::println);<br>    &#125;<br></code></pre></td></tr></table></figure><h4 id="count"><a href="#count" class="headerlink" title="count"></a>count</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">testCount</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; one = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><span class="hljs-title class_">Collections</span>.<span class="hljs-title function_">addAll</span>(one, <span class="hljs-string">&quot;è¿ªä¸½çƒ­å·´&quot;</span>, <span class="hljs-string">&quot;å®‹è¿œæ¡¥&quot;</span>, <span class="hljs-string">&quot;è‹æ˜Ÿæ²³&quot;</span>, <span class="hljs-string">&quot;è€å­&quot;</span>, <span class="hljs-string">&quot;åº„å­&quot;</span>, <span class="hljs-string">&quot;å­™å­&quot;</span>);<br><span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(one.<span class="hljs-title function_">stream</span>().<span class="hljs-title function_">count</span>());<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h4><p>å¯ä»¥é€šè¿‡ filter æ–¹æ³•å°†ä¸€ä¸ªæµè½¬æ¢æˆå¦ä¸€ä¸ªå­é›†æµã€‚æ–¹æ³•å£°æ˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Stream&lt;T&gt; <span class="hljs-title function_">filter</span><span class="hljs-params">(Predicate&lt;? <span class="hljs-built_in">super</span> T&gt; predicate)</span><br></code></pre></td></tr></table></figure><img src="/2022/03/04/Java%E5%9F%BA%E7%A1%80/Stream/image-20220304150606735.png" class><p>è¯¥æ¥å£æ¥æ”¶ä¸€ä¸ª Predicate å‡½æ•°å¼æ¥å£å‚æ•°ï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªLambdaæˆ–æ–¹æ³•å¼•ç”¨ï¼‰ä½œä¸ºç­›é€‰æ¡ä»¶ã€‚</p><p> Streamæµä¸­çš„ filter æ–¹æ³•åŸºæœ¬ä½¿ç”¨çš„ä»£ç å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFilter</span><span class="hljs-params">()</span> &#123;<br>List&lt;String&gt; one = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>Collections.addAll(one, <span class="hljs-string">&quot;è¿ªä¸½çƒ­å·´&quot;</span>, <span class="hljs-string">&quot;å®‹è¿œæ¡¥&quot;</span>, <span class="hljs-string">&quot;è‹æ˜Ÿæ²³&quot;</span>, <span class="hljs-string">&quot;è€å­&quot;</span>, <span class="hljs-string">&quot;åº„å­&quot;</span>, <span class="hljs-string">&quot;å­™å­&quot;</span>);<br>one.stream().filter(s -&gt; s.length() == <span class="hljs-number">2</span>).forEach(System.out::println);<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h4><p>limit æ–¹æ³•å¯ä»¥å¯¹æµè¿›è¡Œæˆªå–ï¼Œåªå–ç”¨å‰nä¸ªã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testLimit</span><span class="hljs-params">()</span> &#123;<br>List&lt;String&gt; one = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>Collections.addAll(one, <span class="hljs-string">&quot;è¿ªä¸½çƒ­å·´&quot;</span>, <span class="hljs-string">&quot;å®‹è¿œæ¡¥&quot;</span>, <span class="hljs-string">&quot;è‹æ˜Ÿæ²³&quot;</span>, <span class="hljs-string">&quot;è€å­&quot;</span>, <span class="hljs-string">&quot;åº„å­&quot;</span>, <span class="hljs-string">&quot;å­™å­&quot;</span>);<br>one.stream().limit(<span class="hljs-number">3</span>).forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="skip"><a href="#skip" class="headerlink" title="skip"></a>skip</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSkip</span><span class="hljs-params">()</span> &#123;<br>List&lt;String&gt; one = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>Collections.addAll(one, <span class="hljs-string">&quot;è¿ªä¸½çƒ­å·´&quot;</span>, <span class="hljs-string">&quot;å®‹è¿œæ¡¥&quot;</span>, <span class="hljs-string">&quot;è‹æ˜Ÿæ²³&quot;</span>, <span class="hljs-string">&quot;è€å­&quot;</span>, <span class="hljs-string">&quot;åº„å­&quot;</span>, <span class="hljs-string">&quot;å­™å­&quot;</span>);<br>one.stream().skip(<span class="hljs-number">2</span>).forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="streamæµä¸­çš„æ–¹æ³•"><a href="#streamæµä¸­çš„æ–¹æ³•" class="headerlink" title="streamæµä¸­çš„æ–¹æ³•"></a>streamæµä¸­çš„æ–¹æ³•</h3><h4 id="mapæ–¹æ³•"><a href="#mapæ–¹æ³•" class="headerlink" title="mapæ–¹æ³•"></a>mapæ–¹æ³•</h4><p>åˆ©ç”¨mapæ–¹æ³•ç”¨ä¸€ä¸ªå¯¹å¦ä¸€ä¸ªè¿›è¡Œæ˜ å°„</p><img src="/2022/03/04/Java%E5%9F%BA%E7%A1%80/Stream/image-20220304152557456.png" class><p>è¯¥æ¥å£éœ€è¦ä¸€ä¸ª Function å‡½æ•°å¼æ¥å£å‚æ•°ï¼Œå¯ä»¥å°†å½“å‰æµä¸­çš„Tç±»å‹æ•°æ®è½¬æ¢ä¸ºå¦ä¸€ç§Rç±»å‹çš„æµã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testMap</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-comment">// è½¬åŒ–ä¸ºæµå¼æ•°æ®</span><br>       Stream&lt;String&gt; original = Stream.of(<span class="hljs-string">&quot;11&quot;</span>, <span class="hljs-string">&quot;22&quot;</span>, <span class="hljs-string">&quot;33&quot;</span>);<br>       <span class="hljs-comment">// æµå¼æ•°æ®åˆ©ç”¨mapè¿›è¡Œæ˜ å°„</span><br>       Stream&lt;Integer&gt; result = original.map(Integer::parseInt);<br>       <span class="hljs-comment">// è¿›è¡Œéå†</span><br>       result.forEach(s -&gt; System.out.println(s + <span class="hljs-number">10</span>));<br>   &#125;<br></code></pre></td></tr></table></figure><h4 id="sortedæ–¹æ³•"><a href="#sortedæ–¹æ³•" class="headerlink" title="sortedæ–¹æ³•"></a>sortedæ–¹æ³•</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSorted</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-comment">// sorted(): æ ¹æ®å…ƒç´ çš„è‡ªç„¶é¡ºåºæ’åº</span><br><span class="hljs-comment">// sorted(Comparator&lt;? super T&gt; comparator): æ ¹æ®æ¯”è¾ƒå™¨æŒ‡å®šçš„è§„åˆ™æ’åº</span><br>Stream.of(<span class="hljs-number">33</span>, <span class="hljs-number">22</span>, <span class="hljs-number">11</span>, <span class="hljs-number">55</span>)<br>.sorted()<br>.sorted((o1, o2) -&gt; o2 - o1)<br>.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="distinct"><a href="#distinct" class="headerlink" title="distinct"></a>distinct</h4><p>ç”¨æ¥å»é™¤é‡å¤æ•°æ®ï¼Œè‡ªå®šä¹‰å¯¹è±¡æ ¹æ®å¯¹è±¡çš„hashCodeå’Œequalsæ¥å»é™¤é‡å¤å…ƒç´ çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testDistinct</span><span class="hljs-params">()</span> &#123;<br>Stream.of(<span class="hljs-number">22</span>, <span class="hljs-number">33</span>, <span class="hljs-number">22</span>, <span class="hljs-number">11</span>, <span class="hljs-number">33</span>)<br>.distinct()<br>.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="match"><a href="#match" class="headerlink" title="match"></a>match</h4><p>ç”¨äºæ¡ä»¶åŒ¹é…ï¼Œè¿”å›trueæˆ–false</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testMatch</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">boolean</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> Stream.of(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>)<br><span class="hljs-comment">// .allMatch(e -&gt; e &gt; 0); // allMatch: å…ƒç´ æ˜¯å¦å…¨éƒ¨æ»¡è¶³æ¡ä»¶</span><br><span class="hljs-comment">// .anyMatch(e -&gt; e &gt; 5); // anyMatch: å…ƒç´ æ˜¯å¦ä»»æ„æœ‰ä¸€ä¸ªæ»¡è¶³æ¡ä»¶</span><br>.noneMatch(e -&gt; e &lt; <span class="hljs-number">0</span>); <span class="hljs-comment">// noneMatch: å…ƒç´ æ˜¯å¦å…¨éƒ¨ä¸æ»¡è¶³æ¡ä»¶</span><br>System.out.println(<span class="hljs-string">&quot;b = &quot;</span> + b);<br>&#125;<br></code></pre></td></tr></table></figure><p>find</p><p>å¦‚æœéœ€è¦æ‰¾åˆ°æŸäº›æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ find ç›¸å…³æ–¹æ³•ã€‚æ–¹æ³•ç­¾åï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFind</span><span class="hljs-params">()</span> &#123;<br>Optional&lt;Integer&gt; first = Stream.of(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>).findFirst();<br>System.out.println(<span class="hljs-string">&quot;first = &quot;</span> + first.get());<br>Optional&lt;Integer&gt; any = Stream.of(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>).findAny();<br>System.out.println(<span class="hljs-string">&quot;any = &quot;</span> + any.get());<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="max-or-min"><a href="#max-or-min" class="headerlink" title="max or min"></a>max or min</h4><img src="/2022/03/04/Java%E5%9F%BA%E7%A1%80/Stream/image-20220304155554435.png" class><p>å¦‚æœéœ€è¦è·å–æœ€å¤§å’Œæœ€å°å€¼ï¼Œå¯ä»¥ä½¿ç”¨ max å’Œ min æ–¹æ³•ã€‚æ–¹æ³•ç­¾åï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">Optional&lt;T&gt; <span class="hljs-title function_">max</span><span class="hljs-params">(Comparator&lt;? <span class="hljs-built_in">super</span> T&gt; comparator)</span>;<br>Optional&lt;T&gt; <span class="hljs-title function_">min</span><span class="hljs-params">(Comparator&lt;? <span class="hljs-built_in">super</span> T&gt; comparator)</span>;<br></code></pre></td></tr></table></figure><p>åŸºæœ¬ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testMax_Min</span><span class="hljs-params">()</span> &#123;<br>Optional&lt;Integer&gt; max = Stream.of(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>).max((o1, o2) -&gt; o1 - o2);<br>System.out.println(<span class="hljs-string">&quot;first = &quot;</span> + max.get());<br>Optional&lt;Integer&gt; min = Stream.of(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>).min((o1, o2) -&gt; o1 - o2);<br>System.out.println(<span class="hljs-string">&quot;any = &quot;</span> + min.get());<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testReduce</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">reduce</span> <span class="hljs-operator">=</span> Stream.of(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>)<br>            .reduce(<span class="hljs-number">0</span>, (a, b) -&gt; &#123;<br>                System.out.println(<span class="hljs-string">&quot;a = &quot;</span> + a + <span class="hljs-string">&quot;, b = &quot;</span> + b);<br>                <span class="hljs-keyword">return</span> a + b;<br>            &#125;);<br>    System.out.println(reduce);<br>&#125;<br><span class="hljs-comment">// reduce:</span><br><span class="hljs-comment">// ç¬¬ä¸€æ¬¡å°†é»˜è®¤åšèµ‹å€¼ç»™x, å–å‡ºç¬¬ä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™y,è¿›è¡Œæ“ä½œ</span><br><span class="hljs-comment">// ç¬¬äºŒæ¬¡,å°†ç¬¬ä¸€æ¬¡çš„ç»“æœèµ‹å€¼ç»™x, å–å‡ºäºŒä¸ªå…ƒç´ èµ‹å€¼ç»™y,è¿›è¡Œæ“ä½œ</span><br><span class="hljs-comment">// ç¬¬ä¸‰æ¬¡,å°†ç¬¬äºŒæ¬¡çš„ç»“æœèµ‹å€¼ç»™x, å–å‡ºä¸‰ä¸ªå…ƒç´ èµ‹å€¼ç»™y,è¿›è¡Œæ“ä½œ</span><br><span class="hljs-comment">// ç¬¬å››æ¬¡,å°†ç¬¬ä¸‰æ¬¡çš„ç»“æœèµ‹å€¼ç»™x, å–å‡ºå››ä¸ªå…ƒç´ èµ‹å€¼ç»™y,è¿›è¡Œæ“ä½œ</span><br><span class="hljs-type">int</span> <span class="hljs-variable">reduce2</span> <span class="hljs-operator">=</span> Stream.of(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>)<br>.reduce(<span class="hljs-number">0</span>, (x, y) -&gt; &#123;<br><span class="hljs-keyword">return</span> Integer.sum(x, y);<br>&#125;);<br><span class="hljs-type">int</span> <span class="hljs-variable">reduce3</span> <span class="hljs-operator">=</span> Stream.of(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>).reduce(<span class="hljs-number">0</span>, Integer::sum);<br><span class="hljs-type">int</span> <span class="hljs-variable">max</span> <span class="hljs-operator">=</span> Stream.of(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">3</span>, <span class="hljs-number">9</span>)<br>.reduce(<span class="hljs-number">0</span>, (x, y) -&gt; &#123;<br><span class="hljs-keyword">return</span> x &gt; y ? x : y;<br>&#125;);<br>System.out.println(<span class="hljs-string">&quot;max = &quot;</span> + max);<br></code></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><img src="/2022/03/04/Java%E5%9F%BA%E7%A1%80/Stream/image-20220304160309736.png" class><p>ç”±æ­¤å¯è§æ±‚å‡ºäº†æ€»å’Œ</p><h4 id="mapå’Œreduceç»„åˆä½¿ç”¨"><a href="#mapå’Œreduceç»„åˆä½¿ç”¨" class="headerlink" title="mapå’Œreduceç»„åˆä½¿ç”¨"></a>mapå’Œreduceç»„åˆä½¿ç”¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testMapReduce</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-comment">// æ±‚å‡ºæ‰€æœ‰å¹´é¾„çš„æ€»å’Œ</span><br><span class="hljs-type">int</span> <span class="hljs-variable">totalAge</span> <span class="hljs-operator">=</span> Stream.of(<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;åˆ˜å¾·å&quot;</span>, <span class="hljs-number">58</span>),<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;å¼ å­¦å‹&quot;</span>, <span class="hljs-number">56</span>),<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;éƒ­å¯ŒåŸ&quot;</span>, <span class="hljs-number">54</span>),<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;é»æ˜&quot;</span>, <span class="hljs-number">52</span>))<br>.map((p) -&gt; p.getAge())<br>.reduce(<span class="hljs-number">0</span>, (x, y) -&gt; x + y);<br>System.out.println(<span class="hljs-string">&quot;totalAge = &quot;</span> + totalAge);<br><span class="hljs-comment">// æ‰¾å‡ºæœ€å¤§å¹´é¾„</span><br><span class="hljs-type">int</span> <span class="hljs-variable">maxAge</span> <span class="hljs-operator">=</span> Stream.of(<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;åˆ˜å¾·å&quot;</span>, <span class="hljs-number">58</span>),<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;å¼ å­¦å‹&quot;</span>, <span class="hljs-number">56</span>),<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;éƒ­å¯ŒåŸ&quot;</span>, <span class="hljs-number">54</span>),<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;é»æ˜&quot;</span>, <span class="hljs-number">52</span>))<br>.map((p) -&gt; p.getAge())<br>.reduce(<span class="hljs-number">0</span>, (x, y) -&gt; x &gt; y ? x : y);<br>System.out.println(<span class="hljs-string">&quot;maxAge = &quot;</span> + maxAge);<br><span class="hljs-comment">// ç»Ÿè®¡ æ•°å­—2 å‡ºç°çš„æ¬¡æ•°</span><br><span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> Stream.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>)<br>.map(i -&gt; &#123;<br><span class="hljs-keyword">if</span> (i == <span class="hljs-number">2</span>) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>&#125;)<br>.reduce(<span class="hljs-number">0</span>, Integer::sum);<br>System.out.println(<span class="hljs-string">&quot;count = &quot;</span> + count);<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h4><p>å¦‚æœæœ‰ä¸¤ä¸ªæµï¼Œå¸Œæœ›åˆå¹¶æˆä¸ºä¸€ä¸ªæµï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ Stream æ¥å£çš„é™æ€æ–¹æ³• concat ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testContact</span><span class="hljs-params">()</span> &#123;<br>Stream&lt;String&gt; streamA = Stream.of(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>);<br>Stream&lt;String&gt; streamB = Stream.of(<span class="hljs-string">&quot;æå››&quot;</span>);<br>Stream&lt;String&gt; result = Stream.concat(streamA, streamB);<br>result.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Streamæµä¸­çš„ç»“æœåˆ°é›†åˆä¸­"><a href="#Streamæµä¸­çš„ç»“æœåˆ°é›†åˆä¸­" class="headerlink" title="Streamæµä¸­çš„ç»“æœåˆ°é›†åˆä¸­"></a>Streamæµä¸­çš„ç»“æœåˆ°é›†åˆä¸­</h3><p>Streamæµæä¾› collect æ–¹æ³•ï¼Œå…¶å‚æ•°éœ€è¦ä¸€ä¸ª java.util.stream.Collector æ¥å£å¯¹è±¡æ¥æŒ‡å®šæ”¶é›†åˆ°å“ª ç§é›†åˆä¸­ã€‚java.util.stream.Collectors ç±»æä¾›ä¸€äº›æ–¹æ³•ï¼Œå¯ä»¥ä½œä¸º Collector&#96;æ¥å£çš„å®ä¾‹ï¼š</p><p>public static  Collector&gt; toList() ï¼šè½¬æ¢ä¸º List é›†åˆã€‚</p><p>public static  Collector&gt; toSet() ï¼šè½¬æ¢ä¸º Set é›†åˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å°†æµä¸­æ•°æ®æ”¶é›†åˆ°é›†åˆä¸­</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStreamToCollection</span><span class="hljs-params">()</span> &#123;<br>Stream&lt;String&gt; stream = Stream.of(<span class="hljs-string">&quot;aa&quot;</span>, <span class="hljs-string">&quot;bb&quot;</span>, <span class="hljs-string">&quot;cc&quot;</span>);<br><span class="hljs-comment">// List&lt;String&gt; list = stream.collect(Collectors.toList());</span><br><span class="hljs-comment">// Set&lt;String&gt; set = stream.collect(Collectors.toSet());</span><br>ArrayList&lt;String&gt; arrayList = stream.collect(Collectors.toCollection(ArrayList::<span class="hljs-keyword">new</span>));<br>HashSet&lt;String&gt; hashSet = stream.collect(Collectors.toCollection(HashSet::<span class="hljs-keyword">new</span>));<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Streamæµä¸­çš„ç»“æœåˆ°æ•°ç»„ä¸­"><a href="#Streamæµä¸­çš„ç»“æœåˆ°æ•°ç»„ä¸­" class="headerlink" title="Streamæµä¸­çš„ç»“æœåˆ°æ•°ç»„ä¸­"></a>Streamæµä¸­çš„ç»“æœåˆ°æ•°ç»„ä¸­</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStreamToArray</span><span class="hljs-params">()</span> &#123;<br>Stream&lt;String&gt; stream = Stream.of(<span class="hljs-string">&quot;aa&quot;</span>, <span class="hljs-string">&quot;bb&quot;</span>, <span class="hljs-string">&quot;cc&quot;</span>);<br><span class="hljs-comment">// Object[] objects = stream.toArray();</span><br><span class="hljs-comment">// for (Object obj : objects) &#123;</span><br><span class="hljs-comment">// System.out.println();</span><br><span class="hljs-comment">// &#125;</span><br>String[] strings = stream.toArray(String[]::<span class="hljs-keyword">new</span>);<br><span class="hljs-keyword">for</span> (String str : strings) &#123;<br>System.out.println(str);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¯¹æµä¸­æ•°æ®è¿›è¡Œèšåˆè®¡ç®—"><a href="#å¯¹æµä¸­æ•°æ®è¿›è¡Œèšåˆè®¡ç®—" class="headerlink" title="å¯¹æµä¸­æ•°æ®è¿›è¡Œèšåˆè®¡ç®—"></a>å¯¹æµä¸­æ•°æ®è¿›è¡Œèšåˆè®¡ç®—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testStreamToOther</span><span class="hljs-params">()</span> &#123;<br>Stream&lt;Student&gt; studentStream = Stream.of(<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;èµµä¸½é¢–&quot;</span>, <span class="hljs-number">58</span>, <span class="hljs-number">95</span>),<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;æ¨é¢–&quot;</span>, <span class="hljs-number">56</span>, <span class="hljs-number">88</span>),<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;è¿ªä¸½çƒ­å·´&quot;</span>, <span class="hljs-number">56</span>, <span class="hljs-number">99</span>),<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Student</span>(<span class="hljs-string">&quot;æŸ³å²©&quot;</span>, <span class="hljs-number">52</span>, <span class="hljs-number">77</span>));<br><span class="hljs-comment">// è·å–æœ€å¤§å€¼</span><br><span class="hljs-comment">// Optional&lt;Student&gt; collect = studentStream.collect(Collectors.maxBy((o1, o2) -&gt;</span><br>o1.getSocre() - o2.getSocre()));<br><span class="hljs-comment">// è·å–æœ€å°å€¼</span><br><span class="hljs-comment">// Optional&lt;Student&gt; collect = studentStream.collect(Collectors.minBy((o1, o2) -&gt;</span><br>o1.getSocre() - o2.getSocre()));<br><span class="hljs-comment">// System.out.println(collect.get());</span><br><span class="hljs-comment">// æ±‚æ€»å’Œ</span><br><span class="hljs-comment">// int sumAge = studentStream.collect(Collectors.summingInt(s -&gt; s.getAge()));</span><br><span class="hljs-comment">// System.out.println(&quot;sumAge = &quot; + sumAge);</span><br><span class="hljs-comment">// å¹³å‡å€¼</span><br><span class="hljs-comment">// double avgScore = studentStream.collect(Collectors.averagingInt(s -&gt; s.getSocre()));</span><br><span class="hljs-comment">// System.out.println(&quot;avgScore = &quot; + avgScore);</span><br><span class="hljs-comment">// ç»Ÿè®¡æ•°é‡</span><br><span class="hljs-comment">// Long count = studentStream.collect(Collectors.counting());</span><br><span class="hljs-comment">// System.out.println(&quot;count = &quot; + count);</span><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaåŸºç¡€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IDEAå¿«æ·é”®</title>
    <link href="/2022/03/04/utils/IDEA%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
    <url>/2022/03/04/utils/IDEA%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
    
    <content type="html"><![CDATA[<p>Ctrl + D å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œ æˆ– å¤åˆ¶é€‰æ‹©å†…å®¹ï¼Œå¹¶æŠŠå¤åˆ¶å†…å®¹æ’å…¥å…‰æ ‡ä½ç½®ä¸‹é¢ ï¼ˆå¿…å¤‡<br>Ctrl + P æ–¹æ³•å‚æ•°æç¤ºæ˜¾ç¤º ï¼ˆå¿…å¤‡<br>Ctrl + J æ’å…¥è‡ªå®šä¹‰åŠ¨æ€ä»£ç æ¨¡æ¿ ï¼ˆå¿…å¤‡<br>Ctrl + P æ–¹æ³•å‚æ•°æç¤ºæ˜¾ç¤º ï¼ˆå¿…å¤‡<br>Ctrl + O é€‰æ‹©å¯é‡å†™çš„æ–¹æ³•<br>Ctrl + I é€‰æ‹©å¯ç»§æ‰¿çš„æ–¹æ³•<br>Ctrl + Delete åˆ é™¤å…‰æ ‡åé¢çš„å•è¯æˆ–æ˜¯ä¸­æ–‡å¥ ï¼ˆå¿…å¤‡ï¼‰<br>Ctrl +BackSpace åˆ é™¤å…‰æ ‡å‰é¢çš„å•è¯æˆ–æ˜¯ä¸­æ–‡å¥ ï¼ˆå¿…å¤‡<br>Ctrl + å·¦æ–¹å‘é”® å…‰æ ‡è·³è½¬åˆ°å½“å‰å•è¯ &#x2F; ä¸­æ–‡å¥çš„å·¦ä¾§å¼€å¤´ä½ç½® ï¼ˆå¿…å¤‡ï¼‰<br>Ctrl + å³æ–¹å‘é”® å…‰æ ‡è·³è½¬åˆ°å½“å‰å•è¯ &#x2F; ä¸­æ–‡å¥çš„å³ä¾§å¼€å¤´ä½ç½® ï¼ˆå¿…å¤‡ï¼‰<br>Ctrl + å‰æ–¹å‘é”® ç­‰æ•ˆäºé¼ æ ‡æ»šè½®å‘å‰æ•ˆæœ ï¼ˆå¿…å¤‡ï¼‰<br>Ctrl + åæ–¹å‘é”® ç­‰æ•ˆäºé¼ æ ‡æ»šè½®å‘åæ•ˆæœ ï¼ˆå¿…å¤‡ï¼‰</p><p>Alt + Insert ä»£ç è‡ªåŠ¨ç”Ÿæˆï¼Œå¦‚ç”Ÿæˆå¯¹è±¡çš„ set &#x2F; get æ–¹æ³•ï¼Œæ„é€ å‡½æ•°ï¼ŒtoString() ç­‰ ï¼ˆå¿…å¤‡ï¼‰ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼<br>Ctrl + Alt + V å¿«é€Ÿå¼•è¿›å˜é‡<br>Ctrl + Alt + L æ ¼å¼åŒ–ä»£ç ï¼Œå¯ä»¥å¯¹å½“å‰æ–‡ä»¶å’Œæ•´ä¸ªåŒ…ç›®å½•ä½¿ç”¨ ï¼ˆå¿…å¤‡<br>Ctrl + Shift + &#x2F; ä»£ç å—æ³¨é‡Š ï¼ˆå¿…å¤‡<br>Alt + Enter å¯¼å…¥æ–¹æ³•<br>Ctrl + Alt +Tç¯ç»•å¯¹è±¡ å¯é€‰æ‹© try if whileç­‰<br>Alt + 7 é¡¹ç›®ç»“æ„å›¾</p>]]></content>
    
    
    <categories>
      
      <category>utils</category>
      
    </categories>
    
    
    <tags>
      
      <tag>utils</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>java:é”™è¯¯:ä¸æ”¯æŒå‘è¡Œç‰ˆ5</title>
    <link href="/2022/03/04/error/java-%E9%94%99%E8%AF%AF-%E4%B8%8D%E6%94%AF%E6%8C%81%E5%8F%91%E8%A1%8C%E7%89%885/"/>
    <url>/2022/03/04/error/java-%E9%94%99%E8%AF%AF-%E4%B8%8D%E6%94%AF%E6%8C%81%E5%8F%91%E8%A1%8C%E7%89%885/</url>
    
    <content type="html"><![CDATA[<h1 id="java-é”™è¯¯-ä¸æ”¯æŒå‘è¡Œç‰ˆæœ¬-5"><a href="#java-é”™è¯¯-ä¸æ”¯æŒå‘è¡Œç‰ˆæœ¬-5" class="headerlink" title="java: é”™è¯¯: ä¸æ”¯æŒå‘è¡Œç‰ˆæœ¬ 5"></a>java: é”™è¯¯: ä¸æ”¯æŒå‘è¡Œç‰ˆæœ¬ 5</h1><p>åœ¨Intellij ideaä¸­æ–°å»ºäº†ä¸€ä¸ªMavené¡¹ç›®ï¼Œè¿è¡Œæ—¶æŠ¥é”™å¦‚ä¸‹ï¼šError : java ä¸æ”¯æŒå‘è¡Œç‰ˆæœ¬5</p><img src="/2022/03/04/error/java-%E9%94%99%E8%AF%AF-%E4%B8%8D%E6%94%AF%E6%8C%81%E5%8F%91%E8%A1%8C%E7%89%885/image-20220304104221601.png" class><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><ol><li>æ–‡ä»¶-&gt;é¡¹ç›®ç»“æ„</li></ol><img src="/2022/03/04/error/java-%E9%94%99%E8%AF%AF-%E4%B8%8D%E6%94%AF%E6%8C%81%E5%8F%91%E8%A1%8C%E7%89%885/image-20220304104433592.png" class><p>æŸ¥çœ‹ä¸¤ä¸ªJDKç‰ˆæœ¬æ˜¯å¦ä¸€è‡´</p><ol start="2"><li>è®¾ç½®-&gt;æ„å»ºã€æ‰§è¡Œã€éƒ¨ç½²-&gt;Javaç¼–è¯‘å™¨</li></ol><img src="/2022/03/04/error/java-%E9%94%99%E8%AF%AF-%E4%B8%8D%E6%94%AF%E6%8C%81%E5%8F%91%E8%A1%8C%E7%89%885/image-20220304105352604.png" class><p>ä¿®æ”¹è¿™é‡Œçš„ç›®æ ‡å­—èŠ‚ç ä¸ºå½“å‰JDKç‰ˆæœ¬</p><p>åœ¨pom.xmlæ·»åŠ ä»¥ä¸‹å†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæ‰€æœ‰è®¾ç½®å·²ç»å®Œæˆ</p>]]></content>
    
    
    <categories>
      
      <category>Error</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Error</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºè¿·èŒ«çš„æœªæ¥çš„ä¸€ç‚¹æ€è€ƒï¼ˆä¸€ï¼‰</title>
    <link href="/2022/02/28/%E9%97%B2%E8%B0%88/%E5%85%B3%E4%BA%8E%E8%BF%B7%E8%8C%AB%E7%9A%84%E6%9C%AA%E6%9D%A5%E7%9A%84%E4%B8%80%E7%82%B9%E6%80%9D%E8%80%83%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2022/02/28/%E9%97%B2%E8%B0%88/%E5%85%B3%E4%BA%8E%E8%BF%B7%E8%8C%AB%E7%9A%84%E6%9C%AA%E6%9D%A5%E7%9A%84%E4%B8%80%E7%82%B9%E6%80%9D%E8%80%83%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="å…³äºè¿·èŒ«çš„æœªæ¥çš„ä¸€ç‚¹æ€è€ƒï¼ˆä¸€ï¼‰"><a href="#å…³äºè¿·èŒ«çš„æœªæ¥çš„ä¸€ç‚¹æ€è€ƒï¼ˆä¸€ï¼‰" class="headerlink" title="å…³äºè¿·èŒ«çš„æœªæ¥çš„ä¸€ç‚¹æ€è€ƒï¼ˆä¸€ï¼‰"></a>å…³äºè¿·èŒ«çš„æœªæ¥çš„ä¸€ç‚¹æ€è€ƒï¼ˆä¸€ï¼‰</h1><p>ä»Šå¤©æ˜¯2022å¹´2æœˆ28æ—¥ï¼Œè¿‡äº†ä»Šå¤©å°±æ˜¯ä¸‰æœˆä»½äº†ï¼Œä»Šå¤©æˆ‘è€ƒå®Œäº†è®¡ç®—æœºç½‘ç»œï¼Œæ˜å¤©è¿˜æœ‰ä¸€é—¨è€ƒè¯•ï¼Œåå¤©è¿˜æœ‰ä¸¤é—¨ï¼Œæœ€è¿‘ä¸€ç›´åœ¨è€ƒè¯•ï¼Œä»Šå¤©æœ¬æ¥å†™æˆ‘å¯¹JVMåƒåœ¾å›æ”¶çš„æ€è€ƒï¼Œä½†å› ä¸ºå†…å®¹å¾ˆå¤šï¼Œæˆ‘åªå†™äº†ä¸€éƒ¨åˆ†ï¼Œä¼°è®¡ä¸‰å¤©ä»¥åæ‰èƒ½å‡ºæ¥â€¦è¿˜è¯·å¤§å®¶è€å¿ƒç­‰å¾…ï¼ˆå¯èƒ½å¹¶ä¸ä¼šæœ‰å‡ ä¸ªäººçœ‹ï¼‰ã€‚</p><p>æˆ‘æœ€è¿‘å¾ˆçƒ¦ï¼Œå¤§å®¶å¥½åƒç°åœ¨éƒ½æœ‰è‡ªå·±æƒ³åšçš„äº‹æƒ…ï¼Œè¦ä¹ˆè€ƒç ”ï¼Œè¦ä¹ˆæ‰¾å·¥ä½œï¼Œè€Œæˆ‘é€‰æ‹©äº†åè€…ï¼Œå¯¹æ­¤æˆ‘æ²¡æœ‰ä»€ä¹ˆå¥½åæ‚”çš„ï¼Œå› ä¸ºè¿™æ˜¯æˆ‘è‡ªå·±çš„é€‰æ‹©ã€‚</p><p>ä»Šå¤©è€ƒå®Œè®¡ç½‘ä»¥åæˆ‘æ¯”è¾ƒè½»æ¾ï¼Œæ‰“å¼€Bç«™å°±å‘ç°æˆ‘å…³æ³¨çš„ä¸€ä½ç¨‹åºå‘˜UPå‘å¸ƒäº†ä¸€æ¡åŠ¨æ€ï¼Œæ˜¯å…³äºæ”¯ä»˜å®2023å®ä¹ å¯åŠ¨çš„ï¼Œæˆ‘æ²¡æƒ³åˆ°ä¼šè¿™ä¹ˆå¿«ï¼Œå¤§å‚çš„å®ä¹ ç”Ÿæ‹›è˜ä¼šè¿™ä¹ˆå¿«ã€‚ç°åœ¨å­—èŠ‚è·³åŠ¨ã€é˜¿é‡Œå·´å·´ç­‰å¤§å‚çš„å®ä¹ ç”Ÿæ‹›è˜éƒ½å·²ç»å¼€å§‹äº†ï¼Œè€Œåˆ°ç°åœ¨è¿˜æ²¡æœ‰å‡†å¤‡å¥½ã€‚</p><p>æœ€è¿‘å››å…­çº§æˆç»©å‡ºæ¥äº†ï¼Œæˆ‘åˆæ²¡æœ‰è¿‡ï¼Œè€Œè¿›å¤§å‚å››å…­çº§ä¼¼ä¹æ˜¯å¿…è¦çš„ä¸€ç¯ï¼Œæˆ‘é¢è¯•çš„ä¸€ä¸ªå°å…¬å¸HRä¹Ÿå«æˆ‘å»å®ä¹ ï¼Œä½†æˆ‘å› ä¸ºè€ƒè¯•ä¸å¾—ä¸æ¨è¿Ÿä¸¤å¤©å†å»ï¼Œæˆ‘ä¸çŸ¥é“æˆ‘ç°åœ¨æ˜¯åº”è¯¥å»å°å‚å®ä¹ è¿˜æ˜¯ç»§ç»­åˆ·é¢˜ã€åˆ·é¢ç»æ¥å‡†å¤‡å¤§å‚çš„æš‘æœŸé¢è¯•ã€‚æˆ‘å¥½çƒ¦ï¼Œæˆ‘ä¸çŸ¥é“æˆ‘ä¸Šå¤§å­¦æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Œæˆ‘å¯¹äºæœªæ¥å……æ»¡äº†è¿·èŒ«ï¼Œæˆ‘å–œæ¬¢å†™ä»£ç ï¼Œä½†æ˜¯ä»£ç æ˜¯å¦èƒ½èƒ½å¸¦ç»™æˆ‘ä¸€ä¸ªå…‰æ˜çš„æœªæ¥å‘¢ï¼Ÿæˆ‘è‡ªå¹¼å°±å¿å—äº†è´«è´±ï¼Œæ‰€ä»¥æˆ‘ä¸èƒ½è®©æˆ‘çš„å®¶äººæˆ–è€…æˆ‘å–œæ¬¢çš„äººåœ¨æœªæ¥ä¹Ÿå¿å—è´«è´±ã€‚</p><p>æˆ‘å¾ˆçƒ¦ï¼Œæ˜¯å¯¹æœªæ¥çš„ç„¦è™‘ã€‚ã€‚ã€‚</p><p>åº”è¯¥æ€ä¹ˆæ‰“ç ´è¿™ç§ç„¦è™‘å‘¢ï¼Ÿæˆ‘åœ¨ä¸€æ­¥ä¸€æ­¥èµ°ï¼</p>]]></content>
    
    
    <categories>
      
      <category>é—²è°ˆ</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>JVMåƒåœ¾å›æ”¶</title>
    <link href="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/"/>
    <url>/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="JVNåƒåœ¾å›æ”¶"><a href="#JVNåƒåœ¾å›æ”¶" class="headerlink" title="JVNåƒåœ¾å›æ”¶"></a>JVNåƒåœ¾å›æ”¶</h1><p>JVMä¸»è¦åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†å†…å®¹ï¼šå†…å­˜æ¨¡å‹ï¼Œåƒåœ¾å›æ”¶å’Œç±»åŠ è½½</p><p>ä»Šå¤©è®²è§£çš„åƒåœ¾å›æ”¶ä¸»è¦åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ï¼šåƒåœ¾å›æ”¶ç®—æ³•å’Œåƒåœ¾å›æ”¶å™¨ã€‚å…¶ä¸­ä¹ŸåŒ…æ‹¬ä¸€äº›åƒåœ¾å›æ”¶åŸºç¡€çŸ¥è¯†ï¼Œæ¯”å¦‚minor gc å’Œ full gcçš„åŒºåˆ«ç­‰ç­‰</p><h2 id="åˆ¤æ–­åƒåœ¾æ˜¯å¦å¯ä»¥å›æ”¶"><a href="#åˆ¤æ–­åƒåœ¾æ˜¯å¦å¯ä»¥å›æ”¶" class="headerlink" title="åˆ¤æ–­åƒåœ¾æ˜¯å¦å¯ä»¥å›æ”¶"></a>åˆ¤æ–­åƒåœ¾æ˜¯å¦å¯ä»¥å›æ”¶</h2><p>ç°åœ¨å¸‚é¢ä¸Šçš„åƒåœ¾åˆ¤æ–­ç®—æ³•ä¸»è¦æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯å¼•ç”¨è®¡æ•°æ³•ï¼Œè¿™æ˜¯pythonæ­£åœ¨ç”¨çš„ã€‚ä¸€ç§æ˜¯å¯è¾¾æ€§åˆ†ææ³•ï¼Œè¿™æ˜¯Javaæ­£åœ¨ç”¨çš„ï¼Œä¸‹é¢æˆ‘ä»¬è¿›è¡Œè¯¦ç»†è®²è§£ã€‚</p><h3 id="å¼•ç”¨è®¡æ•°æ³•"><a href="#å¼•ç”¨è®¡æ•°æ³•" class="headerlink" title="å¼•ç”¨è®¡æ•°æ³•"></a>å¼•ç”¨è®¡æ•°æ³•</h3><p>å½“æœ‰ä¸€ä¸ªå¯¹è±¡è¢«å¼•ç”¨æ—¶å®ƒçš„è®¡æ•°å™¨å°±+1ï¼Œä½†æ˜¯è¿™æ ·å¯èƒ½ä¼šé€ æˆä¸€ä¸ªå¼Šç«¯ï¼Œé‚£å°±æ˜¯å½“ä¸¤ä¸ªå¯¹è±¡ç›¸äº’å¼•ç”¨çš„æ—¶å€™ï¼Œå®ƒä»¬éƒ½ä¸èƒ½è¢«é‡Šæ”¾ã€‚</p><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220228231717227.png" class><h3 id="å¯è¾¾æ€§åˆ†ææ³•"><a href="#å¯è¾¾æ€§åˆ†ææ³•" class="headerlink" title="å¯è¾¾æ€§åˆ†ææ³•"></a>å¯è¾¾æ€§åˆ†ææ³•</h3><p>è¿™æ˜¯Javaæ­£åœ¨ä½¿ç”¨çš„ç®—æ³•</p><ul><li>æ‰«æå †ä¸­çš„å¯¹è±¡ï¼Œçœ‹èƒ½å¦æ²¿ç€GC Rootå¯¹è±¡ä¸ºèµ·ç‚¹çš„å¼•ç”¨é“¾æ‰¾åˆ°è¯¥å¯¹è±¡ï¼Œå¦‚æœ<strong>æ‰¾ä¸åˆ°ï¼Œåˆ™è¡¨ç¤ºå¯ä»¥å›æ”¶</strong></li></ul><h2 id="GC-Rootéƒ½æœ‰å“ªäº›"><a href="#GC-Rootéƒ½æœ‰å“ªäº›" class="headerlink" title="GC Rootéƒ½æœ‰å“ªäº›"></a>GC Rootéƒ½æœ‰å“ªäº›</h2><p>å¯ä»¥ä½œä¸ºGC Rootçš„å¯¹è±¡</p><ul><li>è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ã€‚</li></ul><p>ã€€</p><p>å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œa æ˜¯æ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡ï¼Œå½“ a &#x3D; null æ—¶ï¼Œç”±äºæ­¤æ—¶ a å……å½“äº† <strong>GC Root</strong> çš„ä½œç”¨ï¼Œa ä¸åŸæ¥æŒ‡å‘çš„å®ä¾‹ <strong>new Test()</strong> æ–­å¼€äº†è¿æ¥ï¼Œæ‰€ä»¥å¯¹è±¡ä¼šè¢«å›æ”¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><pre><code class="hljs java">publicclass Test &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-type">Test</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br>a = <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡</li></ul><p>å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œå½“æ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡ a &#x3D; null æ—¶ï¼Œç”±äº a åŸæ¥æŒ‡å‘çš„å¯¹è±¡ä¸ GC Root (å˜é‡ a) æ–­å¼€äº†è¿æ¥ï¼Œæ‰€ä»¥ a åŸæ¥æŒ‡å‘çš„å¯¹è±¡ä¼šè¢«å›æ”¶ï¼Œè€Œç”±äºæˆ‘ä»¬ç»™ s èµ‹å€¼äº†å˜é‡çš„å¼•ç”¨ï¼Œ<strong>s åœ¨æ­¤æ—¶æ˜¯ç±»é™æ€å±æ€§å¼•ç”¨</strong>ï¼Œå……å½“äº† GC Root çš„ä½œç”¨ï¼Œå®ƒæŒ‡å‘çš„å¯¹è±¡ä¾ç„¶å­˜æ´»!</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Test s;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-type">Test</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br>a.s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br>a = <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡</li></ul><p>å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œå¸¸é‡ s æŒ‡å‘çš„å¯¹è±¡å¹¶ä¸ä¼šå› ä¸º a æŒ‡å‘çš„å¯¹è±¡è¢«å›æ”¶è€Œå›æ”¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Test</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-type">Test</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br>    a = <span class="hljs-literal">null</span>;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆå³ä¸€èˆ¬è¯´çš„Nativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡</li></ul><p>è¿™æ˜¯ç®€å•ç»™ä¸æ¸…æ¥šæœ¬åœ°æ–¹æ³•ä¸ºä½•ç‰©çš„ç«¥é‹ç®€å•è§£é‡Šä¸€ä¸‹ï¼šæ‰€è°“æœ¬åœ°æ–¹æ³•å°±æ˜¯ä¸€ä¸ª java è°ƒç”¨é java ä»£ç çš„æ¥å£ï¼Œè¯¥æ–¹æ³•å¹¶é Java å®ç°çš„ï¼Œå¯èƒ½ç”± C æˆ– Pythonç­‰å…¶ä»–è¯­è¨€å®ç°çš„ï¼Œ Java é€šè¿‡ JNI æ¥è°ƒç”¨æœ¬åœ°æ–¹æ³•ï¼Œ è€Œæœ¬åœ°æ–¹æ³•æ˜¯ä»¥åº“æ–‡ä»¶çš„å½¢å¼å­˜æ”¾çš„ï¼ˆåœ¨ WINDOWS å¹³å°ä¸Šæ˜¯ DLL æ–‡ä»¶å½¢å¼ï¼Œåœ¨ UNIX æœºå™¨ä¸Šæ˜¯ SO æ–‡ä»¶å½¢å¼ï¼‰ã€‚</p><p>å½“è°ƒç”¨ Java æ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºä¼šåˆ›å»ºä¸€ä¸ªæ ˆæ¡¢å¹¶å‹å…¥ Java æ ˆï¼Œè€Œå½“å®ƒè°ƒç”¨çš„æ˜¯æœ¬åœ°æ–¹æ³•æ—¶ï¼Œè™šæ‹Ÿæœºä¼šä¿æŒ Java æ ˆä¸å˜ï¼Œä¸ä¼šåœ¨ Java æ ˆç¥¯ä¸­å‹å…¥æ–°çš„ç¥¯ï¼Œè™šæ‹Ÿæœºåªæ˜¯ç®€å•åœ°åŠ¨æ€è¿æ¥å¹¶ç›´æ¥è°ƒç”¨æŒ‡å®šçš„æœ¬åœ°æ–¹æ³•ã€‚</p><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305164427347.png" class><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">NIEXPORT <span class="hljs-keyword">void</span> JNICALL <span class="hljs-title function_">Java_com_pecuyu_jnirefdemo_MainActivity_newStringNative</span><span class="hljs-params">(JNIEnv *env, jobject instanceï¼Œjstring jmsg)</span> &#123;<br>...<br>   <span class="hljs-comment">// ç¼“å­˜Stringçš„class</span><br>   <span class="hljs-type">jclass</span> <span class="hljs-variable">jc</span> <span class="hljs-operator">=</span> (*env)-&gt;FindClass(env, STRING_PATH);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œå½“ java è°ƒç”¨ä»¥ä¸Šæœ¬åœ°æ–¹æ³•æ—¶ï¼Œjc ä¼šè¢«æœ¬åœ°æ–¹æ³•æ ˆå‹å…¥æ ˆä¸­, jc å°±æ˜¯æˆ‘ä»¬è¯´çš„æœ¬åœ°æ–¹æ³•æ ˆä¸­ JNI çš„å¯¹è±¡å¼•ç”¨ï¼Œå› æ­¤åªä¼šåœ¨æ­¤æœ¬åœ°æ–¹æ³•æ‰§è¡Œå®Œæˆåæ‰ä¼šè¢«é‡Šæ”¾ã€‚</p><h2 id="äº”ç§å¼•ç”¨ç±»å‹"><a href="#äº”ç§å¼•ç”¨ç±»å‹" class="headerlink" title="äº”ç§å¼•ç”¨ç±»å‹"></a>äº”ç§å¼•ç”¨ç±»å‹</h2><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220228231943521.png" class><h3 id="å¼ºå¼•ç”¨"><a href="#å¼ºå¼•ç”¨" class="headerlink" title="å¼ºå¼•ç”¨"></a>å¼ºå¼•ç”¨</h3><p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬newçš„å¯¹è±¡éƒ½å±äºå¼ºå¼•ç”¨</p><p>åªæœ‰GC Root<strong>éƒ½ä¸å¼•ç”¨</strong>è¯¥å¯¹è±¡æ—¶ï¼Œæ‰ä¼šå›æ”¶<strong>å¼ºå¼•ç”¨</strong>å¯¹è±¡</p><ul><li>å¦‚ä¸Šå›¾Bã€Cå¯¹è±¡éƒ½ä¸å¼•ç”¨A1å¯¹è±¡æ—¶ï¼ŒA1å¯¹è±¡æ‰ä¼šè¢«å›æ”¶</li></ul><h3 id="è½¯å¼•ç”¨"><a href="#è½¯å¼•ç”¨" class="headerlink" title="è½¯å¼•ç”¨"></a>è½¯å¼•ç”¨</h3><p>å½“GC RootæŒ‡å‘è½¯å¼•ç”¨å¯¹è±¡æ—¶ï¼Œåœ¨<strong>å†…å­˜ä¸è¶³æ—¶</strong>ï¼Œä¼š<strong>å›æ”¶è½¯å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡</strong></p><ul><li>å¦‚ä¸Šå›¾å¦‚æœBå¯¹è±¡ä¸å†å¼•ç”¨A2å¯¹è±¡ä¸”å†…å­˜ä¸è¶³æ—¶ï¼Œè½¯å¼•ç”¨æ‰€å¼•ç”¨çš„A2å¯¹è±¡å°±ä¼šè¢«å›æ”¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo1</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">_4M</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span>*<span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>;<br><span class="hljs-comment">//ä½¿ç”¨è½¯å¼•ç”¨å¯¹è±¡ listå’ŒSoftReferenceæ˜¯å¼ºå¼•ç”¨ï¼Œè€ŒSoftReferenceå’Œbyteæ•°ç»„åˆ™æ˜¯è½¯å¼•ç”¨</span><br>List&lt;SoftReference&lt;<span class="hljs-type">byte</span>[]&gt;&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>SoftReference&lt;<span class="hljs-type">byte</span>[]&gt; ref= <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoftReference</span>&lt;&gt;(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[_4M]);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœåœ¨åƒåœ¾å›æ”¶æ—¶å‘ç°å†…å­˜ä¸è¶³ï¼Œåœ¨å›æ”¶è½¯å¼•ç”¨æ‰€æŒ‡å‘çš„å¯¹è±¡æ—¶ï¼Œ<strong>è½¯å¼•ç”¨æœ¬èº«ä¸ä¼šè¢«æ¸…ç†</strong></p><p>å¦‚æœæƒ³è¦<strong>æ¸…ç†è½¯å¼•ç”¨</strong>ï¼Œéœ€è¦ä½¿<strong>ç”¨å¼•ç”¨é˜Ÿåˆ—</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo1</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">_4M</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span>*<span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>;<br><span class="hljs-comment">//ä½¿ç”¨å¼•ç”¨é˜Ÿåˆ—ï¼Œç”¨äºç§»é™¤å¼•ç”¨ä¸ºç©ºçš„è½¯å¼•ç”¨å¯¹è±¡</span><br>ReferenceQueue&lt;<span class="hljs-type">byte</span>[]&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReferenceQueue</span>&lt;&gt;();<br><span class="hljs-comment">//ä½¿ç”¨è½¯å¼•ç”¨å¯¹è±¡ listå’ŒSoftReferenceæ˜¯å¼ºå¼•ç”¨ï¼Œè€ŒSoftReferenceå’Œbyteæ•°ç»„åˆ™æ˜¯è½¯å¼•ç”¨</span><br>List&lt;SoftReference&lt;<span class="hljs-type">byte</span>[]&gt;&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>SoftReference&lt;<span class="hljs-type">byte</span>[]&gt; ref= <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoftReference</span>&lt;&gt;(<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[_4M]);<br><br><span class="hljs-comment">//éå†å¼•ç”¨é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰å…ƒç´ ï¼Œåˆ™ç§»é™¤</span><br>Reference&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">byte</span>[]&gt; poll = queue.poll();<br><span class="hljs-keyword">while</span>(poll != <span class="hljs-literal">null</span>) &#123;<br><span class="hljs-comment">//å¼•ç”¨é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œåˆ™ä»é›†åˆä¸­ç§»é™¤è¯¥å…ƒç´ </span><br>list.remove(poll);<br><span class="hljs-comment">//ç§»åŠ¨åˆ°å¼•ç”¨é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ </span><br>poll = queue.poll();<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>å¤§æ¦‚æ€è·¯ä¸ºï¼š</strong>æŸ¥çœ‹å¼•ç”¨é˜Ÿåˆ—ä¸­æœ‰æ— è½¯å¼•ç”¨ï¼Œå¦‚æœæœ‰ï¼Œåˆ™å°†è¯¥è½¯å¼•ç”¨ä»å­˜æ”¾å®ƒçš„é›†åˆä¸­ç§»é™¤ï¼ˆè¿™é‡Œä¸ºä¸€ä¸ªlisté›†åˆï¼‰</p><h3 id="å¼±å¼•ç”¨"><a href="#å¼±å¼•ç”¨" class="headerlink" title="å¼±å¼•ç”¨"></a>å¼±å¼•ç”¨</h3><p>åªæœ‰å¼±å¼•ç”¨å¼•ç”¨è¯¥å¯¹è±¡æ—¶ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œ<strong>æ— è®ºå†…å­˜æ˜¯å¦å……è¶³</strong>ï¼Œéƒ½ä¼šå›æ”¶å¼±å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡</p><ul><li>å¦‚ä¸Šå›¾å¦‚æœBå¯¹è±¡ä¸å†å¼•ç”¨A3å¯¹è±¡ï¼Œåˆ™A3å¯¹è±¡ä¼šè¢«å›æ”¶</li></ul><p><strong>å¼±å¼•ç”¨çš„ä½¿ç”¨å’Œè½¯å¼•ç”¨ç±»ä¼¼</strong>ï¼Œåªæ˜¯å°† <strong>SoftReference æ¢ä¸ºäº† WeakReference</strong></p><h3 id="è™šå¼•ç”¨"><a href="#è™šå¼•ç”¨" class="headerlink" title="è™šå¼•ç”¨"></a>è™šå¼•ç”¨</h3><p>å½“è™šå¼•ç”¨å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«å›æ”¶ä»¥åï¼Œè™šå¼•ç”¨å¯¹è±¡å°±ä¼šè¢«æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œè°ƒç”¨è™šå¼•ç”¨çš„æ–¹æ³•</p><ul><li>è™šå¼•ç”¨çš„ä¸€ä¸ªä½“ç°æ˜¯<strong>é‡Šæ”¾ç›´æ¥å†…å­˜æ‰€åˆ†é…çš„å†…å­˜</strong>ï¼Œå½“å¼•ç”¨çš„å¯¹è±¡ByteBufferè¢«åƒåœ¾å›æ”¶ä»¥åï¼Œè™šå¼•ç”¨å¯¹è±¡Cleanerå°±ä¼šè¢«æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œç„¶åè°ƒç”¨Cleanerçš„cleanæ–¹æ³•æ¥é‡Šæ”¾ç›´æ¥å†…å­˜</li><li>å¦‚ä¸Šå›¾ï¼ŒBå¯¹è±¡ä¸å†å¼•ç”¨ByteBufferå¯¹è±¡ï¼ŒByteBufferå°±ä¼šè¢«å›æ”¶ã€‚ä½†æ˜¯ç›´æ¥å†…å­˜ä¸­çš„å†…å­˜è¿˜æœªè¢«å›æ”¶ã€‚è¿™æ—¶éœ€è¦å°†è™šå¼•ç”¨å¯¹è±¡Cleaneræ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œç„¶åè°ƒç”¨å®ƒçš„cleanæ–¹æ³•æ¥é‡Šæ”¾ç›´æ¥å†…å­˜</li></ul><h3 id="ç»ˆç»“å™¨å¼•ç”¨"><a href="#ç»ˆç»“å™¨å¼•ç”¨" class="headerlink" title="ç»ˆç»“å™¨å¼•ç”¨"></a>ç»ˆç»“å™¨å¼•ç”¨</h3><p>æ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿è‡ªObjectç±»ï¼ŒObjectç±»æœ‰ä¸€ä¸ªfinalizeæ–¹æ³•ã€‚å½“æŸä¸ªå¯¹è±¡ä¸å†è¢«å…¶ä»–çš„å¯¹è±¡æ‰€å¼•ç”¨æ—¶ï¼Œä¼šå…ˆå°†ç»ˆç»“å™¨å¼•ç”¨å¯¹è±¡æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œç„¶åæ ¹æ®ç»ˆç»“å™¨å¼•ç”¨å¯¹è±¡æ‰¾åˆ°å®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡ï¼Œç„¶åè°ƒç”¨è¯¥å¯¹è±¡çš„finalizeæ–¹æ³•ã€‚è°ƒç”¨ä»¥åï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«åƒåœ¾å›æ”¶äº†</p><ul><li>å¦‚ä¸Šå›¾ï¼ŒBå¯¹è±¡ä¸å†å¼•ç”¨A4å¯¹è±¡ã€‚è¿™æ˜¯ç»ˆç»“å™¨å¯¹è±¡å°±ä¼šè¢«æ”¾å…¥å¼•ç”¨é˜Ÿåˆ—ä¸­ï¼Œå¼•ç”¨é˜Ÿåˆ—ä¼šæ ¹æ®å®ƒï¼Œæ‰¾åˆ°å®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡ã€‚ç„¶åè°ƒç”¨è¢«å¼•ç”¨å¯¹è±¡çš„finalizeæ–¹æ³•ã€‚è°ƒç”¨ä»¥åï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥è¢«åƒåœ¾å›æ”¶äº†</li></ul><h2 id="åƒåœ¾å›æ”¶ç®—æ³•"><a href="#åƒåœ¾å›æ”¶ç®—æ³•" class="headerlink" title="åƒåœ¾å›æ”¶ç®—æ³•"></a>åƒåœ¾å›æ”¶ç®—æ³•</h2><p>jvmæœ‰å››ç§åƒåœ¾å›æ”¶ç®—æ³•ã€æˆ‘ä»¬å°†ä»æ•ˆç‡å’Œç©ºé—´ç­‰æ–¹é¢æ¥å¯¹æ¯”å„ä¸ªç®—æ³•ã€‚</p><h3 id="æ ‡è®°æ¸…é™¤æ³•"><a href="#æ ‡è®°æ¸…é™¤æ³•" class="headerlink" title="æ ‡è®°æ¸…é™¤æ³•"></a>æ ‡è®°æ¸…é™¤æ³•</h3><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220228232550197.png" class><p>è¿™ä¸ªç®—æ³•æä¸ºç®€å•ï¼Œæ€»ä½“åˆ†ä¸ºä¸¤æ­¥</p><p>ç¬¬ä¸€æ­¥ï¼šåˆ©ç”¨å¯è¾¾æ€§å»éå†å†…å­˜ï¼ŒæŠŠåƒåœ¾å¯¹è±¡è¿›è¡Œæ ‡è®°ï¼›</p><p>ç¬¬äºŒæ­¥ï¼šå†éå†ä¸€éï¼ŒæŠŠåƒåœ¾è¿›è¡Œå›æ”¶</p><p>ç‰¹ç‚¹ï¼šæ•ˆç‡å·®ï¼Œå®ç°ç®€å•ï¼Œä½†æ˜¯ä¼šå‰©ä¸‹å¾ˆå¤šç¢ç‰‡ç©ºé—´ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¨‹åºä¹‹åè¿è¡Œçš„æ—¶å€™æœ‰ç©ºé—´ä½†æ²¡æœ‰è¿ç»­çš„å¤§ç©ºé—´è€Œä¸å¾—å·²è¿›è¡ŒGCã€‚</p><h3 id="æ ‡è®°æ•´ç†æ³•"><a href="#æ ‡è®°æ•´ç†æ³•" class="headerlink" title="æ ‡è®°æ•´ç†æ³•"></a>æ ‡è®°æ•´ç†æ³•</h3><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220228232734889.png" class><p>æ ‡è®°-æ•´ç† ä¼šå°†ä¸è¢«GC Rootå¼•ç”¨çš„å¯¹è±¡å›æ”¶ï¼Œæ¸…æ¥šå…¶å ç”¨çš„å†…å­˜ç©ºé—´ã€‚ç„¶åæ•´ç†å‰©ä½™çš„å¯¹è±¡ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…å› å†…å­˜ç¢ç‰‡è€Œå¯¼è‡´çš„é—®é¢˜ï¼Œä½†æ˜¯å› ä¸ºæ•´ä½“éœ€è¦æ¶ˆè€—ä¸€å®šçš„æ—¶é—´ï¼Œæ‰€ä»¥æ•ˆç‡è¾ƒä½</p><h3 id="å¤åˆ¶ç®—æ³•"><a href="#å¤åˆ¶ç®—æ³•" class="headerlink" title="å¤åˆ¶ç®—æ³•"></a>å¤åˆ¶ç®—æ³•</h3><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220228232826488.png" class><p>å°†å†…å­˜åˆ†ä¸ºç­‰å¤§å°çš„ä¸¤ä¸ªåŒºåŸŸï¼ŒFROMå’ŒTOï¼ˆTOä¸­ä¸ºç©ºï¼‰ã€‚å…ˆå°†è¢«GC Rootå¼•ç”¨çš„å¯¹è±¡ä»FROMæ”¾å…¥TOä¸­ï¼Œå†å›æ”¶ä¸è¢«GC Rootå¼•ç”¨çš„å¯¹è±¡ã€‚ç„¶åäº¤æ¢FROMå’ŒTOã€‚è¿™æ ·ä¹Ÿå¯ä»¥é¿å…å†…å­˜ç¢ç‰‡çš„é—®é¢˜ï¼Œä½†æ˜¯ä¼šå ç”¨åŒå€çš„å†…å­˜ç©ºé—´ã€‚</p><h2 id="åˆ†å¸¦å›æ”¶"><a href="#åˆ†å¸¦å›æ”¶" class="headerlink" title="åˆ†å¸¦å›æ”¶"></a>åˆ†å¸¦å›æ”¶</h2><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220228232952024.png" class><p>æ­¤æ—¶Javaå†…å­˜ä¼šåˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œæ–°åˆ›å»ºçš„å¯¹è±¡éƒ½è¢«æ”¾åœ¨äº†æ–°ç”Ÿä»£çš„ä¼Šç”¸å›­ä¸­ã€‚</p><p>å½“ä¼Šç”¸å›­ä¸­çš„å†…å­˜ä¸è¶³æ—¶ï¼Œå°±ä¼šè¿›è¡Œä¸€æ¬¡åƒåœ¾å›æ”¶ï¼Œè¿™æ—¶çš„å›æ”¶å«åš <strong>Minor GC</strong></p><p>Minor GC ä¼šå°†<strong>ä¼Šç”¸å›­å’Œå¹¸å­˜åŒºFROM</strong>å­˜æ´»çš„å¯¹è±¡<strong>å…ˆ</strong>å¤åˆ¶åˆ° <strong>å¹¸å­˜åŒº TO</strong>ä¸­ï¼Œ å¹¶è®©å…¶<strong>å¯¿å‘½åŠ 1</strong>ï¼Œå†<strong>äº¤æ¢ä¸¤ä¸ªå¹¸å­˜åŒº</strong></p><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220301234501199.png" class><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220301234516415.png" class><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220301234526373.png" class><p>å¦‚æœå¹¸å­˜åŒºä¸­çš„å¯¹è±¡çš„<strong>å¯¿å‘½è¶…è¿‡æŸä¸ªé˜ˆå€¼</strong>ï¼ˆæœ€å¤§ä¸º15ï¼Œ4bitï¼‰ï¼Œå°±ä¼šè¢«<strong>æ”¾å…¥è€å¹´ä»£</strong>ä¸­</p><p>å¦‚æœæ–°ç”Ÿä»£è€å¹´ä»£ä¸­çš„å†…å­˜éƒ½æ»¡äº†ï¼Œå°±ä¼šå…ˆè§¦å‘Minor GCï¼Œå†è§¦å‘<strong>Full GC</strong>ï¼Œæ‰«æ<strong>æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸­</strong>æ‰€æœ‰ä¸å†ä½¿ç”¨çš„å¯¹è±¡å¹¶å›æ”¶</p><h2 id="ååé‡ä¼˜å…ˆ"><a href="#ååé‡ä¼˜å…ˆ" class="headerlink" title="ååé‡ä¼˜å…ˆ"></a>ååé‡ä¼˜å…ˆ</h2><p>ååé‡ï¼šå³CPUç”¨äº<strong>è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´</strong>ä¸CPU<strong>æ€»æ¶ˆè€—æ—¶é—´</strong>çš„æ¯”å€¼ï¼ˆååé‡ &#x3D; è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ &#x2F; ( è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ + åƒåœ¾æ”¶é›†æ—¶é—´ )ï¼‰ï¼Œä¹Ÿå°±æ˜¯ã€‚ä¾‹å¦‚ï¼šè™šæ‹Ÿæœºå…±è¿è¡Œ100åˆ†é’Ÿï¼Œåƒåœ¾æ”¶é›†å™¨èŠ±æ‰1åˆ†é’Ÿï¼Œé‚£ä¹ˆååé‡å°±æ˜¯99%</p><ul><li>å¤šçº¿ç¨‹</li><li>å †å†…å­˜è¾ƒå¤§ï¼Œå¤šæ ¸CPU</li><li>å•ä½æ—¶é—´å†…ï¼ŒSTWï¼ˆstop the worldï¼Œåœæ‰å…¶ä»–æ‰€æœ‰å·¥ä½œçº¿ç¨‹ï¼‰æ—¶é—´æœ€çŸ­</li></ul><h2 id="å“åº”æ—¶é—´ä¼˜å…ˆ"><a href="#å“åº”æ—¶é—´ä¼˜å…ˆ" class="headerlink" title="å“åº”æ—¶é—´ä¼˜å…ˆ"></a>å“åº”æ—¶é—´ä¼˜å…ˆ</h2><ul><li>å¤šçº¿ç¨‹</li><li>å †å†…å­˜è¾ƒå¤§ï¼Œå¤šæ ¸CPU</li><li>å°½å¯èƒ½è®©å•æ¬¡STWæ—¶é—´å˜çŸ­ï¼ˆå°½é‡ä¸å½±å“å…¶ä»–çº¿ç¨‹è¿è¡Œï¼‰</li></ul><h2 id="åƒåœ¾å›æ”¶å™¨"><a href="#åƒåœ¾å›æ”¶å™¨" class="headerlink" title="*åƒåœ¾å›æ”¶å™¨"></a>*åƒåœ¾å›æ”¶å™¨</h2><h3 id="CMS"><a href="#CMS" class="headerlink" title="CMS"></a>CMS</h3><p>CMSè¿½æ±‚é«˜ååé‡ï¼ŒåŸºäº<strong>æ ‡è®°-æ¸…é™¤ç®—æ³•</strong>å®ç°ã€‚å¹¶å‘æ”¶é›†ã€ä½åœé¡¿ï¼Œä½†æ˜¯ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡</p><h4 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h4><ol><li>åˆå§‹æ ‡è®°ï¼Œä¸»è¦æ˜¯æ ‡è®°GC Rootçš„ä¸‹çº§å¯¹è±¡ï¼Œä¼šSTWï¼Œä½†æ˜¯å’ŒGC Rootç›¸å…³è”çš„å¯¹è±¡ä¸å¤šï¼Œæ‰€ä»¥æ—¶é—´å¾ˆçŸ­ã€‚</li><li>å¹¶å‘æ ‡è®°ï¼Œæ ¹æ®ä¸Šä¸€æ­¥çš„ç»“æœï¼Œç»§ç»­å‘ä¸‹æ ‡è¯†æ‰€æœ‰å…³è”çš„å¯¹è±¡è¢«ï¼Œç›´åˆ°å°½å¤´ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¤šçº¿ç¨‹çš„ï¼Œæ²¡æœ‰STWã€‚</li><li>é‡æ–°æ ‡è®°ï¼Œå°±æ˜¯å†æ ‡è®°ä¸€æ¬¡ï¼Œå› ä¸ºä¸Šä¸€æ­¥å¯èƒ½æœ‰çš„çº¿ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šå†äº§ç”Ÿåƒåœ¾ã€‚</li><li>å¹¶å‘æ¸…é™¤ï¼Œæ¸…é™¤è®¤ä¸ºæ­»äº¡çš„å¯¹è±¡</li></ol><h4 id="å¼Šç«¯"><a href="#å¼Šç«¯" class="headerlink" title="å¼Šç«¯"></a>å¼Šç«¯</h4><ol><li><strong>å¹¶å‘å›æ”¶å¯¼è‡´CPUèµ„æºç´§å¼ </strong>ï¼Œå®ƒä¸ä¼šå¯¼è‡´ç”¨æˆ·çº¿ç¨‹åœé¡¿ï¼Œä½†æ˜¯ä¼šå› ä¸ºå ç”¨äº†ä¸€éƒ¨åˆ†çº¿ç¨‹è€Œå¯¼è‡´åº”ç”¨ç¨‹åºå˜æ…¢ï¼Œé™ä½ååé‡ã€‚</li><li><strong>æ— æ³•æ¸…ç†æµ®åŠ¨åƒåœ¾</strong>ï¼Œåœ¨å¹¶å‘æ ‡è®°å’Œæ¸…é™¤é˜¶æ®µï¼Œç”¨æˆ·ç¨‹åºè¿˜åœ¨ç»§ç»­è¿è¡Œï¼Œè¿˜ä¼šä¼´éšæœ‰æ–°çš„åƒåœ¾äº§ç”Ÿï¼Œè¿™ä¸€éƒ¨åˆ†åƒåœ¾å‡ºç°åœ¨æ ‡è®°è¿‡ç¨‹ç»“æŸä»¥åï¼ŒCMSæ— æ³•æ¸…é™¤å®ƒä»¬ï¼Œåªèƒ½ç•™åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶çš„æ—¶å€™è¿›è¡Œæ¸…ç†ã€‚</li><li><strong>å¹¶å‘å¤±è´¥</strong>ï¼Œç”±äºå›æ”¶é˜¶æ®µç¨‹åºè¿˜åœ¨å¹¶å‘æ‰§è¡Œï¼Œæ‰€ä»¥è¦ç•™è¶³å¤Ÿçš„å†…å­˜ç»™ç”¨æˆ·ä½¿ç”¨ï¼Œå› æ­¤CMSä¸èƒ½åƒå…¶ä»–åƒåœ¾å›æ”¶å™¨ä¸€æ ·ç­‰è€å¹´ä»£æ»¡äº†çš„æ—¶å€™å†è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œé»˜è®¤æƒ…å†µä¸‹92%æ—¶å°±ä¼šè¿›è¡Œåƒåœ¾å›æ”¶ã€‚</li></ol><p>è¿™é‡Œæœ‰ä¸€ä¸ªé£é™©ï¼Œå°±æ˜¯å½“CMSè¿è¡ŒæœŸé—´é¢„ç•™å†…å­˜æ— æ³•æ»¡è¶³ç¨‹åºåˆ†é…æ–°éœ€è¦çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°â€œå¹¶å‘å¤±è´¥â€çš„æƒ…å†µã€‚è¿™æ—¶å€™å°±ä¼šSTWï¼Œæ—¶é—´éå¸¸æ¼«é•¿</p><ol start="4"><li><strong>å†…å­˜ç¢ç‰‡</strong>ï¼ŒCMSåŸºäºæ ‡è®°æ¸…é™¤æ³•è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå› æ­¤å½“å¤§å¯¹è±¡è¿‡å¤šçš„æ—¶å€™ä¼šå¸¦æ¥å¾ˆå¤šéº»çƒ¦ï¼Œå³ä½¿å†…å­˜å¾ˆå¤šï¼Œä½†æ˜¯å´æ²¡æœ‰ä¸€å—å¤§çš„å†…å­˜ï¼Œä¸å¾—ä¸è¿›è¡ŒFull GC.</li></ol><h3 id="G1"><a href="#G1" class="headerlink" title="G1"></a>G1</h3><p>G1æ˜¯ä¸€æ¬¾éå¸¸å‰å®³çš„åƒåœ¾å›æ”¶å™¨ï¼ŒJDK 9ä»¥åé»˜è®¤ä½¿ç”¨ï¼Œè€Œä¸”æ›¿ä»£äº†CMS æ”¶é›†å™¨</p><p><strong>é€‚ç”¨åœºæ™¯</strong></p><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305160230556.png" class><ul><li>åŒæ—¶æ³¨é‡ååé‡å’Œä½å»¶è¿Ÿï¼ˆå“åº”æ—¶é—´ï¼‰</li><li>è¶…å¤§å †å†…å­˜ï¼ˆå†…å­˜å¤§çš„ï¼‰ï¼Œä¼šå°†å †å†…å­˜åˆ’åˆ†ä¸ºå¤šä¸ª<strong>å¤§å°ç›¸ç­‰</strong>çš„åŒºåŸŸ</li><li>æ•´ä½“ä¸Šæ˜¯<strong>æ ‡è®°-æ•´ç†</strong>ç®—æ³•ï¼Œä¸¤ä¸ªåŒºåŸŸä¹‹é—´æ˜¯<strong>å¤åˆ¶</strong>ç®—æ³•</li></ul><p><strong>G1åƒåœ¾å›æ”¶é˜¶æ®µ</strong></p><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305160324463.png" class><p>æ–°ç”Ÿä»£ä¼Šç”¸å›­åƒåœ¾å›æ”¶â€”â€“&gt;å†…å­˜ä¸è¶³ï¼Œæ–°ç”Ÿä»£å›æ”¶+å¹¶å‘æ ‡è®°â€”â€“&gt;å›æ”¶æ–°ç”Ÿä»£ä¼Šç”¸å›­ã€å¹¸å­˜åŒºã€è€å¹´ä»£å†…å­˜â€”â€”&gt;æ–°ç”Ÿä»£ä¼Šç”¸å›­åƒåœ¾å›æ”¶(é‡æ–°å¼€å§‹)</p><h4 id="åˆ†åŒºç®—æ³•region"><a href="#åˆ†åŒºç®—æ³•region" class="headerlink" title="åˆ†åŒºç®—æ³•region"></a><strong>åˆ†åŒºç®—æ³•region</strong></h4><p>åˆ†ä»£æ˜¯æŒ‰å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸåˆ’åˆ†ï¼Œåˆ†åŒºåˆ™æ˜¯å°†å †ç©ºé—´åˆ’åˆ†è¿ç»­å‡ ä¸ªä¸åŒå°åŒºé—´ï¼Œæ¯ä¸€ä¸ªå°åŒºé—´ç‹¬ç«‹å›æ”¶ï¼Œå¯ä»¥æ§åˆ¶ä¸€æ¬¡å›æ”¶å¤šå°‘ä¸ªå°åŒºé—´ï¼Œæ–¹ä¾¿æ§åˆ¶ GC äº§ç”Ÿçš„åœé¡¿æ—¶é—´</p><p>Eï¼šä¼Šç”¸å›­ Sï¼šå¹¸å­˜åŒº Oï¼šè€å¹´ä»£</p><h5 id="Young-Collection"><a href="#Young-Collection" class="headerlink" title="Young Collection"></a>Young Collection</h5><ul><li>ä¼šSTW</li></ul><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305160826717.png" class><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305160524775.png" class><h5 id="Young-Collection-CMï¼ˆå¹¶å‘æ ‡è®°ï¼‰"><a href="#Young-Collection-CMï¼ˆå¹¶å‘æ ‡è®°ï¼‰" class="headerlink" title="Young Collection + CMï¼ˆå¹¶å‘æ ‡è®°ï¼‰"></a>Young Collection + CMï¼ˆå¹¶å‘æ ‡è®°ï¼‰</h5><ul><li>åœ¨ Young GC æ—¶ä¼š<strong>å¯¹ GC Root è¿›è¡Œåˆå§‹æ ‡è®°</strong></li><li>åœ¨è€å¹´ä»£<strong>å ç”¨å †å†…å­˜çš„æ¯”ä¾‹</strong>è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œå¯¹è¿›è¡Œå¹¶å‘æ ‡è®°ï¼ˆä¸ä¼šSTWï¼‰ï¼Œé˜ˆå€¼å¯ä»¥æ ¹æ®ç”¨æˆ·æ¥è¿›è¡Œè®¾å®š</li></ul><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305160937129.png" class><h5 id="Mixed-Collection"><a href="#Mixed-Collection" class="headerlink" title="Mixed Collection"></a>Mixed Collection</h5><p>ä¼šå¯¹E S O è¿›è¡Œ<strong>å…¨é¢çš„å›æ”¶</strong></p><ul><li>æœ€ç»ˆæ ‡è®°</li><li><strong>æ‹·è´</strong>å­˜æ´»</li></ul><p><strong>é—®</strong>ï¼šä¸ºä»€ä¹ˆæœ‰çš„è€å¹´ä»£è¢«æ‹·è´äº†ï¼Œæœ‰çš„æ²¡æ‹·è´ï¼Ÿ</p><p>å› ä¸ºæŒ‡å®šäº†æœ€å¤§åœé¡¿æ—¶é—´ï¼Œå¦‚æœå¯¹æ‰€æœ‰è€å¹´ä»£éƒ½è¿›è¡Œå›æ”¶ï¼Œè€—æ—¶å¯èƒ½è¿‡é«˜ã€‚ä¸ºäº†ä¿è¯æ—¶é—´ä¸è¶…è¿‡è®¾å®šçš„åœé¡¿æ—¶é—´ï¼Œä¼š<strong>å›æ”¶æœ€æœ‰ä»·å€¼çš„è€å¹´ä»£</strong>ï¼ˆå›æ”¶åï¼Œèƒ½å¤Ÿå¾—åˆ°æ›´å¤šå†…å­˜ï¼‰</p><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305161211242.png" class><h4 id="Young-Collection-è·¨ä»£å¼•ç”¨"><a href="#Young-Collection-è·¨ä»£å¼•ç”¨" class="headerlink" title="Young Collection è·¨ä»£å¼•ç”¨"></a>Young Collection è·¨ä»£å¼•ç”¨</h4><ul><li>æ–°ç”Ÿä»£å›æ”¶çš„è·¨ä»£å¼•ç”¨ï¼ˆè€å¹´ä»£å¼•ç”¨æ–°ç”Ÿä»£ï¼‰é—®é¢˜</li></ul><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305161345437.png" class><ul><li>å¡è¡¨ä¸Remembered Set<ul><li>Remembered Set å­˜åœ¨äºEä¸­ï¼Œç”¨äºä¿å­˜æ–°ç”Ÿä»£å¯¹è±¡å¯¹åº”çš„è„å¡<ul><li>è„å¡ï¼šOè¢«åˆ’åˆ†ä¸ºå¤šä¸ªåŒºåŸŸï¼ˆä¸€ä¸ªåŒºåŸŸ512Kï¼‰ï¼Œå¦‚æœè¯¥åŒºåŸŸå¼•ç”¨äº†æ–°ç”Ÿä»£å¯¹è±¡ï¼Œåˆ™è¯¥åŒºåŸŸè¢«ç§°ä¸ºè„å¡</li></ul></li></ul></li><li>åœ¨å¼•ç”¨å˜æ›´æ—¶é€šè¿‡post-write barried + dirty card queue</li><li>concurrent refinement threads æ›´æ–° Remembered Set</li></ul><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>G1åƒåœ¾å›æ”¶åˆ†ä¸ºå››ä¸ªè¿‡ç¨‹</p><ol><li>åˆå§‹æ ‡è®°ï¼ˆä¼šSTWï¼‰ï¼šä»…ä»…æ ‡è®°GCèƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œè®©ä¸‹ä¸€é˜¶æ®µç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æ—¶å€™ï¼Œèƒ½æ­£ç¡®çš„å†å¯ç”¨Regionè¿™åˆ†é…æ–°çš„å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹æ—¶é—´éå¸¸çŸ­</li><li>å¹¶å‘æ ‡è®°ï¼šä»GC Rootè¿›è¡Œå¯è¾¾æ€§åˆ†æï¼Œæ‰¾åˆ°è¦å›æ”¶çš„å¯¹è±¡ï¼Œè¿™ä¸ªé˜¶æ®µè€—æ—¶è¾ƒé•¿ï¼Œä½†æ˜¯ä¼šå’Œç”¨æˆ·ç¨‹åºå¹¶å‘æ‰§è¡Œï¼Œåœ¨å¯¹è±¡å›¾æ‰«æå®Œæˆä»¥åï¼Œè¦é‡æ–°å¤„ç†åœ¨å¹¶å‘è¿‡ç¨‹ä¸­æœ‰å˜åŠ¨çš„å¼•ç”¨å¯¹è±¡</li><li>æœ€ç»ˆæ ‡è®°ï¼ˆä¼šSTWï¼‰ï¼šå¯¹ç”¨æˆ·çº¿ç¨‹åšçŸ­æš‚æš‚åœï¼Œå¤„ç†å¹¶å‘é˜¶æ®µç»“æŸåä»ç„¶æœ‰å¼•ç”¨å˜åŠ¨çš„å¯¹è±¡ã€‚</li><li>æ¸…ç†é˜¶æ®µï¼ˆä¼šSTWï¼‰ ï¼šæ›´æ–°Reginçš„ç»Ÿè®¡æ•°æ®ï¼Œå¯¹å„ä¸ªRegionçš„å›æ”¶ä»·å€¼è¿›è¡Œæˆæœ¬æ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„åœé¡¿æ—¶é—´æ¥æŒ‡å®šå›æ”¶è®¡åˆ’ï¼Œå¯ä»¥è‡ªç”±é€‰æ‹©ä»»æ„å¤šRegionæ„æˆå›æ”¶é›†ï¼ŒæŠŠå†³å®šå›æ”¶çš„regionå¤åˆ¶åˆ°æ–°çš„regionï¼Œå†æ¸…é™¤æ‰åŸæ¥çš„æ•´ä¸ªRegion</li></ol><h3 id="Remark"><a href="#Remark" class="headerlink" title="Remark"></a>Remark</h3><p>é‡æ–°æ ‡è®°é˜¶æ®µ</p><p>åœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œæ”¶é›†å™¨å¤„ç†å¯¹è±¡çš„è¿‡ç¨‹ä¸­</p><p>é»‘è‰²ï¼šå·²è¢«å¤„ç†ï¼Œéœ€è¦ä¿ç•™çš„ ç°è‰²ï¼šæ­£åœ¨å¤„ç†ä¸­çš„ ç™½è‰²ï¼šè¿˜æœªå¤„ç†çš„</p><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305161439176.png" class><p>ä½†æ˜¯åœ¨<strong>å¹¶å‘æ ‡è®°è¿‡ç¨‹ä¸­</strong>ï¼Œæœ‰å¯èƒ½Aè¢«å¤„ç†äº†ä»¥åæœªå¼•ç”¨Cï¼Œä½†è¯¥å¤„ç†è¿‡ç¨‹è¿˜æœªç»“æŸï¼Œåœ¨<strong>å¤„ç†è¿‡ç¨‹ç»“æŸä¹‹å‰</strong>Aå¼•ç”¨äº†Cï¼Œè¿™æ—¶å°±ä¼šç”¨åˆ°remark</p><p>è¿‡ç¨‹å¦‚ä¸‹</p><ul><li>ä¹‹å‰Cæœªè¢«å¼•ç”¨ï¼Œè¿™æ—¶Aå¼•ç”¨äº†Cï¼Œå°±ä¼šç»™CåŠ ä¸€ä¸ªå†™å±éšœï¼Œå†™å±éšœçš„æŒ‡ä»¤ä¼šè¢«æ‰§è¡Œï¼Œå°†Cæ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—å½“ä¸­ï¼Œå¹¶å°†Cå˜ä¸º å¤„ç†ä¸­ çŠ¶æ€</li><li>åœ¨<strong>å¹¶å‘æ ‡è®°</strong>é˜¶æ®µç»“æŸä»¥åï¼Œé‡æ–°æ ‡è®°é˜¶æ®µä¼šSTWï¼Œç„¶åå°†æ”¾åœ¨è¯¥é˜Ÿåˆ—ä¸­çš„å¯¹è±¡é‡æ–°å¤„ç†ï¼Œå‘ç°æœ‰å¼ºå¼•ç”¨å¼•ç”¨å®ƒï¼Œå°±ä¼šå¤„ç†å®ƒ</li></ul><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305161626021.png" class><h3 id="ç©ºé—´åˆ†é…æ‹…ä¿åŸåˆ™"><a href="#ç©ºé—´åˆ†é…æ‹…ä¿åŸåˆ™" class="headerlink" title="ç©ºé—´åˆ†é…æ‹…ä¿åŸåˆ™"></a>ç©ºé—´åˆ†é…æ‹…ä¿åŸåˆ™</h3><img src="/2022/02/28/JVM/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/image-20220305163001997.png" class><p>è‡³æ­¤æˆ‘äº†è§£åˆ°çš„æœ‰å…³JVMå†…å®¹çš†å¦‚ä¸Šï¼Œæ¬¢è¿å¤§å®¶è¯„è®º</p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVMå†…å­˜ç»“æ„</title>
    <link href="/2022/02/27/JVM/JVM%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/"/>
    <url>/2022/02/27/JVM/JVM%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/</url>
    
    <content type="html"><![CDATA[<h1 id="JVMå†…å­˜ç»“æ„"><a href="#JVMå†…å­˜ç»“æ„" class="headerlink" title="JVMå†…å­˜ç»“æ„"></a>JVMå†…å­˜ç»“æ„</h1><img src="/2022/02/27/JVM/JVM%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/image-20220227232032763.png" class><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒJVMåˆ†ä¸º5å¤§åŒºåŸŸï¼Œç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€å †ã€æ–¹æ³•åŒºã€‚å…¶ä¸­é™¤äº†å †å’Œæ–¹æ³•åŒºå¤–å…¨éƒ¨çº¿ç¨‹ç§æœ‰ã€‚</p><ul><li>ç¨‹åºè®¡æ•°å™¨</li></ul><p>çº¿ç¨‹ç§æœ‰ï¼Œæ˜¯ä¸€å—å¾ˆå°çš„ç©ºé—´ï¼Œæ˜¯å½“å‰çº¿ç¨‹çš„æŒ‡ç¤ºå™¨ï¼Œè®°å½•ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚ä¸è®¡ç®—æœºCPUå†…ç¨‹åºè®¡æ•°å™¨ä½œç”¨ç±»ä¼¼ã€‚</p><ul><li>è™šæ‹Ÿæœºæ ˆ</li></ul><p>çº¿ç¨‹ç§æœ‰ï¼Œæ¯ä¸ªæ–¹æ³•æ‰§è¡Œçš„æ—¶å€™å°±åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡ï¼Œæ“ä½œæ•°ã€åŠ¨æ€é“¾æ¥å’Œæ–¹æ³•è¿”å›ç­‰ä¿¡æ¯ï¼Œå½“è¯·æ±‚æ ˆè¶…è¿‡è™šæ‹Ÿæœºå…è®¸çš„æœ€å¤§æ·±åº¦çš„æ—¶å€™ï¼Œä¼šæœ‰StackOverFlow</p><ul><li>æœ¬åœ°æ–¹æ³•æ ˆ</li></ul><p>çº¿ç¨‹ç§æœ‰ï¼Œä¿å­˜nativeæ–¹æ³•ä¿¡æ¯ï¼Œå½“ä¸€ä¸ªJVMåˆ›å»ºçš„çº¿ç¨‹è°ƒç”¨nativeæ–¹æ³•åï¼Œjvmä¸ä¼šåœ¨è™šæ‹Ÿæœºä¸­åˆ›å»ºæ ˆå¸§ï¼Œè€Œæ˜¯ç®€å•çš„åŠ¨æ€é“¾æ¥åç›´æ¥è°ƒç”¨<br>æœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆå‘æŒ¥çš„ä½œç”¨åŸºæœ¬ä¸€æ ·ã€‚åŒºåˆ«æ˜¯:æœ¬åœ°æ–¹æ³•æ ˆæ‰§è¡Œçš„æ˜¯Nativeæ–¹æ³•æœåŠ¡,è€Œè™šæ‹Ÿæœºæ ˆæ‰§è¡Œçš„æ˜¯javaæ–¹æ³•ã€‚åœ¨HotSpot vmä¸­æœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ã€‚</p><img src="/2022/02/27/JVM/JVM%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/e9d511ea.png" class><ul><li>å †</li></ul><p>Javaå †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜ï¼Œå‡ ä¹æ‰€æœ‰å¯¹è±¡å®ä¾‹å’Œæ•°ç»„éƒ½è¦åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œç»å¸¸åƒåœ¾å›æ”¶</p><ul><li>æ–¹æ³•åŒº</li></ul><p>å­˜æ”¾ç±»åŠ è½½ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰ç­‰ã€‚å³æ°¸ä¹…ä»£ï¼Œåœ¨JDK1.8åä¸å­˜åœ¨æ–¹æ³•åŒºäº†ï¼Œè¢«å…ƒæ•°æ®åŒºæ‰€ä»£æ›¿äº†ï¼ŒåŸæ–¹æ³•åŒºè¢«åˆ’åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼š </p><ol><li>åŠ è½½åˆ°ç±»ä¿¡æ¯</li><li>è¿è¡Œæ—¶å¸¸é‡æ± </li></ol><p>åŠ è½½çš„ç±»ä¿¡æ¯è¢«ä¿å­˜åœ¨äº†å…ƒæ•°æ®åŒºï¼Œè¿è¡Œæ—¶å¸¸é‡æ± ä¿å­˜åœ¨å †ä¸­ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ConcurrentHashMapæ·±åº¦å‰–æ</title>
    <link href="/2022/02/26/Java%E9%9B%86%E5%90%88/ConcurrentHashMap%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/"/>
    <url>/2022/02/26/Java%E9%9B%86%E5%90%88/ConcurrentHashMap%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="ConcurrentHashMapæ·±åº¦å‰–æ"><a href="#ConcurrentHashMapæ·±åº¦å‰–æ" class="headerlink" title="ConcurrentHashMapæ·±åº¦å‰–æ"></a>ConcurrentHashMapæ·±åº¦å‰–æ</h1><p>æˆ‘åœ¨ä¸Šä¸€æ¬¡é¢è¯•è¢«é—®åˆ°äº†ä¸ºç”šä¹ˆConcurrentHashMapå¯ä»¥å®ç°çº¿ç¨‹å®‰å…¨ï¼Œè¿™é‡Œæˆ‘æ²¡æœ‰ç­”å‡ºæ¥ï¼Œåœ¨è¿™é‡Œæˆ‘æ‰“ç®—å¥½å¥½å¸¦å¤§å®¶ä¸€èµ·äº†è§£ConcurrentHashMapé¡ºä¾¿è®©æˆ‘å¤ä¹ ä¸€ä¸‹ã€‚</p><h2 id="ConcurrentHashMapä¸ºä»€ä¹ˆå¯ä»¥å®ç°çº¿ç¨‹å®‰å…¨"><a href="#ConcurrentHashMapä¸ºä»€ä¹ˆå¯ä»¥å®ç°çº¿ç¨‹å®‰å…¨" class="headerlink" title="ConcurrentHashMapä¸ºä»€ä¹ˆå¯ä»¥å®ç°çº¿ç¨‹å®‰å…¨"></a>ConcurrentHashMapä¸ºä»€ä¹ˆå¯ä»¥å®ç°çº¿ç¨‹å®‰å…¨</h2><h3 id="JDK1-7"><a href="#JDK1-7" class="headerlink" title="JDK1.7"></a>JDK1.7</h3><p><strong>æ•°æ®ç»“æ„</strong></p><img src="/2022/02/26/Java%E9%9B%86%E5%90%88/ConcurrentHashMap%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220226232104869.png" class><p>åœ¨1.7çš„æ—¶å€™ConcurrentHashMapç”±<code>segment</code>æ•°ç»„å’Œ<code>HashEntry</code>æ•°ç»„ç»„æˆï¼ŒConcurrentHashMapæŠŠå“ˆå¸Œæ¡¶åˆ†ä¸ºsegmentå°æ•°ç»„ï¼Œæ¯ä¸ªå°æ•°ç»„æœ‰nä¸ªHashEntryç»„æˆã€‚segmentç»§æ‰¿RenntrantLockå³å¯é‡å…¥é”ï¼ŒhashEntryå­˜å‚¨é”®å€¼å¯¹ã€‚</p><p><strong>ç»“æœ</strong></p><p>é¦–å…ˆå°†æ•°æ®åˆ†ä¸ºä¸€æ®µä¸€æ®µå­˜å‚¨ï¼Œç„¶åç»™æ¯ä¸€æ®µéƒ½é…ä¸€æŠŠå¯é‡å…¥é”ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å ç”¨é”è®¿é—®å…¶ä¸­ä¸€ä¸ªæ®µæ•°æ®æ—¶ï¼Œå…¶ä»–æ•°æ®ä¹Ÿèƒ½è®¿é—®ï¼ŒçœŸæ­£èƒ½å®ç°å¹¶å‘ã€‚</p><h3 id="JDK1-8"><a href="#JDK1-8" class="headerlink" title="JDK1.8"></a>JDK1.8</h3><p><strong>æ•°æ®ç»“æ„</strong></p><img src="/2022/02/26/Java%E9%9B%86%E5%90%88/ConcurrentHashMap%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220226232838666.png" class><p>1.8é‡‡ç”¨äº†æ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘ç»“æ„ã€‚åœ¨é”å®ç°ä¸ŠæŠ›å¼ƒäº†segmnetåˆ†æ®µå¼é”ï¼Œè€Œæ˜¯é‡‡ç”¨<code>CAS + synchronized</code>å®ç°æ›´åŠ ä½ç²’åº¦çš„é”ã€‚</p><p>é”çš„çº§åˆ«æ§åˆ¶åœ¨äº†hashæ¡¶å…ƒç´ çº§åˆ«ï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦é”ä½é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œå³çº¢é»‘æ ‘æ ¹èŠ‚ç‚¹ï¼Œå°±ä¸ä¼šå½±å“å…¶ä»–å“ˆå¸Œæ¡¶å…ƒç´ è¯»å†™ï¼Œå¤§å¤§æé«˜å¹¶å‘åº¦ã€‚</p><h2 id="ConcurrentHashMap-putæ–¹æ³•"><a href="#ConcurrentHashMap-putæ–¹æ³•" class="headerlink" title="ConcurrentHashMap putæ–¹æ³•"></a>ConcurrentHashMap putæ–¹æ³•</h2><h3 id="JDK1-7-1"><a href="#JDK1-7-1" class="headerlink" title="JDK1.7"></a>JDK1.7</h3><p>é¦–å…ˆå°è¯•è·å–é”ï¼Œå¦‚æœæ²¡æœ‰è·å–åˆ°å°±è¿›è¡Œè‡ªæ—‹ï¼Œå¦‚æœè‡ªæ—‹è¶…è¿‡64æ¬¡ï¼Œæ”¹ä¸ºé˜»å¡è·å–é”ã€‚</p><p>è·å–åˆ°ä»¥åï¼š</p><ol><li>å°†segmentä¸­çš„tableé€šè¿‡keyå®šä½åˆ°HashEntry</li><li>éå†HashEntryï¼Œå¦‚æœä¸ä¸ºç©ºå°±åˆ¤æ–­ä¼ å…¥çš„keyä¸å½“å‰éå†keyæ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰å°±è¦†ç›–</li><li>ä¸ä¸ºç©ºå°±æ–°å»ºä¸€ä¸ªHashEntryå¹¶åŠ å…¥åˆ°segmentï¼ŒåŒæ—¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</li><li>é‡Šæ”¾é”</li></ol><h3 id="JDK1-8-1"><a href="#JDK1-8-1" class="headerlink" title="JDK1.8"></a>JDK1.8</h3><ol><li>æ ¹æ®keyè®¡ç®—hashå€¼</li><li>åˆ¤æ–­æ˜¯å¦éœ€è¦åˆå§‹åŒ–</li><li>å®šä½åˆ°nodeï¼Œæ‹¿åˆ°é¦–èŠ‚ç‚¹f,</li></ol><ul><li>å¦‚æœä¸ºnullå°±ä½¿ç”¨casè¿›è¡Œæ·»åŠ </li><li>å¦‚æœf.hash &#x3D;&#x3D; MOVED &#x3D;&#x3D; -1,è¯´æ˜å…¶ä»–çº¿ç¨‹æ­£åœ¨æ‰©å®¹ï¼Œåˆ™å‚ä¸ä¸€èµ·æ‰©å®¹</li><li>éƒ½ä¸æ»¡è¶³å°±ç”¨synchronizedé”ä½fï¼Œåˆ¤æ–­æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘ï¼Œç›´æ¥æ’å…¥</li></ul><p>å…·ä½“å¯ä»¥çœ‹è¿™é‡Œ<a href="https://mp.weixin.qq.com/s?__biz=MzkyMTI3Mjc2MQ==&mid=2247485909&idx=1&sn=d9c672eebb090866a72f99f3d8032e76&source=41#wechat_redirect">é¢è¯• ConcurrentHashMap ï¼Œçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ (qq.com)</a></p><h2 id="ConcurrentHashMap-getæ–¹æ³•æ˜¯å¦éœ€è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ"><a href="#ConcurrentHashMap-getæ–¹æ³•æ˜¯å¦éœ€è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ" class="headerlink" title="ConcurrentHashMap getæ–¹æ³•æ˜¯å¦éœ€è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ"></a>ConcurrentHashMap getæ–¹æ³•æ˜¯å¦éœ€è¦åŠ é”ï¼Œä¸ºä»€ä¹ˆ</h2><p>ä¸éœ€è¦ï¼Œå› ä¸ºNodeå…ƒç´ çš„valå’ŒæŒ‡é’ˆnextæ˜¯volatileä¿®é¥°çš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çº¿ç¨‹Aä¿®æ”¹valæˆ–å¢åŠ èŠ‚ç‚¹å¯¹çº¿ç¨‹Bå¯è§</p><img src="/2022/02/26/Java%E9%9B%86%E5%90%88/ConcurrentHashMap%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220226234644053.png" class><h2 id="ConcurrentHashMapä¸æ”¯æŒkeyæˆ–è€…valueä¸ºnullçš„åŸå› "><a href="#ConcurrentHashMapä¸æ”¯æŒkeyæˆ–è€…valueä¸ºnullçš„åŸå› " class="headerlink" title="ConcurrentHashMapä¸æ”¯æŒkeyæˆ–è€…valueä¸ºnullçš„åŸå› "></a>ConcurrentHashMapä¸æ”¯æŒkeyæˆ–è€…valueä¸ºnullçš„åŸå› </h2><h3 id="valueä¸èƒ½ä¸ºnullåŸå› "><a href="#valueä¸èƒ½ä¸ºnullåŸå› " class="headerlink" title="valueä¸èƒ½ä¸ºnullåŸå› "></a>valueä¸èƒ½ä¸ºnullåŸå› </h3><p>å› ä¸ºConcurrentHashMapç”¨äºå¤šçº¿ç¨‹ï¼Œå¦‚æœmap.get(key)å¾—åˆ°nullï¼Œæ— æ³•åˆ¤æ–­æ˜¯å¾—åˆ°çš„valueä¸ºnullè¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°keyä¸ºnullï¼Œè€Œå•çº¿ç¨‹hashmapå¯ä»¥ä½¿ç”¨containsKeyæ–¹æ³•å»åˆ¤æ–­ã€‚</p><p>è¿™æ ·å½“åœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶æ²¡æœ‰keyï¼Œç¬¬äºŒæ¬¡æœ‰keyä½†å€¼ä¸ºnullï¼Œè¿™æ ·å°±å…·æœ‰äºŒä¹‰æ€§</p><h3 id="keyä¸èƒ½ä¸ºnull"><a href="#keyä¸èƒ½ä¸ºnull" class="headerlink" title="keyä¸èƒ½ä¸ºnull"></a>keyä¸èƒ½ä¸ºnull</h3><p>é¦–å…ˆnullä¸å¥½è®¡ç®—å“ˆå¸Œå€¼ï¼Œç„¶åå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ”¾å…¥nullä¼šå‡ºé—®é¢˜ï¼Œ</p><h2 id="ConcurrentHashMapçš„å¹¶å‘åº¦æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ConcurrentHashMapçš„å¹¶å‘åº¦æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ConcurrentHashMapçš„å¹¶å‘åº¦æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ConcurrentHashMapçš„å¹¶å‘åº¦æ˜¯ä»€ä¹ˆï¼Ÿ</h2><h3 id="JDK1-7-2"><a href="#JDK1-7-2" class="headerlink" title="JDK1.7"></a>JDK1.7</h3><p>å¹¶å‘åº¦é»˜è®¤16ï¼Œå¯ä»¥è‡ªå·±è®¾ç½®ï¼Œé»˜è®¤æ˜¯2çš„næ¬¡æ–¹ï¼Œå¦‚æœè®¾ç½®17ï¼Œåˆ™çœŸå®ä¸º32.</p><h2 id="ConcurrentHashMapè¿­ä»£å™¨æ˜¯å¼ºä¸€è‡´æ€§è¿˜æ˜¯å¼±ä¸€è‡´æ€§ï¼Ÿ"><a href="#ConcurrentHashMapè¿­ä»£å™¨æ˜¯å¼ºä¸€è‡´æ€§è¿˜æ˜¯å¼±ä¸€è‡´æ€§ï¼Ÿ" class="headerlink" title="ConcurrentHashMapè¿­ä»£å™¨æ˜¯å¼ºä¸€è‡´æ€§è¿˜æ˜¯å¼±ä¸€è‡´æ€§ï¼Ÿ"></a>ConcurrentHashMapè¿­ä»£å™¨æ˜¯å¼ºä¸€è‡´æ€§è¿˜æ˜¯å¼±ä¸€è‡´æ€§ï¼Ÿ</h2><p>ä¸hashmapä¸åŒï¼ŒConcurrentHashMapè¿­ä»£å™¨æ˜¯å¼±ä¸€è‡´æ€§</p><p>ConcurrentHashMapè¿­ä»£å™¨åˆ›å»ºä»¥åï¼Œå°±ä¼šæŒ‰å“ˆå¸Œè¡¨ç»“æ„éå†ï¼Œä½†æ˜¯åœ¨éå†çš„æ—¶å€™ï¼Œå†…éƒ¨å…ƒç´ å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœå˜åŒ–å‘ç”Ÿåœ¨å·²ç»å˜åŒ–çš„éƒ¨åˆ†ï¼Œè¿­ä»£å™¨ä¸ä¼šåæ˜ å‡ºæ¥ï¼Œå¦‚æœå‘ç”Ÿåœ¨æœªéå†çš„éƒ¨åˆ†ï¼Œè¿­ä»£å™¨å°±ä¼šå‘ç°å¹¶åæ˜ å‡ºæ¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Javaé›†åˆ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ConcurrentHashMap</tag>
      
      <tag>Javaé›†åˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HashMapæ·±åº¦å‰–æ</title>
    <link href="/2022/02/25/Java%E9%9B%86%E5%90%88/HashMap%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/"/>
    <url>/2022/02/25/Java%E9%9B%86%E5%90%88/HashMap%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="HashMapæ·±åº¦å‰–æ"><a href="#HashMapæ·±åº¦å‰–æ" class="headerlink" title="HashMapæ·±åº¦å‰–æ"></a>HashMapæ·±åº¦å‰–æ</h1><p>æœ€è¿‘å¼€å­¦äº†ï¼Œåœ¨å¿™ç€å‡†å¤‡è€ƒè¯•å’Œå¤ä¹ ï¼Œæ‰€ä»¥æœ‰å‡ å¤©æ²¡æœ‰æ›´æ–°ï¼Œä»Šå¤©æˆ‘å›æ¥äº†ï¼</p><p>ä»Šå¤©å¸¦å¤§å®¶æ¥å­¦ä¹ ä¸€ä¸‹HashMapçš„åº•å±‚åŸç†ï¼Œé¡ºä¾¿å¤ä¹ ä¸€ä¸‹ã€‚</p><h2 id="Javaé›†åˆç»§æ‰¿"><a href="#Javaé›†åˆç»§æ‰¿" class="headerlink" title="Javaé›†åˆç»§æ‰¿"></a>Javaé›†åˆç»§æ‰¿</h2><p><img src="https://img.jbzj.com/file_images/article/201711/2017110209260219.gif" alt="2017110209260219.gif"></p><p>ï¼ˆå›¾ç‰‡æ¥æºäºç½‘ç»œï¼‰</p><p>ç”±ä¸Šå›¾å¯ä»¥çœ‹å‡ºList Set Queueä¸‰è€…éƒ½å®ç°è‡ªCollectionè€ŒMapåˆ™å•ç‹¬å®ç°äºMap.</p><p>Listæœ‰åºï¼Œè¿™é‡Œæ˜¯æŒ‡æ’å…¥é¡ºåºæœ‰åºï¼Œå¯ä»¥æ’å…¥é‡å¤å†…å®¹å’Œnullã€‚Setæ— åºï¼Œé‡Œé¢å†…å®¹å„ä¸ç›¸åŒï¼Œåªèƒ½å­˜åœ¨ä¸€ä¸ªnullï¼Œè€ŒHashMapæ˜¯ä¸€ç§é”®å€¼å¯¹ï¼Œåªèƒ½å­˜åœ¨ä¸€ä¸ªé”®ä¸ºnulldé”®å€¼å¯¹ã€‚</p><h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><p>HashMap ç»´æŠ¤äº†ä¸€ä¸ªEntryæ•°ç»„ï¼Œæ•°ç»„é‡Œå­˜å‚¨çš„æ˜¯é”®å€¼å¯¹ã€‚</p><p>åœ¨JDK1.7ä¸­ï¼Œç”± æ•°ç»„+é“¾è¡¨ ç»„æˆï¼Œé“¾è¡¨èƒ½è§£å†³hashå†²çªï¼Œè¿™é‡Œä½¿ç”¨å¤´æ’æ³•ï¼Œä¼šå¯¼è‡´é“¾è¡¨æ­»å¾ªç¯ã€‚</p><p>åœ¨JDK1.8ä¸­ï¼Œç”± æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ç»„æˆã€‚</p><h3 id="Hashé»˜è®¤åŠ è½½å› å­"><a href="#Hashé»˜è®¤åŠ è½½å› å­" class="headerlink" title="Hashé»˜è®¤åŠ è½½å› å­"></a>Hashé»˜è®¤åŠ è½½å› å­</h3><img src="/2022/02/25/Java%E9%9B%86%E5%90%88/HashMap%E6%B7%B1%E5%BA%A6%E5%89%96%E6%9E%90/image-20220225234015202.png" class><p>é€šè¿‡æºç å¯ä»¥çœ‹å‡ºæ˜¯0.75ï¼Œ</p><p>Node tableçš„åˆå§‹åŒ–é•¿åº¦ä¸º16ï¼Œä¹Ÿå°±æ˜¯è¯´å½“è¶…è¿‡12æ—¶ä¼šè¿›è¡Œæ‰©å®¹ï¼Œ0.75æ˜¯ä¸€ä¸ªæƒè¡¡åçš„å€¼ã€‚è¾ƒé«˜æ—¶ä¼šé™ä½ç©ºé—´å¼€é”€ï¼Œä½†ä¼šå¢åŠ æŸ¥æ‰¾æˆæœ¬ï¼Œåä¹‹åˆ™ä¼šæµªè´¹ç©ºé—´ã€‚</p><p>é¦–å…ˆä½¿ç”¨Hashç®—æ³•è®¡ç®—å®ƒçš„hashcode,è®¡ç®—å‡ºæ¥ä»¥åè¿›è¡Œå–æ¨¡æ“ä½œ.</p><h2 id="putæ–¹æ³•"><a href="#putæ–¹æ³•" class="headerlink" title="putæ–¹æ³•"></a>putæ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">final</span> V <span class="hljs-title function_">putVal</span><span class="hljs-params">(<span class="hljs-type">int</span> hash, K key, V value, <span class="hljs-type">boolean</span> onlyIfAbsent,</span><br><span class="hljs-params">               <span class="hljs-type">boolean</span> evict)</span> &#123;<br>    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="hljs-type">int</span> n, i;<br>    <span class="hljs-keyword">if</span> ((tab = table) == <span class="hljs-literal">null</span> || (n = tab.length) == <span class="hljs-number">0</span>)<br>        n = (tab = resize()).length;<br>    <span class="hljs-keyword">if</span> ((p = tab[i = (n - <span class="hljs-number">1</span>) &amp; hash]) == <span class="hljs-literal">null</span>)<br>        tab[i] = newNode(hash, key, value, <span class="hljs-literal">null</span>);<br>    <span class="hljs-keyword">else</span> &#123;<br>        Node&lt;K,V&gt; e; K k;<br>        <span class="hljs-keyword">if</span> (p.hash == hash &amp;&amp;<br>            ((k = p.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))<br>            e = p;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p <span class="hljs-keyword">instanceof</span> TreeNode)<br>            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="hljs-built_in">this</span>, tab, hash, key, value);<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">binCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; ; ++binCount) &#123;<br>                <span class="hljs-keyword">if</span> ((e = p.next) == <span class="hljs-literal">null</span>) &#123;<br>                    p.next = newNode(hash, key, value, <span class="hljs-literal">null</span>);<br>                    <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>) <span class="hljs-comment">// -1 for 1st</span><br>                        treeifyBin(tab, hash);<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))<br>                    <span class="hljs-keyword">break</span>;<br>                p = e;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) &#123; <span class="hljs-comment">// existing mapping for key</span><br>            <span class="hljs-type">V</span> <span class="hljs-variable">oldValue</span> <span class="hljs-operator">=</span> e.value;<br>            <span class="hljs-keyword">if</span> (!onlyIfAbsent || oldValue == <span class="hljs-literal">null</span>)<br>                e.value = value;<br>            afterNodeAccess(e);<br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>    &#125;<br>    ++modCount;<br>    <span class="hljs-keyword">if</span> (++size &gt; threshold)<br>        resize();<br>    afterNodeInsertion(evict);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šä¸ºputæ–¹æ³•æºç </p><p>å¯ä»¥çœ‹åˆ°å®ƒç¬¬ä¸€æ­¥æ˜¯çœ‹æ•°ç»„æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºå°±è¿›è¡Œåˆå§‹åŒ–</p><p>ç„¶åçœ‹æ˜¯å¦ä¼šæœ‰å†²çªï¼Œå¦‚æœæ²¡æœ‰å°±ç›´æ¥æ”¾å…¥</p><p>å¦‚æœå†²çªäº†ä¸”keyå·²å­˜åœ¨å°±ç›´æ¥è¦†ç›–è¿™ä¸ªå€¼</p><p>å¦‚æœå†²çªåæ˜¯ä¸ªæ•°é‚£å°±ç›´æ¥æŒ‚åœ¨æ ‘ä¸Š</p><p>å¦‚æœæ˜¯ä¸ªé“¾è¡¨é‚£å°±åˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦å¤§äº8ä¸”æ•°ç»„å°äº64ï¼Œå¦‚æœè¿™æ ·å°±è¿›è¡Œæ‰©å®¹ï¼Œå¦‚æœé“¾è¡¨é•¿åº¦å¤§äº8ä¸”æ•°ç»„å¤§äº64é‚£å°±è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œå¦åˆ™ç›´æ¥é“¾è¡¨ä¸Šç”¨å°¾æ’æ³•æŒ‚ä¸Š</p><h2 id="æ‰©å®¹è¿‡ç¨‹"><a href="#æ‰©å®¹è¿‡ç¨‹" class="headerlink" title="æ‰©å®¹è¿‡ç¨‹"></a>æ‰©å®¹è¿‡ç¨‹</h2><h3 id="JDK1-7"><a href="#JDK1-7" class="headerlink" title="JDK1.7"></a>JDK1.7</h3><p>åœ¨1.7å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªå®¹é‡æ›´å¤§çš„æ•°ç»„ä»£æ›¿åŸæ¥çš„æ•°ç»„ï¼Œç”¨transfer()æ–¹æ³•å°†åŸæœ‰å†…å®¹æ”¾åœ¨æ–°çš„å†…å®¹é‡Œ</p><h3 id="JDK1-8"><a href="#JDK1-8" class="headerlink" title="JDK1.8"></a>JDK1.8</h3><p>è¿›è¡Œäº†ä¸¤å¤„ä¼˜åŒ–</p><h4 id="ä¼˜åŒ–1"><a href="#ä¼˜åŒ–1" class="headerlink" title="ä¼˜åŒ–1"></a>ä¼˜åŒ–1</h4><p>åœ¨è®¡ç®—ä½ç½®çš„æ—¶å€™ä¸ç”¨å†è®¡ç®—hashï¼Œè€Œæ˜¯çœ‹åŸæ¥çš„hashæ–°å¢çš„bitæ˜¯1è¿˜æ˜¯0å°±è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">do</span> &#123;<br>                            next = e.next;<br>                            <span class="hljs-keyword">if</span> ((e.hash &amp; oldCap) == <span class="hljs-number">0</span>) &#123;<br>                                <span class="hljs-keyword">if</span> (loTail == <span class="hljs-literal">null</span>)<br>                                    loHead = e;<br>                                <span class="hljs-keyword">else</span><br>                                    loTail.next = e;<br>                                loTail = e;<br>                            &#125;<br>                            <span class="hljs-keyword">else</span> &#123;<br>                                <span class="hljs-keyword">if</span> (hiTail == <span class="hljs-literal">null</span>)<br>                                    hiHead = e;<br>                                <span class="hljs-keyword">else</span><br>                                    hiTail.next = e;<br>                                hiTail = e;<br>                            &#125;<br>                        &#125; <span class="hljs-keyword">while</span> ((e = next) != <span class="hljs-literal">null</span>);<br>                        <span class="hljs-keyword">if</span> (loTail != <span class="hljs-literal">null</span>) &#123;<br>                            loTail.next = <span class="hljs-literal">null</span>;<br>                            newTab[j] = loHead;<br>                        &#125;<br>                        <span class="hljs-keyword">if</span> (hiTail != <span class="hljs-literal">null</span>) &#123;<br>                            hiTail.next = <span class="hljs-literal">null</span>;<br>                            newTab[j + oldCap] = hiHead;<br>                        &#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯resizeæ–¹æ³•çš„éƒ¨åˆ†è¿‡ç¨‹</p><p>hashmapé•¿åº¦ä¸º2çš„næ¬¡æ–¹ï¼Œå†é•¿åº¦å˜ä¸ºäºŒå€çš„æ—¶å€™ï¼Œè¿›åˆ¶ä¸Šå°±å¤šä¸€ä½ï¼Œæ­¤æ—¶å°±æ˜¯å¤šäº†ä¸€ä¸ªé«˜å‚ä½å‚ä¸æ•°ç»„ä¸‹æ ‡ç¡®å®šã€‚æ­¤æ—¶ä¸€ä¸ªå…ƒç´ é€šè¿‡hashç®—æ³•è®¡ç®—åæ°å¥½å‡ºç°ä¸€ä¸ªç°è±¡ï¼Œæœ€é«˜ä½æ˜¯0åæ ‡ä¸å˜ï¼Œ1åˆ™å˜ä¸ºåŸé•¿åº¦+åŸåæ ‡ã€‚</p><p>ä¾‹å¦‚åŸä½ç½®ä¸º5ï¼ŒäºŒè¿›åˆ¶0101ï¼Œæ•°ç»„é•¿åº¦16</p><p>ç°åœ¨æ‰©å®¹ä¸º32ï¼Œ5å’Œ32-1è¿›è¡Œ&amp;è¿ç®—åä¸º10101ï¼Œç¬¬ä¸€ä½å˜ä¸º1ï¼Œæ‰€ä»¥æ–°ä½ç½®æ˜¯5+16.</p><h4 id="ä¼˜åŒ–2"><a href="#ä¼˜åŒ–2" class="headerlink" title="ä¼˜åŒ–2"></a>ä¼˜åŒ–2</h4><p>é‡‡ç”¨å°¾æ’æ³•</p><p>ä¸ä¼šæ­»å¾ªç¯</p><p>å¤šçº¿ç¨‹putä¸¢å¤±ï¼Œget putå¹¶å‘ä¼šgetä¸ºnull</p><h2 id="é•¿åº¦ä¸º2çš„næ¬¡æ–¹"><a href="#é•¿åº¦ä¸º2çš„næ¬¡æ–¹" class="headerlink" title="é•¿åº¦ä¸º2çš„næ¬¡æ–¹"></a>é•¿åº¦ä¸º2çš„næ¬¡æ–¹</h2><p>è®¡ç®—é€Ÿåº¦å¿«</p><p>ä¸Šé¢resizeä»£ç å¯ä»¥çœ‹åˆ°ï¼Œè®¡ç®—hashå€¼çš„æ—¶å€™è¿›è¡Œçš„æ˜¯&amp;æ“ä½œï¼Œè¿™ä¸ªæ“ä½œé€Ÿåº¦å¿«äº%</p>]]></content>
    
    
    <categories>
      
      <category>Javaé›†åˆ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Javaé›†åˆ</tag>
      
      <tag>HashMap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxä¸‹Djangoç¦»çº¿éƒ¨ç½²</title>
    <link href="/2022/02/24/Django/Linux%E4%B8%8BDjango%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2/"/>
    <url>/2022/02/24/Django/Linux%E4%B8%8BDjango%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<h1 id="Linuxä¸‹Djangoç¦»çº¿éƒ¨ç½²"><a href="#Linuxä¸‹Djangoç¦»çº¿éƒ¨ç½²" class="headerlink" title="Linuxä¸‹Djangoç¦»çº¿éƒ¨ç½²"></a>Linuxä¸‹Djangoç¦»çº¿éƒ¨ç½²</h1><p>åœ¨è¿™é‡Œä»‹ç»ä¸€ä¸‹Linuxä¸‹Djangoç¦»çº¿éƒ¨ç½²çš„è¿‡ç¨‹ï¼Œå¤§æ¦‚åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥</p><ol><li>é¦–å…ˆå°±æ˜¯python manage.py runserver</li><li>ç¬¬äºŒæ­¥å°±æ˜¯ ä½¿ç”¨uwsgiè¿›è¡Œä»£ç†</li><li>nginxåå‘ä»£ç†ï¼Œè¿™ä¸€æ­¥å¯ä»¥é™ä½æœåŠ¡å™¨å¯¹äºé™æ€èµ„æºçš„åº”å¯¹èƒ½åŠ›ï¼Œå®ç°åŠ¨é™åˆ†ç¦»ï¼Œå¢åŠ æ•ˆç‡ã€‚</li></ol><p>1.é¦–å…ˆå…³é—­é˜²ç«å¢™</p><p><strong>systemctl disable firewalld</strong></p><p>chkconfig iptables off</p><p>2.å…³é—­selinux</p><p>vi &#x2F;etc&#x2F;selinux&#x2F;config</p><img src="/2022/02/24/Django/Linux%E4%B8%8BDjango%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2/image-20220113142902248.png" class><p>3.ping <a href="http://www.baidu.com/">www.baidu.com</a></p><p>4.ç”¨yumå®‰è£…åŒ…</p><p>yum -y install wget vim</p><p>wget <a href="https://www.python.org/ftp/python/3.7.6/Python-3.7.6.tgz">https://www.python.org/ftp/python/3.7.6/Python-3.7.6.tgz</a></p><p>å®‰è£…optä¸‹</p><p>å®‰è£…pythonä¾èµ–</p><p>yum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel</p><figure class="highlight cmake"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs cmake">yum <span class="hljs-keyword">install</span> libffi-devel<br></code></pre></td></tr></table></figure><p>è§£å‹python</p><p>tar -xzvf Python-3.7.6.tgz -C &#x2F;usr&#x2F;local&#x2F;src&#x2F;</p><p>cd &#x2F;usr&#x2F;local&#x2F;src&#x2F;</p><p>cd Python-3.7.6&#x2F;</p><p>.&#x2F;configure â€“prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;python3</p><p>make &amp;&amp; make install</p><p>æ·»åŠ ç¯å¢ƒå˜é‡</p><p>cd &#x2F;etc&#x2F;profile.d&#x2F;</p><p>vi python3.sh</p><p>æ·»åŠ export PATH&#x3D;â€$PATH:&#x2F;usr&#x2F;local&#x2F;python3&#x2F;binâ€</p><p>é‡è½½ç¯å¢ƒå˜é‡ source ..&#x2F;profile</p><p>echo $PATH</p><p>############33</p><p>å®é™…éƒ¨ç½²</p><p>cd &#x2F;opt</p><p>mkdir wxapp</p><p>cd wxapp</p><p>mkdir script</p><p>ä¸Šä¼ é¡¹ç›®è‡³wxapp</p><p>pip3 install â€“upgrade pip</p><p>pip freeze &gt;requirements.txt</p><p>pip3 download -d packages -r requirements.txt</p><p>ä¿®æ”¹ALLOW_HOST</p><p>pip3 install uwsgi</p><p>è¿™ä¸€æ­¥ä¸€å®šæ˜¯å†åœ¨wweixinappç›®å½•ä¸‹</p><p>uwsgi â€“http 0.0.0.0:8000 â€“file weixinapp&#x2F;wsgi.py â€“static-map&#x3D;&#x2F;static&#x3D;static</p><p>cd ..&#x2F;script</p><p>vim uwsgi.ini</p><div class="code-wrapper"><pre><code class="hljs">[uwsgi]# é¡¹ç›®ç›®å½•http=0.0.0.0:8000chdir=/opt/wxapp/weixinapp/# å¯åŠ¨uwsgiçš„ç”¨æˆ·åå’Œç”¨æˆ·ç»„uid=rootgid=root# æŒ‡å®šé¡¹ç›®çš„applicationmodule=weixinapp.wsgi:application# æŒ‡å®šsockçš„æ–‡ä»¶è·¯å¾„socket=/opt/wxapp/script/uwsgi.sock# å¯ç”¨ä¸»è¿›ç¨‹master=true# è¿›ç¨‹ä¸ªæ•°workers=5pidfile=/opt/wxapp/script/uwsgi.pid# è‡ªåŠ¨ç§»é™¤unix Socketå’Œpidæ–‡ä»¶å½“æœåŠ¡åœæ­¢çš„æ—¶å€™vacuum=true# åºåˆ—åŒ–æ¥å—çš„å†…å®¹ï¼Œå¦‚æœå¯èƒ½çš„è¯thunder-lock=true# å¯ç”¨çº¿ç¨‹enable-threads=true# è®¾ç½®è‡ªä¸­æ–­æ—¶é—´harakiri=30# è®¾ç½®ç¼“å†²post-buffering=4096# è®¾ç½®æ—¥å¿—ç›®å½•daemonize=/opt/wxapp/script/uwsgi.log</code></pre></div><p>uwsgi â€“ini uwsgi.ini  # å¯åŠ¨uwsgi</p><p>uwsgi â€“stop uwsgi.pid</p><p>ps -ef | grep -i uwsgi</p><p>æ·»åŠ nginxé…ç½®æ–‡ä»¶</p><p>cd &#x2F;www&#x2F;server&#x2F;nginx&#x2F;conf&#x2F;</p><p>vim weixinapp.conf</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ini">server &#123;<br>                    listen 8000<span class="hljs-comment">;</span><br>                    server_name 121.4.192.22 <span class="hljs-comment">;</span><br>                    charset  utf-8<span class="hljs-comment">;</span><br>                    <span class="hljs-comment"># æŒ‡å®šé¡¹ç›®è·¯å¾„uwsgi</span><br>                    location / &#123;<br>                        include uwsgi_params<span class="hljs-comment">;</span><br>                        uwsgi_connect_timeout 30<span class="hljs-comment">;</span><br>                        uwsgi_pass unix:/opt/wxapp/script/uwsgi.sock<span class="hljs-comment">;</span><br>                    &#125;<br>                    <span class="hljs-comment"># æŒ‡å®šé™æ€æ–‡ä»¶è·¯å¾„</span><br>                    location /static/ &#123;<br>                        alias  /opt/wxapp/weixinapp/static/<span class="hljs-comment">;</span><br>                        index  index.html index.htm<span class="hljs-comment">;</span><br>                    &#125;<br><br>    &#125;<br></code></pre></td></tr></table></figure><p>&#x2F;etc&#x2F;init.d&#x2F;nginx start</p><p>&#x2F;etc&#x2F;init.d&#x2F;nginx stop</p>]]></content>
    
    
    <categories>
      
      <category>Django</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Django</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘ç»œæ”»å‡»è¡Œä¸ºé‰´èµ</title>
    <link href="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/"/>
    <url>/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="ç½‘ç»œæ”»å‡»è¡Œä¸ºé‰´èµ"><a href="#ç½‘ç»œæ”»å‡»è¡Œä¸ºé‰´èµ" class="headerlink" title="ç½‘ç»œæ”»å‡»è¡Œä¸ºé‰´èµ"></a>ç½‘ç»œæ”»å‡»è¡Œä¸ºé‰´èµ</h1><p>æˆ‘å¤§æ¦‚åœ¨åŠå¹´å‰å°±åœ¨Bç«™ä¸Šçœ‹åˆ°äº†ä¸€ä¸ªæœ‰å…³äºç½‘ç»œå®‰å…¨çš„ç§‘æ™®è§†é¢‘ï¼Œå½“æ—¶è¿˜æ²¡æœ‰å­¦ä¹ è®¡ç®—æœºç½‘ç»œï¼Œçœ‹çš„ä¸€çŸ¥åŠè§£ã€‚å½“æˆ‘å­¦ä¹ çš„è¿‡ç¨‹ä¸­åˆçœ‹äº†ä¸€éï¼Œéå¸¸æœ‰è¶£ã€‚è¿™ä¸ªè§†é¢‘æˆ‘å·²ç»çœ‹äº†ä¸ä¸‹äº”éï¼Œä½†æ¯ä¸€æ¬¡è§‚çœ‹éƒ½æœ‰æ–°çš„æ”¶è·ï¼Œæ‰€ä»¥æ‰“ç®—å†™ä¸€ç¯‡æ–‡ç« æ¥è®°å½•ä¸€ä¸‹ã€‚</p><p>è§†é¢‘<a href="https://www.bilibili.com/video/BV1KQ4y117nq">é“¾æ¥</a>åœ¨è¿™é‡Œï¼Œå¸Œæœ›å¤§å®¶ä¸€å¥ä¸‰è¿ï¼</p><h2 id="DoS"><a href="#DoS" class="headerlink" title="DoS"></a>DoS</h2><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217140001471.png" class><p>åœ¨æœ€å¼€å§‹æˆ‘å…ˆæ¥ä»‹ç»Dos(Denial of Service)æ”»å‡»ï¼Œå³æ‹’ç»æœåŠ¡ã€‚å°±æ˜¯å ç”¨ç½‘ç»œèµ„æºè®©æœåŠ¡å™¨åº”æ¥ä¸æš‡ï¼Œä»è€Œæ‹’ç»æ­£å¸¸ä¸šåŠ¡æµé‡çš„ä¸€ç§æ”»å‡»æ–¹å¼ã€‚</p><h2 id="DDoS"><a href="#DDoS" class="headerlink" title="DDoS"></a>DDoS</h2><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217140230372.png" class><p>DDoS(Distributed denial of service), åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ã€‚å³â€ç¾¤æ®´â€ã€‚æˆåƒä¸Šä¸‡è®¾å¤‡åŒæ—¶å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚</p><p>åœ¨è¯¦ç»†è®²è§£å„ç±»ç½‘ç»œæ”»å‡»æ–¹æ³•ä¹‹å‰æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€çœ‹ç½‘ç»œæ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚</p><h2 id="ç½‘ç»œåŸç†"><a href="#ç½‘ç»œåŸç†" class="headerlink" title="ç½‘ç»œåŸç†"></a>ç½‘ç»œåŸç†</h2><h3 id="è®¿é—®è¿‡ç¨‹"><a href="#è®¿é—®è¿‡ç¨‹" class="headerlink" title="è®¿é—®è¿‡ç¨‹"></a>è®¿é—®è¿‡ç¨‹</h3><p>ä¸€æ¬¡ç½‘ç»œè®¿é—®è¿‡ç¨‹ç®€åŒ–å¦‚ä¸‹ï¼š</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217140559093.png" class><p>å®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œçº¿è·¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨æŸ¥è¯¢æˆ–è®¡ç®—åå‘æœåŠ¡å™¨è¿”å›ç»“æœã€‚è¿™ç±»æ•°æ®æµè½¬çš„è¡Œä¸ºå’Œä¼ ç»Ÿé‚®é€’ååˆ†ç›¸ä¼¼ã€‚</p><h3 id="ç½‘ç»œç³»ç»Ÿ"><a href="#ç½‘ç»œç³»ç»Ÿ" class="headerlink" title="ç½‘ç»œç³»ç»Ÿ"></a>ç½‘ç»œç³»ç»Ÿ</h3><p>é‚®é€’ä¾é é‚®æ”¿ç³»ç»Ÿï¼Œäº’è”ç½‘åˆ™ä¾é TCP&#x2F;IPåè®®é€šä¿¡ç³»ç»Ÿã€‚</p><p>å¯ç®€åŒ–ä¸ºä»¥ä¸‹å››å±‚ç»“æ„</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217141028712.png" class><h4 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h4><p>åœ¨æˆ‘ä»¬å†™ä¿¡æ—¶å¸¸ä¼šéµå¾ªä¸€äº›åˆé€‚ï¼Œå¦‚å¼€å§‹è¦å†™å¯¹æ–¹ç§°å‘¼ã€ä»¥åŠæœ€åçš„ç½²åå’Œæ—¥æœŸç­‰ã€‚HTTPåè®®åˆ™åšåˆ°äº†è¿™ä¸€ç‚¹ï¼Œå…³äºHTTPæ›´å¤šå…·ä½“å†…å®¹å¯æŸ¥çœ‹<a href="https://andersonlee09.github.io/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E5%BA%94%E7%94%A8%E5%B1%82%E8%AF%A6%E8%A7%A3/">è¿™é‡Œ</a>ã€‚</p><h4 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h4><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217141151773.png" class><p>åœ¨å†™å®Œå†…å®¹åæˆ‘ä»¬å¯ä»¥ç»™ä¿¡åŠ ä¸€ä¸ªåŠ æ€¥ç­‰æ ‡è®°ï¼Œå¯¹æ–¹ä¼šæ ¹æ®æ ‡è®°å†³å®šå¦‚ä½•å›å¤ï¼Œè¦ä¸è¦åŠ æ€¥æˆ–è€…ç¡®è®¤å¯¹æ–¹èº«ä»½ç­‰ã€‚ä¼ è¾“å±‚åˆ™å®Œæˆäº†è¿™ä¸ªåŠŸèƒ½ï¼Œè§„å®šäº†æ•°æ®ä¼ è¾“æ–¹å¼ï¼Œæ¯”å¦‚è¿™ä¸€å±‚æˆ‘ä»¬å¸¸è§çš„TCPåè®®ï¼Œä¸ºä¿è¯é€šä¿¡å¯é æ€§è¦å…ˆè¿›æ€§ä¸‰æ¬¡æ¡æ‰‹æ‰ä¼šè¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œè¿‡ç¨‹å¯æŸ¥çœ‹<a href="https://andersonlee09.github.io/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/#%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B">è¿™é‡Œ</a>,æˆ‘ä»¬çš„ç½‘ç»œæ”»å‡»æ–¹å¼å¾ˆå¤šä¹Ÿæ˜¯æ ¹æ®TCPåè®®æ¥è¿›è¡Œã€‚</p><h4 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h4><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217142223881.png" class><p>è£…æ–°å»ºçš„ä¿¡å°åˆ™ç±»ä¼¼äºç½‘ç»œå±‚ï¼Œè§„å®šäº†é€šä¿¡åŒæ–¹åœ°å€çš„ç¼–ç è§„åˆ™ï¼Œè¿™ä¸€å±‚é‡‡ç”¨IPåè®®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸¸ä¼šå¬åˆ°â€œè®¾å¤‡IPåœ°å€â€ã€‚</p><h4 id="å­ç½‘å±‚"><a href="#å­ç½‘å±‚" class="headerlink" title="å­ç½‘å±‚"></a>å­ç½‘å±‚</h4><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217142406073.png" class><p>ä¸€å°ä¿¡çš„æŠ•é€’ä¸»è¦ä¾é çš„æ˜¯é‚®å±€ï¼Œé‚®å±€æ”¶åˆ°ä¿¡ä¹‹åæ ¹æ®åœ°å€å°†ä¿¡ä»¶é€åˆ°ç›®çš„åœ°ï¼Œè¿™å°±å¯¹åº”å­ç½‘å±‚ï¼Œå°†æ•°å­—ä¿¡å·è½¬åŒ–ä¸ºç‰©ç†ä¿¡å·ï¼Œæ¯”å¦‚å«æ˜Ÿã€ä»¥å¤ªç½‘ç­‰ã€‚</p><p>æ•°æ®æ ¹æ®ä¸åŒåè®®è¿›è¡Œä¸åŒæ‰“åŒ…ï¼Œåˆ°è¾¾ç›®çš„åœ°ä¹‹ååˆè¿›è¡Œåˆ†å±‚æ‹†åŒ…æœ€ç»ˆè¢«ç›®æ ‡æ¥æ”¶ã€‚</p><p>ä¸‹é¢æ ¹æ®è¿™äº›åè®®æ¥æ¬£èµä¸åŒçš„æ”»å‡»æŠ€æœ¯ã€‚</p><h2 id="ICMPæ´ªæ°´"><a href="#ICMPæ´ªæ°´" class="headerlink" title="ICMPæ´ªæ°´"></a>ICMPæ´ªæ°´</h2><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217142900737.png" class><p>å‘ä¸€å°æœåŠ¡å™¨ä¸æ–­å‘é€IPåè®®æ•°æ®åŒ…ï¼Œå°±å¯ä»¥æ¶ˆè€—å¯¹æ–¹ç½‘ç»œå¸¦å®½ï¼Œä»è€Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚</p><p>ä¾‹å¦‚æˆ‘ä»¬å¸¸è§çš„pingå‘½ä»¤å°±å¯ä»¥å‘é€ICMPåè®®åŒ…ï¼Œè¿™ç§æ”»å‡»æ–¹å¼äº¤ICMPæ´ªæ°´ã€‚è¿™ç§æ”»å‡»ç±»ä¼¼äºæˆ‘ä»¬ä¸æ–­ç»™æŸä¸ªäººæŠ•é€’ä¿¡ä»¶ï¼Œå†™ä»€ä¹ˆä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯è®©ä¿¡ä»¶å¤šçš„é‚®é€’å‘˜åœ¨å¯¹æ–¹é—¨å£æ’èµ·é•¿é˜Ÿï¼Œä»è€Œæ‰“æ–­æ­£å¸¸çš„ä¿¡ä»¶æ”¶å‘ï¼ŒåŒæ ·æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€ä¼ è¾“å±‚UDPåè®®åŒ…ï¼Œå‘èµ·UDPæ´ªæ°´ï¼Œä½†è¿™æ ·ä¼šæš´éœ²æ”»å‡»è€…IPåœ°å€ï¼Œè€Œè¢«å¯¹æ–¹ç¦å°ã€‚æ‰€ä»¥æ”»å‡»è€…å¯ä»¥ä¼ªé€ ä¸€ä¸ªè™šå‡æˆ–è€…ä¸å­˜åœ¨çš„IPä»è€Œéšè—è‡ªå·±ã€‚</p><h2 id="åå°„æ”»å‡»"><a href="#åå°„æ”»å‡»" class="headerlink" title="åå°„æ”»å‡»"></a>åå°„æ”»å‡»</h2><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217143923150.png" class><p>æ—¢ç„¶å¯ä»¥ä¼ªé€ IPï¼Œé‚£æˆ‘ä»¬å°±å°†å‘ä»¶åœ°å€æ”¹ä¸ºè¦æ”»å‡»çš„ç›®æ ‡çš„åœ°å€ï¼Œæ”¶ä»¶åœ°å€ä¸ºäº’è”ç½‘ç¬¬ä¸‰æ–¹æœºå™¨ï¼Œè¿™æ ·å›å¤çš„ä¿¡ä»¶å°±ä¼šæŒ‡å‘æ”»å‡»ç›®æ ‡ï¼Œç¬¬ä¸‰æ–¹æœºå™¨æˆä¸ºâ€œåå°„å™¨â€ã€‚</p><p>è¿™å°±ç±»ä¼¼äºæŠŠåˆ«äººç”µè¯å·ç æ”¾åœ¨å¾€ä¸Šï¼Œç„¶åæœºä¸»è¢«ä¸æ˜çœŸç›¸çš„æ¨é”€å‘˜å‘¼æ­»ã€‚è¿™æ ·å°±å¾ˆéš¾æŸ¥åˆ°å¹•åé»‘æ‰‹ã€‚</p><h2 id="æ”¾å¤§æ”»å‡»"><a href="#æ”¾å¤§æ”»å‡»" class="headerlink" title="æ”¾å¤§æ”»å‡»"></a>æ”¾å¤§æ”»å‡»</h2><p>è¿™æ›´åƒæ˜¯åå°„æ”»å‡»çš„è¿›åŒ–ç‰ˆã€‚</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217144258721.png" class><p>æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„DNSæœåŠ¡å™¨ï¼Œè¿™æ˜¯ä¸€ç§è§£æIPåœ°å€çš„æœåŠ¡å™¨ï¼Œæ¯”å¦‚æˆ‘ä»¬å‘æµè§ˆå™¨è¾“å…¥<a href="http://www.bilibili.com/">www.bilibili.com</a> , æµè§ˆå™¨ä¼šå…ˆå‘DNSæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå°†Bç«™çš„IPå‘é€ç»™å®¢æˆ·ç«¯ï¼Œç„¶åå®¢æˆ·ç«¯ä¼šæ ¹æ®IPæ¥è®¿é—®Bç«™æœåŠ¡å™¨ã€‚åœ¨è¿™é‡ŒDNSæœåŠ¡å™¨è¿”å›çš„æ•°æ®è¿œè¿œå¤§äºè¯·æ±‚æ•°æ®ï¼Œä¸€èˆ¬60ä¸ªå­—èŠ‚è¯·æ±‚æ•°æ®å¯è¿”å›3000å­—èŠ‚è¿”å›æ•°æ®ï¼Œå¸¦å®½æ”¾å¤§å› å­(BAF)ä¸º50,å³å¯äº§ç”Ÿ50å€çš„æ”¾å¤§æ•ˆæœã€‚</p><p>è¿™æ ·æ”»å‡»è€…å°±å¯ä»¥å‘DNSæœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼ŒåŒæ—¶å°†è‡ªå·±IPä¼ªé€ ä¸ºè¢«æ”»å‡»è€…IPï¼Œè¿™æ ·å°±å¯ä»¥äº§ç”Ÿ50å€çš„æ”¾å¤§æ•ˆæœï¼Œå¯è°“å››ä¸¤æ‹¨äºŒåæ–¤ã€‚</p><h2 id="TCPæ´ªæ°´"><a href="#TCPæ´ªæ°´" class="headerlink" title="TCPæ´ªæ°´"></a>TCPæ´ªæ°´</h2><p>é™¤äº†å ç”¨è¢«æ”»å‡»è€…å¸¦å®½ï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šæ–¹å¼å¯ä»¥è¾¾åˆ°ç›®çš„ã€‚æ¯”å¦‚æ”»å‡»æœåŠ¡å™¨è¿æ¥èµ„æº</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217145113861.png" class><p>æˆ‘ä»¬çŸ¥é“TCPä¸‰æ¬¡æ¡æ‰‹åä¼šä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼Œæ­¤æ—¶æœåŠ¡å™¨ä¼šæœ‰ä¸€ä¸ªè¿æ¥è¡¨æ¥è®°å½•æ­£åœ¨è¿æ¥çš„è¿æ¥ï¼Œè€Œè¿æ¥è¡¨å¤§å°æœ‰é™ï¼Œæˆ‘ä»¬å¯ä»¥è®©æ”»å‡»è®¾å¤‡å‘èµ·å¤§é‡TCPè¿æ¥ï¼Œå æ»¡TCPè¿æ¥è¡¨ï¼Œè®©å…¶ä¸èƒ½å®Œæˆåé¢çš„è¿æ¥è¯·æ±‚ä»è€Œè¾¾åˆ°DDoSæ•ˆæœã€‚ä½†å› ä¸ºä¸‰æ¬¡æ¡æ‰‹çš„å­˜åœ¨ï¼Œè¯¥æ”»å‡»æ–¹å¼ä¸èƒ½ä¼ªé€ IPã€‚</p><h2 id="SYNæ´ªæ°´"><a href="#SYNæ´ªæ°´" class="headerlink" title="SYNæ´ªæ°´"></a>SYNæ´ªæ°´</h2><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217145721104.png" class><p>çœ‹è¿‡ä¸‰æ¬¡æ¡æ‰‹çš„éƒ½çŸ¥é“ï¼Œæ¡æ‰‹ç¬¬ä¸€æ­¥æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€SYN&#x3D;1çš„æ•°æ®åŒ…ï¼Œæ ¹æ®æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å‘æœåŠ¡å™¨åªå‘é€SYNè€Œä¸è¿›è¡Œå›ç­”ï¼Œç”±äºTCPçš„é‡ä¼ æœºåˆ¶ï¼ŒæœåŠ¡å™¨ä¼šå¤šæ¬¡é‡ä¼ SYN+ACKç›´åˆ°è¶…æ—¶ï¼Œå¤§çº¦åæ¬¡ã€‚æ­¤æ—¶è¯·æ³¨æ„ï¼Œæ”»å‡»è€…è¦å°½é‡ä¼ªé€ è‡ªå·±çš„IPï¼Œå¦åˆ™å°±ä¼šè¾¾åˆ°â€œæ€æ•Œä¸€åƒï¼Œè‡ªæŸä¸€ä¸‡â€çš„æ•ˆæœã€‚å¦‚æœIPä¸å­˜åœ¨ï¼Œå—å®³è€…ä¼šæ‹”å‰‘å››é¡¾å¿ƒèŒ«ç„¶ï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£å°±æŠŠç¥¸æ°´ä¸œå¼•åˆ°äº†æŸä¸ªå€’éœ‰è›‹èº«ä¸Šã€‚</p><h2 id="RSTæ´ªæ°´æ”»å‡»"><a href="#RSTæ´ªæ°´æ”»å‡»" class="headerlink" title="RSTæ´ªæ°´æ”»å‡»"></a>RSTæ´ªæ°´æ”»å‡»</h2><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217150426577.png" class><p>åœ¨TCPå­˜åœ¨<a href="https://andersonlee09.github.io/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/#%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B">å››æ¬¡æŒ¥æ‰‹</a>çš„è¿‡ç¨‹ç»“æŸè¿æ¥ï¼Œä½†ä¸ºäº†é˜²æ­¢å‡ºç°å¼‚å¸¸ï¼Œä¸€æ–¹å¯ä»¥å‘é€RSTæ•°æ®å¼ºåˆ¶åˆ‡æ–­è¿æ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®©æ”»å‡»è€…å°è¯•ä¼ªé€ å„ç§IPåœ°å€ï¼Œå¹¶å‘é€RSTæ•°æ®è¿›è¡Œâ€œç›²æ‰“â€ï¼Œä¸€æ—¦IPå’ŒæŸäº›é…ç½®å’Œæ­£å¸¸ç”¨æˆ·è¾¾æˆåŒ¹é…ï¼Œé‚£å°±ä¼šåˆ‡æ–­æ­£å¸¸ç”¨æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ã€‚</p><h2 id="HTTPæ´ªæ°´æ”»å‡»"><a href="#HTTPæ´ªæ°´æ”»å‡»" class="headerlink" title="HTTPæ´ªæ°´æ”»å‡»"></a>HTTPæ´ªæ°´æ”»å‡»</h2><p>æ¯ä¸€æ¬¡è®¿é—®éƒ½æ˜¯å®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œçº¿è·¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨æŸ¥è¯¢æˆ–è®¡ç®—åå‘æœåŠ¡å™¨è¿”å›ç»“æœã€‚</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217151106457.png" class><p>æ¯”å¦‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç«™ç‚¹çš„æœç´¢åŠŸèƒ½ï¼Œä¸æ–­ç”Ÿæˆå¤§é‡å…³é”®è¯é€å…¥æŸ¥è¯¢åœ°å€ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åä¼šåœ¨æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢è¿™æ ·çš„IOæ“ä½œï¼Œè¿™æ ·çš„æ”»å‡»æ‰‹æ³•ä¼šå¯¹ç›®æ ‡äº§ç”Ÿæ›´å¤§çš„æ¶ˆè€—ã€‚</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217151331507.png" class><p>ä½†æ˜¯è¯¥æ–¹æ³•æœ‰ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ä¸èƒ½ä¼ªé€ IPï¼Œå› ä¸ºHTTPåŸºäºTCPåè®®ï¼Œå­˜åœ¨ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å€ŸåŠ©ç½‘ç»œä»£ç†æ–¹å¼å‘èµ·æ”»å‡»</p><h2 id="åº”å¯¹æ–¹æ³•"><a href="#åº”å¯¹æ–¹æ³•" class="headerlink" title="åº”å¯¹æ–¹æ³•"></a>åº”å¯¹æ–¹æ³•</h2><p>çœ‹å®Œä¸Šè¿°æ”»å‡»æ–¹æ³•æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œæ”»å‡»æ–¹æ³•å¤§éƒ½éœ€è¦ä¼ªé€ è‡ªå·±çš„IPåœ°å€</p><h3 id="ç½‘ç»œè®¾å¤‡è¿‡æ»¤"><a href="#ç½‘ç»œè®¾å¤‡è¿‡æ»¤" class="headerlink" title="ç½‘ç»œè®¾å¤‡è¿‡æ»¤"></a>ç½‘ç»œè®¾å¤‡è¿‡æ»¤</h3><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217155551573.png" class><p>è§£å†³ä¼ªé€ IPçš„æ–¹æ³•å¹¶ä¸å¤æ‚ï¼Œç”¨æˆ·è®¾å¤‡é€šè¿‡è·¯ç”±å™¨æ¥å…¥æœåŠ¡å•†ï¼Œé‚£å°±å¯ä»¥è®©è·¯ç”±è®¾å¤‡æ£€æµ‹IPï¼ŒæŠŠåŸåœ°å€IPä¸å±äºæœ¬è·¯ç”±æ‰€åœ¨ç½‘æ®µçš„æ•°æ®éƒ½è¿‡æ»¤æ‰</p><h3 id="åˆ†å¸ƒå¼è¿‡æ»¤"><a href="#åˆ†å¸ƒå¼è¿‡æ»¤" class="headerlink" title="åˆ†å¸ƒå¼è¿‡æ»¤"></a>åˆ†å¸ƒå¼è¿‡æ»¤</h3><p>ä¸€ä¸ªè®¾å¤‡IPå¯ä»¥é€ å‡ï¼Œä½†æ˜¯å®ƒç»è¿‡çš„çœŸå®è·¯å¾„å¯ä¸èƒ½é€ å‡ã€‚æ‰€ä»¥å¦‚æœè·¯ç”±èƒ½æ ¹æ®å…¶IPè·¯å¾„æ£€æµ‹å‡ºçŸ›ç›¾ï¼Œé‚£å°±è¿‡æ»¤è¿™æ ·çš„æµé‡ï¼Œè¯¥æ–¹æ³•æ¶‰åŠç½‘ç»œè®¾å¤‡æä¾›å•†ï¼ŒæœåŠ¡å•†å’Œç›‘ç®¡éƒ¨é—¨ç­‰ï¼Œæ‰€ä»¥å¾ˆéš¾è¢«è¾¾æˆ</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217155859088.png" class><h3 id="CDNæŠ€æœ¯"><a href="#CDNæŠ€æœ¯" class="headerlink" title="CDNæŠ€æœ¯"></a>CDNæŠ€æœ¯</h3><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217160244662.png" class><p>æŠŠä¸€äº›é™æ€èµ„æºä½œä¸ºç¼“å­˜åˆ†å‘ç»™å„ä¸ªCDNèŠ‚ç‚¹ï¼Œç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ä»æœ€è¿‘çš„èŠ‚ç‚¹è¿”å›ï¼Œå°±èƒ½ç¼“è§£DDoS.</p><h3 id="æµé‡æ¸…æ´—"><a href="#æµé‡æ¸…æ´—" class="headerlink" title="æµé‡æ¸…æ´—"></a>æµé‡æ¸…æ´—</h3><p>æˆ‘ä»¬åœ¨æœåŠ¡å™¨å‰æ¶è®¾ä¸€å¥—æµé‡æ¸…æ´—è®¾å¤‡ï¼Œæ¯”å¦‚SYNæ´ªæ°´æ”»å‡»ï¼Œå®¢æˆ·ç«¯å‘é€SYNæ•°æ®åŒ…ï¼Œç”±æ¸…æ´—è®¾å¤‡å‘é€SYN+ACKå›å¤</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217160648350.png" class><p>å¦‚æœåº”ç­”ï¼Œé‚£å¯¹æ–¹å°±æ˜¯æ­£å¸¸æµé‡ï¼Œæ¸…æ´—è®¾å¤‡å°±æŠŠæœ¬æ¬¡è¿æ¥äº¤ç»™æœåŠ¡å™¨æ­£å¸¸é€šä¿¡ã€‚</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217160708021.png" class><p>å¦‚æœä¸åº”ç­”é‚£å°±æ–­å¼€è¿æ¥ã€‚</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217160744466.png" class><p>è¾¾åˆ°ä»¥ä¸Šæ•ˆæœ</p><p>åˆæ¯”å¦‚åœ¨é¢å¯¹HTTPæ´ªæ°´çš„æ—¶å€™ï¼Œé€šè¿‡IPå¾ˆéš¾æ£€æµ‹ï¼Œé‚£å°±æŠŠè¯·æ±‚äº¤ç»™æµé‡æ¸…æ´—å¹³å°ï¼Œè¯¥å¹³å°ä¼šæœ‰ä¸€ä¸ªIPä¿¡ç”¨åº“ï¼Œå¯¹äºä¸€äº›è‡­åæ˜­è‘—çš„IPä¼šç›´æ¥è¿‡æ»¤ã€‚</p><img src="/2022/02/17/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E9%89%B4%E8%B5%8F/image-20220217160858625.png" class><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>DDoSä½œä¸ºä¸€ç§å†å²æ‚ ä¹…çš„æ”»å‡»æŠ€æœ¯ï¼Œä»Šæ—¥è¿˜ä¸èƒ½è¢«å½»åº•è§£å†³ï¼Œæ‰€ä»¥å¸Œæœ›å¤§å®¶ä¿æŒè­¦æƒ•ï¼Œåšå¥½é˜²æŠ¤ï¼</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¡ç®—æœºç½‘ç»œ</tag>
      
      <tag>HTTP</tag>
      
      <tag>TCP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åº”ç”¨å±‚è¯¦è§£</title>
    <link href="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E5%BA%94%E7%94%A8%E5%B1%82%E8%AF%A6%E8%A7%A3/"/>
    <url>/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E5%BA%94%E7%94%A8%E5%B1%82%E8%AF%A6%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="åº”ç”¨å±‚è¯¦è§£"><a href="#åº”ç”¨å±‚è¯¦è§£" class="headerlink" title="åº”ç”¨å±‚è¯¦è§£"></a>åº”ç”¨å±‚è¯¦è§£</h1><p>åº”ç”¨å±‚ä¸»è¦åè®®ä¸ºHTTPã€HTTPSã€FTPç­‰åè®®ï¼Œæœ¬æ–‡ä¸»è¦è®²è§£HTTPåè®®å†…å®¹</p><h2 id="HTTPçŠ¶æ€ç "><a href="#HTTPçŠ¶æ€ç " class="headerlink" title="HTTPçŠ¶æ€ç "></a>HTTPçŠ¶æ€ç </h2><img src="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E5%BA%94%E7%94%A8%E5%B1%82%E8%AF%A6%E8%A7%A3/image-20220216160216081.png" class><h3 id="301å’Œ302åŒºåˆ«"><a href="#301å’Œ302åŒºåˆ«" class="headerlink" title="301å’Œ302åŒºåˆ«"></a>301å’Œ302åŒºåˆ«</h3><ul><li>å…±åŒç‚¹</li></ul><p>301å’Œ302éƒ½æ˜¯é‡å®šå‘ï¼Œå³æµè§ˆå™¨æ‹¿åˆ°è¿™ä¸ªè¿”å›å€¼ä¼šé‡æ–°è¿›å…¥ä¸€ä¸ªURLï¼Œè¿™ä¸ªåœ°å€å¯ä»¥ä»å“åº”locationä¸­è·å–ã€‚</p><ul><li>ä¸åŒç‚¹</li></ul><p>301è¡¨ç¤ºæ°¸ä¹…æ€§é‡å®šå‘ï¼ˆè¯¥èµ„æºå·²ç»ä¸å¯è®¿é—®ï¼‰ï¼Œæœç´¢å¼•æ“åœ¨æŠ“å–æ–°å†…å®¹åŒæ—¶ä¹Ÿå°†æ—§ç½‘å€äº¤æ¢ä¸ºé‡å®šå‘åç½‘å€ã€‚</p><p>302è¡¨ç¤ºä¸´æ—¶é‡å®šå‘(è¯¥èµ„æºä»ç„¶å¯ä»¥è®¿é—®)ï¼Œè¯¥é‡å®šå‘æ˜¯ä¸´æ—¶ä»Aè½¬å‘Bï¼Œæœç´¢å¼•æ“ä¼šæŠ“å–æ–°å†…å®¹è€Œä¿å­˜æ—§çš„ç½‘å€</p><h2 id="HTTPè¯·æ±‚æ–¹æ³•"><a href="#HTTPè¯·æ±‚æ–¹æ³•" class="headerlink" title="HTTPè¯·æ±‚æ–¹æ³•"></a>HTTPè¯·æ±‚æ–¹æ³•</h2><p>GET\POST\PUT\DELETE\HEAD</p><h2 id="GETå’ŒPOSTåŒºåˆ«"><a href="#GETå’ŒPOSTåŒºåˆ«" class="headerlink" title="GETå’ŒPOSTåŒºåˆ«"></a>GETå’ŒPOSTåŒºåˆ«</h2><ul><li>GETä½¿ç”¨URL æˆ–COOKIEï¼Œè€ŒPOSTå°†æ•°æ®æ”¾äºbodyï¼Œæ‰€ä»¥postè¾ƒä¸ºå®‰å…¨</li><li>GETå‚æ•°æœ‰é•¿åº¦é™åˆ¶</li><li>æœ¬è´¨åŒºåˆ«ï¼šGETæ˜¯å¹‚ç­‰çš„ï¼ŒPOSTä¸æ˜¯</li></ul><p>å¹‚ç­‰æ˜¯æŒ‡ä¸€æ¬¡å’Œå¤šæ¬¡è¯·æ±‚æŸä¸€èµ„æºåº”è¯¥å…·æœ‰åŒæ ·çš„å‰¯ä½œç”¨ï¼Œå³åŒä¸€URLå¤šä¸ªè¯·æ±‚åº”æœ‰åŒä¸€ç»“æœ</p><h2 id="HTTPé•¿è¿æ¥å’ŒçŸ­è¿æ¥"><a href="#HTTPé•¿è¿æ¥å’ŒçŸ­è¿æ¥" class="headerlink" title="HTTPé•¿è¿æ¥å’ŒçŸ­è¿æ¥"></a>HTTPé•¿è¿æ¥å’ŒçŸ­è¿æ¥</h2><p>åœ¨HTTP&#x2F;1.0ä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯çŸ­è¿æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨æ¯è¿›è¡Œä¸€æ¬¡HTTPæ“ä½œï¼Œå°±å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œä½†ä»»åŠ¡ç»“æŸå°±ä¸­æ–­è¿æ¥ã€‚å¦‚æœå®¢æˆ·ç«¯æµè§ˆå™¨è®¿é—®çš„æŸä¸ªHTMLæˆ–å…¶ä»–ç±»å‹çš„ Webé¡µä¸­åŒ…å«æœ‰å…¶ä»–çš„Webèµ„æºï¼Œå¦‚JavaScriptæ–‡ä»¶ã€å›¾åƒæ–‡ä»¶ã€CSSæ–‡ä»¶ç­‰ï¼›å½“æµè§ˆå™¨æ¯é‡åˆ°è¿™æ ·ä¸€ä¸ªWebèµ„æºï¼Œå°±ä¼šå»ºç«‹ä¸€ä¸ªHTTPä¼šè¯ã€‚</p><p>ä½†ä» HTTP&#x2F;1.1èµ·ï¼Œé»˜è®¤ä½¿ç”¨é•¿è¿æ¥ï¼Œç”¨ä»¥ä¿æŒè¿æ¥ç‰¹æ€§ã€‚ä½¿ç”¨é•¿è¿æ¥çš„HTTPåè®®ï¼Œä¼šåœ¨å“åº”å¤´æœ‰åŠ å…¥è¿™è¡Œä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs c">Connection:keep-alive<br></code></pre></td></tr></table></figure><p>åœ¨ä½¿ç”¨é•¿è¿æ¥çš„æƒ…å†µä¸‹ï¼Œå½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“HTTPæ•°æ®çš„ TCPè¿æ¥ä¸ä¼šå…³é—­ï¼Œå¦‚æœå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„è¿æ¥ã€‚Keep-Aliveä¸ä¼šæ°¸ä¹…ä¿æŒè¿æ¥ï¼Œå®ƒæœ‰ä¸€ä¸ªä¿æŒæ—¶é—´ï¼Œå¯ä»¥åœ¨ä¸åŒçš„æœåŠ¡å™¨è½¯ä»¶ï¼ˆå¦‚Apacheï¼‰ä¸­è®¾å®šè¿™ä¸ªæ—¶é—´ã€‚å®ç°é•¿è¿æ¥è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ”¯æŒé•¿è¿æ¥ã€‚</p><p>HTTPåè®®çš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥ï¼Œå®è´¨ä¸Šæ˜¯TCPåè®®çš„é•¿è¿æ¥å’ŒçŸ­è¿æ¥ã€‚</p><h2 id="HTTPæ±‚è¯·æ±‚æŠ¥æ–‡æ ¼å¼"><a href="#HTTPæ±‚è¯·æ±‚æŠ¥æ–‡æ ¼å¼" class="headerlink" title="HTTPæ±‚è¯·æ±‚æŠ¥æ–‡æ ¼å¼"></a>HTTPæ±‚è¯·æ±‚æŠ¥æ–‡æ ¼å¼</h2><ol><li>è¯·æ±‚è¡Œ</li></ol><p>è¯·æ±‚è¡Œç”±è¯·æ±‚æ–¹æ³•å­—æ®µã€URLå­—æ®µå’ŒHTTPåè®®ç‰ˆæœ¬å­—æ®µ3ä¸ªå­—æ®µç»„æˆï¼Œå®ƒä»¬ç”¨ç©ºæ ¼åˆ†éš”ã€‚</p><p>æ¯”å¦‚ GET &#x2F;data&#x2F;info.html HTTP&#x2F;1.1</p><ol start="2"><li>è¯·æ±‚å¤´</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Accept</span>ï¼š æµè§ˆå™¨å¯æ¥å—çš„MIMEç±»å‹ã€‚<br><span class="hljs-attribute">Accept</span>-Encodingï¼šæµè§ˆå™¨èƒ½å¤Ÿè¿›è¡Œè§£ç çš„æ•°æ®ç¼–ç æ–¹å¼ï¼Œæ¯”å¦‚gzipã€‚Servletèƒ½å¤Ÿå‘æ”¯æŒgzipçš„æµè§ˆå™¨è¿”å›ç»gzipç¼–ç çš„HTMLé¡µé¢ã€‚è®¸å¤šæƒ…å½¢ä¸‹è¿™å¯ä»¥å‡å°‘<span class="hljs-number">5</span>åˆ°<span class="hljs-number">10</span>å€çš„ä¸‹è½½æ—¶é—´ã€‚<br><span class="hljs-attribute">Accept</span>-Languageï¼šæµè§ˆå™¨æ‰€å¸Œæœ›çš„è¯­è¨€ç§ç±»ï¼Œå½“æœåŠ¡å™¨èƒ½å¤Ÿæä¾›ä¸€ç§ä»¥ä¸Šçš„è¯­è¨€ç‰ˆæœ¬æ—¶è¦ç”¨åˆ°ã€‚<br><span class="hljs-attribute">Host</span>ï¼š å®¢æˆ·æœºé€šè¿‡è¿™ä¸ªå¤´å‘Šè¯‰æœåŠ¡å™¨ï¼Œæƒ³è®¿é—®çš„ä¸»æœºåã€‚HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span>è¯·æ±‚å¿…é¡»åŒ…å«ä¸»æœºå¤´åŸŸï¼Œå¦åˆ™ç³»ç»Ÿä¼šä»¥<span class="hljs-number">400</span>çŠ¶æ€ç è¿”å›ã€‚<br><span class="hljs-attribute">User</span>-Agentï¼šUser-Agentå¤´åŸŸçš„å†…å®¹åŒ…å«å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ä¿¡æ¯ã€‚æµè§ˆå™¨ç±»å‹ï¼Œå¦‚æœServletè¿”å›çš„å†…å®¹ä¸æµè§ˆå™¨ç±»å‹æœ‰å…³åˆ™è¯¥å€¼éå¸¸æœ‰ç”¨ã€‚<br><span class="hljs-attribute">Cookie</span>ï¼šå®¢æˆ·æœºé€šè¿‡è¿™ä¸ªå¤´å¯ä»¥å‘æœåŠ¡å™¨å¸¦æ•°æ®ï¼Œè¿™æ˜¯æœ€é‡è¦çš„è¯·æ±‚å¤´ä¿¡æ¯ä¹‹ä¸€ã€‚<br><span class="hljs-attribute">Connection</span>ï¼šå¤„ç†å®Œè¿™æ¬¡è¯·æ±‚åæ˜¯å¦æ–­å¼€è¿æ¥è¿˜æ˜¯ç»§ç»­ä¿æŒè¿æ¥ã€‚å¦‚æœServletçœ‹åˆ°è¿™é‡Œçš„å€¼ä¸ºâ€œKeep- Aliveâ€ï¼Œæˆ–è€…çœ‹åˆ°è¯·æ±‚ä½¿ç”¨çš„æ˜¯HTTP <span class="hljs-number">1</span>.<span class="hljs-number">1</span>(HTTP <span class="hljs-number">1</span>.<span class="hljs-number">1</span>é»˜è®¤è¿›è¡ŒæŒä¹…è¿æ¥)ï¼Œå®ƒå°±å¯ä»¥åˆ©ç”¨æŒä¹…è¿æ¥çš„ä¼˜ç‚¹ï¼Œ<br></code></pre></td></tr></table></figure><ol start="3"><li>è¯·æ±‚ä½“</li></ol><p>username&#x3D;xx&amp;pwd&#x3D;xx</p><h2 id="Cookie-amp-Session"><a href="#Cookie-amp-Session" class="headerlink" title="Cookie&amp;Session"></a>Cookie&amp;Session</h2><p><strong>1å­˜å‚¨ä½ç½®ä¸åŒ</strong></p><p>cookieçš„æ•°æ®ä¿¡æ¯å­˜æ”¾é€ å®¢æˆ·ç«¯æµè§ˆå™¨ä¸Š</p><p>sessionçš„æ•°æ®ä¿¡æ¯å­˜æ”¾åœ¨æœåŠ¡å™¨ä¸Š</p><p><strong>2å­˜å‚¨å®¹é‡ä¸åŒ</strong></p><p>å•ä¸ªcookieä¿å­˜çš„æ•°æ®&lt;&#x3D;4kb,ä¸€ä¸ªç«™ç‚¹æœ€å¤šä¿å­˜20ä¸ªcookie</p><p>å¯¹äºsessionæ¥è¯´å¹¶æ²¡æœ‰ä¸Šé™,ä½†æ˜¯å‡ºäºå¯¹æœåŠ¡ç«¯çš„æ€§èƒ½çš„è€ƒè™‘,sessionå†…ä¸è¦å­˜æ”¾è¿‡å¤šçš„ä¸œè¥¿,</p><p>å¹¶ä¸”è®¾ç½®sessionåˆ é™¤æœºåˆ¶</p><p><strong>3å­˜å‚¨æ–¹å¼ä¸åŒ</strong></p><p>cookieä¸­åªèƒ½ä¿ç®¡ASCIIå­—ç¬¦ä¸²,å¹¶éœ€è¦é€šè¿‡ç¼–ç æ–¹å¼å­˜å‚¨ä¸ºUnicodeå­—ç¬¦ä¸²æˆ–è€…äºŒè¿›åˆ¶æ•°æ®</p><p>sessionä¸­èƒ½å¤Ÿå­˜å‚¨ä»»ä½•ç±»å‹çš„æ•°æ® åŒ…æ‹¬ä½†ä¸é™äºstring,integer,list,mapç­‰</p><p><strong>4éšç§ç­–ç•¥ä¸åŒ</strong></p><p>cookieå¯¹å®¢æˆ·ç«¯æ˜¯å¯è§çš„,åˆ«æœ‰ç”¨å¿ƒçš„äººå¯ä»¥åˆ†æå­˜æ”¾åœ¨æœ¬åœ°çš„cookieå¹¶è¿›è¡Œcookieæ¬ºéª—,æ‰€ä»¥å®ƒæ˜¯ä¸å®‰å…¨çš„</p><p>sessionå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Š,å¯¹å®¢æˆ·ç«¯æ˜¯é€æ˜çš„,ä¸å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„éœ²çš„é£é™©</p><p><strong>5æœ‰æ•ˆæœŸä¸Šä¸åŒ</strong></p><p>å¼€å‘è€…å¯ä»¥é€šè¿‡è®¾ç½®cookieçš„å±æ€§,è¾¾åˆ°ä½¿cookieé•¿æœŸæœ‰æ•ˆçš„æ•ˆæœ</p><p>sessionä¾èµ–äºåä¸ºJSESSIONIDçš„cookie,è€Œcookie JSESSIONIDçš„è¿‡æœŸæ—¶é—´é»˜è®¤ä¸º-1,åªéœ€è¦å…³é—­çª—å£è¯¥sessionå°±ä¼šå¤±æ•ˆ,å› è€Œsessionä¸èƒ½è¾¾åˆ°é•¿æœŸæœ‰æˆçš„æ•ˆæœ</p><p><strong>6æœåŠ¡å™¨å‹åŠ›ä¸åŒ</strong></p><p>cookieä¿ç®¡åœ¨å®¢æˆ·ç«¯,ä¸å ç”¨æœåŠ¡å™¨çš„èµ„æº,å¯¹äºå¹¶å‘ç”¨æˆ·ååˆ†å¤šçš„ç½‘ç«™,cookieæ˜¯å¾ˆå¥½çš„é€‰æ‹©</p><p>sessionæ˜¯ä¿ç®¡åœ¨æœåŠ¡ç«¯çš„,æ¯ä¸ªç”¨æˆ·éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªsession,å‡å¦‚å¹¶å‘è®¿é—®çš„ç”¨æˆ·ååˆ†å¤š,ä¼šäº§ç”Ÿååˆ†å¤šçš„session,è€—è´¹å¤§é‡çš„å†…å­˜</p><p><strong>7æµè§ˆå™¨æ”¯æŒä¸åŒ</strong></p><p>å‡å¦‚å®¢æˆ·ç«¯æµè§ˆå™¨ä¸æ”¯æŒcookie</p><p>cookieæ˜¯éœ€è¦å®¢æˆ·ç«¯æµè§ˆå™¨æ”¯æŒçš„,å‡å¦‚å®¢æˆ·ç«¯ç¦ç”¨äº†cookie,æˆ–è€…ä¸æ”¯æŒcookie,åˆ™ä¼šè¯è·Ÿè¸ªä¼šå¤±æ•ˆ,å…³äºwapä¸Šçš„åº”ç”¨,å¸¸è§„çš„cookieå°±æ´¾ä¸ä¸Šç”¨åœºäº†</p><p>è¿ç”¨sessionéœ€è¦ä½¿ç”¨urlåœ°å€é‡å†™çš„æ–¹å¼,ä¸€åˆ‡ç”¨åˆ°sessionç¨‹åºçš„urléƒ½è¦è¿›è¡Œurlåœ°å€é‡å†™,</p><p>å¦åˆ™sessionä¼šè¯è·Ÿè¸ªè¿˜ä¼šå¤±æ•ˆ</p><p>å‡å¦‚å®¢æˆ·ç«¯æµè§ˆå™¨æ”¯æŒcookie</p><p>cookieæ—¢èƒ½å¤Ÿè®¾ä¸ºæœ¬æµè§ˆå™¨çª—å£ä»¥åŠå­çª—å£å†…æœ‰æ•ˆ,ä¹Ÿèƒ½å¤Ÿè®¾ä¸ºä¸€åˆ‡çª—å£å†…æœ‰æ•ˆ</p><p>sessionåªèƒ½åœ¨æœ¬çª—å£ä»¥åŠå­çª—å£å†…æœ‰æ•ˆ</p><p><strong>8è·¨åŸŸæ”¯æŒä¸Šä¸åŒ</strong></p><p>cookieæ”¯æŒè·¨åŸŸåè®¿é—®</p><p>sessionä¸æ”¯æŒè·¨åŸŸåè®¿é—®</p><h2 id="HTTP-amp-HTTPS"><a href="#HTTP-amp-HTTPS" class="headerlink" title="HTTP&amp;HTTPS"></a>HTTP&amp;HTTPS</h2><img src="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E5%BA%94%E7%94%A8%E5%B1%82%E8%AF%A6%E8%A7%A3/image-20220217133459104.png" class>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¡ç®—æœºç½‘ç»œ</tag>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¿è¾“å±‚è¯¦è§£</title>
    <link href="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/"/>
    <url>/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="è¿è¾“å±‚è¯¦è§£"><a href="#è¿è¾“å±‚è¯¦è§£" class="headerlink" title="è¿è¾“å±‚è¯¦è§£"></a>è¿è¾“å±‚è¯¦è§£</h1><p>ç»å†è¿‡é¢è¯•çš„å°ä¼™ä¼´åº”è¯¥æ˜ç™½ï¼šè®¡ç®—æœºç½‘ç»œæ˜¯é¢è¯•çš„é‡ç‚¹ï¼Œè€ŒTCPå’ŒUDPæ‰€åœ¨çš„è¿è¾“å±‚åˆ™æ˜¯é‡ä¸­ä¹‹é‡ï¼Œä¸‹é¢æˆ‘å°†è®²è§£è¿è¾“å±‚åŠŸèƒ½ï¼Œå¤§æ¦‚åŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ï¼šè¿è¾“å±‚åŠŸèƒ½ã€TCPä¸UDPåŒºåˆ«ã€æµé‡æ§åˆ¶ã€æ‹¥å¡é¿å…ã€ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹</p><h2 id="è¿è¾“å±‚åŠŸèƒ½"><a href="#è¿è¾“å±‚åŠŸèƒ½" class="headerlink" title="è¿è¾“å±‚åŠŸèƒ½"></a>è¿è¾“å±‚åŠŸèƒ½</h2><p>ç›´æ¥ä¸ºåº”ç”¨è¿›ç¨‹é—´é€»è¾‘é€šä¿¡æä¾›æœåŠ¡</p><h2 id="åº”ç”¨å±‚åŠŸèƒ½"><a href="#åº”ç”¨å±‚åŠŸèƒ½" class="headerlink" title="åº”ç”¨å±‚åŠŸèƒ½"></a>åº”ç”¨å±‚åŠŸèƒ½</h2><p>ä¸ºåº”ç”¨ç¨‹åºæä¾›äº¤äº’æœåŠ¡</p><h2 id="TCPæ ‡å¿—ä½åŠŸèƒ½"><a href="#TCPæ ‡å¿—ä½åŠŸèƒ½" class="headerlink" title="TCPæ ‡å¿—ä½åŠŸèƒ½"></a>TCPæ ‡å¿—ä½åŠŸèƒ½</h2><img src="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/image-20211112214123356.png" class><h2 id="ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹</h2><h3 id="æ¡æ‰‹è¿‡ç¨‹"><a href="#æ¡æ‰‹è¿‡ç¨‹" class="headerlink" title="æ¡æ‰‹è¿‡ç¨‹"></a>æ¡æ‰‹è¿‡ç¨‹</h3><p>ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><img src="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/image-20211112215032515.png" class><p>ä¸€ã€å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚SYN&#x3D;1 åŒæ—¶å‘é€è‡ªå·±åºåˆ—å·seq&#x3D;X ,</p><p>äºŒã€æœåŠ¡å™¨å›å¤ä¸€ä¸ªç¡®è®¤æŠ¥æ–‡ ACK&#x3D;1ï¼Œ ç¡®è®¤å·ä¸ºACKnum &#x3D; X+1 ä¸ºæœŸæœ›æ”¶åˆ°å¯¹æ–¹ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„æ•°æ®ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ï¼ŒåŒæ—¶å‘é€SYN&#x3D;1 è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¿æ¥æ¥å—çš„æŠ¥æ–‡ï¼Œ åŒæ—¶é™„å¸¦è‡ªå·±çš„åºåˆ—å·seq&#x3D;1.</p><p>ä¸‰ã€å®¢æˆ·ç«¯å‘é€ç¡®è®¤æŠ¥æ–‡ACK&#x3D;1 ACKnum&#x3D;Y+1</p><h3 id="ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡è€Œä¸æ˜¯ä¸¤æ¬¡"><a href="#ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡è€Œä¸æ˜¯ä¸¤æ¬¡" class="headerlink" title="ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡è€Œä¸æ˜¯ä¸¤æ¬¡"></a>ä¸ºä»€ä¹ˆæ˜¯ä¸‰æ¬¡è€Œä¸æ˜¯ä¸¤æ¬¡</h3><p>å‡å¦‚ç°åœ¨æ˜¯ä¸¤æ¬¡æ¡æ‰‹å°±å¯ä»¥å»ºç«‹è¿æ¥ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œç„¶åæœåŠ¡å™¨å‘å®¢æˆ·ç«¯å›å¤è¯·æ±‚ï¼Œè¿æ¥ç«‹åˆ»å»ºç«‹ã€‚</p><ul><li>é˜²æ­¢å·²ç»å¤±æ•ˆçš„è¯·æ±‚å†æ¬¡è¢«å»ºç«‹è¿æ¥</li></ul><p>å‡è®¾å½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¿æ¥1åï¼Œè¯¥è¿æ¥å› ä¸ºè·¯ç”±ä¸­è½¬çš„åŸå› è¿Ÿè¿Ÿä¸èƒ½åˆ°è¾¾ï¼Œå®¢æˆ·ç«¯åˆå‘å®¢æˆ·ç«¯å‘é€äº†ç¬¬äºŒæ¬¡è¿æ¥è¯·æ±‚2ï¼Œä¸”ä¼šè¯å¿«é€Ÿç»“æŸã€‚æ­¤æ—¶è¯·æ±‚è¿æ¥1æ‰å§—å§—æ¥è¿Ÿå¹¶å†æ¬¡ä¸æœåŠ¡å™¨å‘é€è¿æ¥ï¼Œä½†æ˜¯ç°åœ¨å®¢æˆ·ç«¯å·²ç»å…³é—­ï¼ŒæœåŠ¡ç«¯ä¾¿ä¼šä¸åœå‘é€ä»è€Œæµªè´¹èµ„æº</p><ul><li>ä¸èƒ½ç¡®è®¤åŒæ–¹æ¥æ”¶å’Œå‘é€èƒ½åŠ›éƒ½è‰¯å¥½</li></ul><p>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯ä»€ä¹ˆä¹Ÿä¸çŸ¥é“ï¼ŒæœåŠ¡å™¨çŸ¥é“è‡ªå·±å¯ä»¥æ¥æ”¶ï¼Œå¯¹æ–¹å¯ä»¥å‘é€</p><p>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯çŸ¥é“è‡ªå·±å¯ä»¥å‘é€å’Œæ¥æ”¶ï¼Œå¯¹æ–¹å¯ä»¥æ¥æ”¶å’Œå‘é€ã€æœåŠ¡ç«¯ä»€ä¹ˆä¹Ÿä¸çŸ¥é“</p><p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨çŸ¥é“è‡ªå·±å‘é€ï¼Œå¯¹æ–¹å¯ä»¥æ¥æ”¶</p><p>ç”±æ­¤å¯è§å°‘äº†ç¬¬ä¸‰æ­¥ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“å®Œæ•´ä¿¡æ¯</p><h2 id="å››æ¬¡æŒ¥æ‰‹"><a href="#å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="å››æ¬¡æŒ¥æ‰‹"></a>å››æ¬¡æŒ¥æ‰‹</h2><h3 id="æŒ¥æ‰‹è¿‡ç¨‹"><a href="#æŒ¥æ‰‹è¿‡ç¨‹" class="headerlink" title="æŒ¥æ‰‹è¿‡ç¨‹"></a>æŒ¥æ‰‹è¿‡ç¨‹</h3><img src="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/image-20220216150617179.png" class><p>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š</p><ol><li>å®¢æˆ·ç«¯è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼Œå¹¶ä¸”åœæ­¢å‘é€æ•°æ®ã€‚å…¶ä¸­FIN&#x3D;1ï¼Œé¡ºåºå·ä¸ºseq&#x3D;mï¼Œæ­¤æ—¶ï¼Œå®¢æˆ·ç«¯Clientè¿›å…¥FIN-WAIT-1ï¼ˆç»ˆæ­¢ç­‰å¾…1ï¼‰çŠ¶æ€ã€‚ TCPè§„å®šï¼ŒFINæŠ¥æ–‡æ®µå³ä½¿ä¸æºå¸¦æ•°æ®ï¼Œä¹Ÿè¦æ¶ˆè€—ä¸€ä¸ªåºå·ã€‚</li></ol><p>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š</p><ol start="2"><li><p>æœåŠ¡å™¨Serveræ”¶åˆ°è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼Œå‘å‡ºç¡®è®¤æŠ¥æ–‡ï¼ŒACK&#x3D;1ï¼Œack&#x3D;m+1ï¼Œå¹¶ä¸”å¸¦ä¸Šè‡ªå·±çš„é¡ºåºå·seq&#x3D;nï¼Œæ­¤æ—¶ï¼ŒæœåŠ¡å™¨Serverå°±è¿›å…¥äº†CLOSE-WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰çŠ¶æ€ã€‚TCPæœåŠ¡å™¨é€šçŸ¥é«˜å±‚çš„åº”ç”¨è¿›ç¨‹ï¼Œå®¢æˆ·ç«¯Clientå‘æœåŠ¡å™¨çš„æ–¹å‘å°±é‡Šæ”¾äº†ï¼Œè¿™æ—¶å€™å¤„äºåŠå…³é—­çŠ¶æ€ï¼Œå³å®¢æˆ·ç«¯Clientå·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä½†æ˜¯æœåŠ¡å™¨Serverè‹¥å‘é€æ•°æ®ï¼Œå®¢æˆ·ç«¯Clientä¾ç„¶è¦æ¥å—ã€‚è¿™ä¸ªçŠ¶æ€è¿˜è¦æŒç»­ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯æ•´ä¸ªCLOSE-WAITçŠ¶æ€æŒç»­çš„æ—¶é—´ã€‚</p></li><li><p>å®¢æˆ·ç«¯Clientæ”¶åˆ°æœåŠ¡å™¨Serverçš„ç¡®è®¤ä¿¡æ¯åï¼Œæ­¤æ—¶ï¼Œå®¢æˆ·ç«¯å°±è¿›å…¥FIN-WAIT-2ï¼ˆç»ˆæ­¢ç­‰å¾…2ï¼‰çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨Serverå‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼ˆåœ¨è¿™ä¹‹å‰è¿˜éœ€è¦æ¥å—æœåŠ¡å™¨Serverå‘é€çš„æœ€åçš„æ•°æ®ï¼‰ã€‚</p></li></ol><p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š</p><ol start="4"><li>æœåŠ¡å™¨Serverå°†æœ€åçš„æ•°æ®å‘é€å®Œæ¯•åï¼Œå°±å‘å®¢æˆ·ç«¯å‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡ï¼ŒFIN&#x3D;1ï¼Œack&#x3D;m+1ï¼Œç”±äºåœ¨åŠå…³é—­çŠ¶æ€ï¼ŒæœåŠ¡å™¨Serverå¾ˆå¯èƒ½åˆå‘é€äº†ä¸€äº›æ•°æ®ï¼Œå‡å®šæ­¤æ—¶çš„é¡ºåºå·ä¸ºseq&#x3D;pï¼Œæ­¤æ—¶ï¼ŒæœåŠ¡å™¨Serverå°±è¿›å…¥äº†LAST-ACKï¼ˆæœ€åç¡®è®¤ï¼‰çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·ç«¯Clientçš„ç¡®è®¤ã€‚</li></ol><p>ç¬¬å››æ¬¡æ¡æ‰‹ï¼š</p><ol start="5"><li>å®¢æˆ·ç«¯Clientæ”¶åˆ°æœåŠ¡å™¨Serverçš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡åï¼Œå¿…é¡»å‘å‡ºç¡®è®¤ï¼ŒACK&#x3D;1ï¼Œack&#x3D;p+1ï¼Œè€Œè‡ªå·±çš„é¡ºåºå·æ˜¯seq&#x3D;m+1ï¼Œæ­¤æ—¶ï¼Œå®¢æˆ·ç«¯Clientå°±è¿›å…¥äº†TIME-WAITï¼ˆæ—¶é—´ç­‰å¾…ï¼‰çŠ¶æ€ã€‚<strong>æ³¨æ„æ­¤æ—¶TCPè¿æ¥è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œå¿…é¡»ç»è¿‡2*MSLï¼ˆæœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½ï¼‰çš„æ—¶é—´åï¼Œå½“å®¢æˆ·ç«¯Clientæ’¤é”€ç›¸åº”çš„TCBï¼ˆä¿æŠ¤ç¨‹åºï¼‰åï¼Œæ‰è¿›å…¥CLOSEDçŠ¶æ€ã€‚</strong></li><li>æœåŠ¡å™¨Serveråªè¦æ”¶åˆ°äº†å®¢æˆ·ç«¯Clientå‘å‡ºçš„ç¡®è®¤ï¼Œç«‹å³è¿›å…¥CLOSEDçŠ¶æ€ã€‚åŒæ ·ï¼Œæ’¤é”€TCBåï¼Œå°±ç»“æŸäº†è¿™æ¬¡çš„TCPè¿æ¥ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å™¨Serverç»“æŸTCPè¿æ¥çš„æ—¶é—´è¦æ¯”å®¢æˆ·ç«¯Clientæ—©ä¸€äº›ã€‚</li></ol><h3 id="ä¸ºä»€ä¹ˆTIME-WAITçŠ¶æ€éœ€è¦ç»è¿‡2MSL-æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´-æ‰èƒ½è¿”å›åˆ°CLOSEçŠ¶æ€ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆTIME-WAITçŠ¶æ€éœ€è¦ç»è¿‡2MSL-æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´-æ‰èƒ½è¿”å›åˆ°CLOSEçŠ¶æ€ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆTIME_WAITçŠ¶æ€éœ€è¦ç»è¿‡2MSL(æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´)æ‰èƒ½è¿”å›åˆ°CLOSEçŠ¶æ€ï¼Ÿ"></a>ä¸ºä»€ä¹ˆTIME_WAITçŠ¶æ€éœ€è¦ç»è¿‡2MSL(æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´)æ‰èƒ½è¿”å›åˆ°CLOSEçŠ¶æ€ï¼Ÿ</h3><p>æŒ‰ç…§å‰é¢æ‰€è¯´ï¼Œå½“å››ä¸ªæŠ¥æ–‡å…¨éƒ¨å‘é€å®Œæ¯•åï¼Œç†è®ºä¸Šå°±ç®—æ˜¯ç»“æŸäº†ã€‚ä½†æ˜¯å®é™…æƒ…å†µå¾€å¾€ä¸ä¼šé‚£ä¹ˆå¯é ï¼Œæ¯”å¦‚æœ€åä¸€æ¡æŠ¥æ–‡å‘å‡ºåä¸¢å¤±äº†ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç«¯å°±ä¸ä¼šæ¥æ”¶åˆ°è¿™ä¸€æŠ¥æ–‡ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´ï¼ŒæœåŠ¡å™¨ç«¯ä¼šå†æ¬¡å‘å‡ºFINæŠ¥æ–‡ï¼Œæ­¤æ—¶å¦‚æœå®¢æˆ·ç«¯å·²ç»æ–­å¼€äº†ï¼Œé‚£ä¹ˆå°±æ— æ³•å“åº”æœåŠ¡å™¨çš„äºŒæ¬¡è¯·æ±‚ï¼Œè¿™æ ·æœåŠ¡å™¨ä¼šç»§ç»­å‘å‡ºFINæŠ¥æ–‡ï¼Œä»è€Œå˜æˆäº†æ­»å¾ªç¯ã€‚æ‰€ä»¥éœ€è¦è®¾ç½®ä¸€ä¸ªæ—¶é—´æ®µï¼Œå¦‚æœåœ¨è¿™ä¸ªæ—¶é—´æ®µå†…æ¥æ”¶åˆ°äº†æœåŠ¡å™¨ç«¯çš„å†æ¬¡è¯·æ±‚ï¼Œåˆ™ä»£è¡¨å®¢æˆ·ç«¯å‘å‡ºçš„ACKæŠ¥æ–‡æ²¡æœ‰æ¥æ”¶æˆåŠŸã€‚åä¹‹ï¼Œåˆ™ä»£è¡¨æœåŠ¡å™¨ç«¯æˆåŠŸæ¥æ”¶å“åº”æŠ¥æ–‡ï¼Œå®¢æˆ·ç«¯è¿›å…¥CLOSEDçŠ¶æ€ï¼Œæ­¤æ¬¡è¿æ¥æˆåŠŸå…³é—­ã€‚è€Œè¿™ä¸ªæ—¶é—´ï¼Œå°±è§„å®šä¸ºäº†2MSLï¼Œå³å®¢æˆ·ç«¯å‘å‡ºACKæŠ¥æ–‡åˆ°æœåŠ¡å™¨ç«¯çš„æœ€å¤§æ—¶é—´ + æœåŠ¡å™¨æ²¡æœ‰æ¥æ”¶åˆ°ACKæŠ¥æ–‡å†æ¬¡å‘å‡ºFINçš„æœ€å¤§æ—¶é—´ &#x3D; 2MSL</p><h2 id="æ‹¥å¡æ§åˆ¶"><a href="#æ‹¥å¡æ§åˆ¶" class="headerlink" title="æ‹¥å¡æ§åˆ¶"></a>æ‹¥å¡æ§åˆ¶</h2><p>å‘é€æ–¹ç»´æŒä¸€ä¸ªæ‹¥å¡çª—å£cwndï¼Œå–å†³äºå…¶ç½‘ç»œæ‹¥å¡ç¨‹åº¦ï¼ŒåŠ¨æ€å˜åŒ–</p><img src="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/image-20220216152258882.png" class><ul><li>æ…¢å¼€å§‹</li></ul><p>ä¸ç”¨ä¸€å¼€å§‹é€Ÿåº¦å°±å¾ˆå¿«ï¼Œç”±å°åˆ°å¤§é€æ¸å¢å¤§ï¼Œä¸”ä¸ºæŒ‡æ•°å¢é•¿1ï¼š1-&gt;2-&gt;4-&gt;8â€¦</p><ul><li>æ‹¥å¡é¿å…</li></ul><p>å½“cwnd&lt;ssthresh(æ…¢å¼€å§‹é—¨é™)ï¼Œæ‹¥å¡çª—å£ç¼“æ…¢å¢é•¿ï¼Œæ¯æ¬¡ä¸€ä¸ªå¾€è¿”å°±+1, 16-&gt;17-&gt;18â€¦ </p><ul><li>å¿«é‡ä¼ </li></ul><img src="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/image-20220216153625395.png" class><p>å‰”é™¤ä¸€äº›ä¸å¿…è¦çš„æ‹¥å¡æŠ¥æ–‡ï¼Œåœ¨æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±<strong>é‡å¤</strong>ç¡®è®¤ï¼Œè€Œä¸æ˜¯ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æå¸¦ç¡®è®¤ã€‚</p><p>å‘é€æ”¾åªè¦è¿ç»­æ”¶åˆ°ä¸‰ä¸ªç¡®è®¤ï¼Œå°±åº”è¯¥ç«‹åˆ»é‡ä¼ å¯¹æ–¹æœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µï¼Œè¿™æ ·å°±ä¸å¿…è®¾ç½®é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸ</p><ul><li>å¿«æ¢å¤</li></ul><p>å½“å¿«é‡ä¼ å‘ç”Ÿæ—¶ï¼Œä»£è¡¨å‘é€çª—å£è¿‡å¤§ï¼Œæ­¤æ—¶è¦æŠŠssthresh(æ…¢å¼€å§‹é—¨é™)å‡åŠï¼Œä½†å¹¶ä¸è¿›è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œå› ä¸ºå·²ç»æ”¶åˆ°è¿ç»­ä¸‰ä¸ªå›å¤ç¡®è®¤è¡¨ç¤ºç½‘ç»œè¿˜è¡Œ~</p><h2 id="TCPå’ŒUDPåŒºåˆ«"><a href="#TCPå’ŒUDPåŒºåˆ«" class="headerlink" title="TCPå’ŒUDPåŒºåˆ«"></a>TCPå’ŒUDPåŒºåˆ«</h2><img src="/2022/02/16/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%BF%90%E8%BE%93%E5%B1%82%E8%AF%A6%E8%A7%A3/image-20220216154131025.png" class>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¡ç®—æœºç½‘ç»œ</tag>
      
      <tag>TCP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LinuxåŸºç¡€å‘½ä»¤</title>
    <link href="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/"/>
    <url>/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><h2 id="ç”¨æˆ·ç®¡ç†"><a href="#ç”¨æˆ·ç®¡ç†" class="headerlink" title="ç”¨æˆ·ç®¡ç†"></a>ç”¨æˆ·ç®¡ç†</h2><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20210719144052490.png" class><h3 id="ç”¨æˆ·ç»„"><a href="#ç”¨æˆ·ç»„" class="headerlink" title="ç”¨æˆ·ç»„"></a>ç”¨æˆ·ç»„</h3><h4 id="åˆ›å»ºç”¨æˆ·ç»„"><a href="#åˆ›å»ºç”¨æˆ·ç»„" class="headerlink" title="åˆ›å»ºç”¨æˆ·ç»„"></a>åˆ›å»ºç”¨æˆ·ç»„</h4><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20210719144844491.png" class><h4 id="ç®¡ç†ç»„å†…æˆå‘˜"><a href="#ç®¡ç†ç»„å†…æˆå‘˜" class="headerlink" title="ç®¡ç†ç»„å†…æˆå‘˜"></a>ç®¡ç†ç»„å†…æˆå‘˜</h4><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20210719145010114.png" class><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20210719145324771.png" class><h3 id="æ—¥æœŸç®¡ç†"><a href="#æ—¥æœŸç®¡ç†" class="headerlink" title="æ—¥æœŸç®¡ç†"></a>æ—¥æœŸç®¡ç†</h3><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20210719145405647.png" class><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105131210111.png" class><p>chgrp andersonlee tmp</p><p>ç»™tmpæ–‡ä»¶ä¿®æ”¹ç”¨æˆ·ç»„ä¸ºandersonlee</p><p>chown æ–‡ä»¶æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„ä¸¤ä¸ªä¸€èµ·è®¾ç½®</p><h3 id="sudo"><a href="#sudo" class="headerlink" title="sudo"></a>sudo</h3><p>æé«˜å½“å‰ç”¨æˆ·æƒé™æ¥æ‰§è¡Œåé¢çš„è¯­å¥</p><p>ps&amp;topæŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯</p><p>kill id æ€æ­»è¿›ç¨‹</p><p>æ€ä¸æ­»åˆ™ä½¿ç”¨  kill -9 id</p><p>shutdown -h nowç«‹åˆ»å…³æœº</p><h3 id="ä¿®æ”¹æƒé™"><a href="#ä¿®æ”¹æƒé™" class="headerlink" title="ä¿®æ”¹æƒé™"></a>ä¿®æ”¹æƒé™</h3><p>chmod 777 filename</p><p>chmodä¿®æ”¹æƒé™</p><p>user -&gt; u å±ä¸»æƒé™</p><p>group -&gt; g å±ç»„æƒé™</p><p>others -&gt; o å…¶ä»–æƒé™</p><p>all -&gt;a  å…¨éƒ¨æƒé™</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105133300795.png" class><p>Rå³ä¸ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105133350825.png" class><p><strong>stat</strong> æŸ¥çœ‹æ–‡ä»¶å±æ€§</p><p>pwd æŸ¥çœ‹æ–‡ä»¶è·¯å¾„</p><h3 id="ç¼–è¾‘æ–‡æœ¬"><a href="#ç¼–è¾‘æ–‡æœ¬" class="headerlink" title="ç¼–è¾‘æ–‡æœ¬"></a>ç¼–è¾‘æ–‡æœ¬</h3><h4 id="vim"><a href="#vim" class="headerlink" title="vim"></a>vim</h4><p>i -&gt; insert  å½“å‰å­—ç¬¦æ’å…¥</p><p>l -&gt; insert  é¦–è¡Œæ’å…¥</p><p>a -&gt; append   å½“å‰å­—ç¬¦åæ·»åŠ </p><p>A -&gt; append  è¡Œæœ«å°¾æ·»åŠ </p><p>o -&gt;  å½“å‰è¡Œåæ’ä¸€ç©ºè¡Œ</p><p>O -&gt;  å½“å‰è¡Œå‰æ’å…¥ç©ºè¡Œ</p><p>å†™å®ŒESC</p><p>:q  vimè¿›å…¥æ–‡ä»¶æ²¡æœ‰å¯¹æ–‡ä»¶åšä»»ä½•æ“ä½œ å¯ä»¥æŒ‰q</p><p>:q!  æœ‰æ“ä½œä½†ä¸æƒ³é€€å‡ºä¿å­˜</p><p>:wq  æ­£å¸¸é€€å‡ºä¿å­˜</p><p>:wq!  å¼ºåˆ¶ä¿å­˜é€€å‡º</p><p>:set nuæ˜¾ç¤ºè¡Œ</p><p>cat +æ–‡ä»¶å æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><p>cat -n +æ–‡ä»¶å æŸ¥çœ‹æ–‡ä»¶å†…å®¹ åŠ è¡Œå·</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105163119757.png" class><p>less  æŸ¥çœ‹å¤§æ–‡ä»¶ qé€€å‡º</p><p>grep æŸ¥æ‰¾å†…å®¹</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105165025046.png" class><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105165121746.png" class><p>-n  æ˜¾ç¤ºè¡Œæ•°</p><p>-i  ä¸åŒºåˆ†å¤§å°å†™</p><p>-v  ä¸å«æœ‰çš„</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105165451279.png" class><p>æŸ¥çœ‹åå­—é‡Œæœ‰sshdçš„è¿›ç¨‹</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105165820814.png" class><p>å®šä½åˆ°å…·ä½“è¡Œæ•°</p><h4 id="è¿›ç¨‹"><a href="#è¿›ç¨‹" class="headerlink" title="è¿›ç¨‹"></a>è¿›ç¨‹</h4><p>ps</p><p>ps -ef æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹</p><h3 id="è½¯è¿æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰"><a href="#è½¯è¿æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰" class="headerlink" title="è½¯è¿æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰"></a>è½¯è¿æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰</h3><p>ln -s åŸè·¯å¾„  æ–°è·¯å¾„</p><h3 id="æŸ¥æ‰¾"><a href="#æŸ¥æ‰¾" class="headerlink" title="æŸ¥æ‰¾"></a>æŸ¥æ‰¾</h3><p>find</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105180928459.png" class><h3 id="å‹ç¼©"><a href="#å‹ç¼©" class="headerlink" title="å‹ç¼©"></a>å‹ç¼©</h3><p>gzip *   å‹ç¼©</p><p>gunzip  filename   è§£å‹æ–‡ä»¶</p><p>zip</p><p>-q : ä¸æ˜¾ç¤ºæ‰§è¡Œè¿‡ç¨‹   -r : é€’å½’å¤„ç† å¯¹è¯¥ç›®å½•ä¸‹çš„å­ç›®å½•ä¸€èµ·å¤„ç†</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105182234465.png" class><p>unzip -l filename.zip æŸ¥çœ‹å‹ç¼©æ–‡ä»¶å†…å®¹</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105182338320.png" class><p>unzip -d ccc aaa.zip  è§£å‹</p><h3 id="ç½‘ç»œç®¡ç†"><a href="#ç½‘ç»œç®¡ç†" class="headerlink" title="ç½‘ç»œç®¡ç†"></a>ç½‘ç»œç®¡ç†</h3><p>ifconfig  æŸ¥çœ‹ç½‘ç»œ</p><p>ping <a href="http://www.baidu.com/">www.baidu.com</a>  å‘ç½‘å€å‘é€åŒ…</p><p>ping -c 2 <a href="http://www.baidu.com/">www.baidu.com</a>  åªå‘ç”Ÿä¸¤æ¬¡åŒ…</p><p>netstat  æ˜¾ç¤ºç½‘ç»œçŠ¶æ€  -a æ˜¾ç¤ºæ‰€æœ‰è¿çº¿ä¸­çš„socket    -iæ˜¾ç¤ºç½‘å¡åˆ—è¡¨</p><h3 id="yumä¸‹è½½è½¯ä»¶"><a href="#yumä¸‹è½½è½¯ä»¶" class="headerlink" title="yumä¸‹è½½è½¯ä»¶"></a>yumä¸‹è½½è½¯ä»¶</h3><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105183711457.png" class><p>-yè¡¨ç¤ºé‡åˆ°é€‰æ‹©å°±é€‰yes</p><p>åˆ é™¤</p><img src="/2022/02/15/Linux/Linux%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/image-20211105183819413.png" class>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonè‡ªåŠ¨åŒ–è§£å†³Hexoå›¾ç‰‡å¼•ç”¨è·¯å¾„é—®é¢˜</title>
    <link href="/2022/02/14/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/Python%E8%87%AA%E5%8A%A8%E5%8C%96%E8%A7%A3%E5%86%B3Hexo%E5%9B%BE%E7%89%87%E5%BC%95%E7%94%A8%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/"/>
    <url>/2022/02/14/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/Python%E8%87%AA%E5%8A%A8%E5%8C%96%E8%A7%A3%E5%86%B3Hexo%E5%9B%BE%E7%89%87%E5%BC%95%E7%94%A8%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="Pythonè‡ªåŠ¨åŒ–è§£å†³Hexoå›¾ç‰‡å¼•ç”¨è·¯å¾„é—®é¢˜"><a href="#Pythonè‡ªåŠ¨åŒ–è§£å†³Hexoå›¾ç‰‡å¼•ç”¨è·¯å¾„é—®é¢˜" class="headerlink" title="Pythonè‡ªåŠ¨åŒ–è§£å†³Hexoå›¾ç‰‡å¼•ç”¨è·¯å¾„é—®é¢˜"></a>Pythonè‡ªåŠ¨åŒ–è§£å†³Hexoå›¾ç‰‡å¼•ç”¨è·¯å¾„é—®é¢˜</h1><h2 id="å‰å› "><a href="#å‰å› " class="headerlink" title="å‰å› "></a>å‰å› </h2><p>çœ‹è¿‡æˆ‘ç¬¬äºŒç¯‡Blogçš„å°ä¼™ä¼´åº”è¯¥çŸ¥é“ï¼Œåœ¨typoraçš„å›¾ç‰‡å¼•ç”¨å’Œhexoå­˜åœ¨ä¸€å®šå·®åˆ«ï¼Œå…·ä½“ä¸ºï¼š</p><img src="/2022/02/14/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/Python%E8%87%AA%E5%8A%A8%E5%8C%96%E8%A7%A3%E5%86%B3Hexo%E5%9B%BE%E7%89%87%E5%BC%95%E7%94%A8%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/image-20220214124532420.png" class><p>å¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€å®šå·®è·ï¼Œæˆ‘æ˜¨å¤©ä¸€ç›´å°†åŸè·¯å¾„é‡Œçš„å›¾ç‰‡æ”¾è‡³blogé¡¹ç›®ä¸‹åŒåç›®å½•ä¸­ï¼Œç„¶åä¿®æ”¹markdownæ–‡ä»¶é‡Œå›¾ç‰‡åç§°ï¼Œè™½ç„¶æ“ä½œéš¾åº¦ä¸å¤§ï¼Œä½†æœ‰æ—¶å€™ä¸€ç¯‡æ–‡ç« å¯èƒ½å­˜åœ¨å‡ åå¼ å›¾ç‰‡ï¼Œè¿™æ ·å­ä»»åŠ¡ç¹å¤šï¼Œä¸”å®¹æ˜“å‡ºé”™ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥åˆ©ç”¨<strong>pythonè‡ªåŠ¨åŒ–</strong>å®Œæˆè¿™äº›äº‹æƒ…å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼</p><h2 id="åˆ†æè¿‡ç¨‹"><a href="#åˆ†æè¿‡ç¨‹" class="headerlink" title="åˆ†æè¿‡ç¨‹"></a>åˆ†æè¿‡ç¨‹</h2><p>æˆ‘å¤§ä½“æ€è·¯å¦‚ä¸‹ï¼š</p><ol><li><p>é¦–å…ˆé€è¡Œè¯»å–mdæ–‡ä»¶ï¼Œå¦‚æœå‘ç°è¯¥è¡Œå­˜åœ¨æ ¹ç›®å½•ï¼šCï¼šUser\xxxxxxxxxxxxxx,åˆ™è¯¥è¡Œä¸ºå›¾ç‰‡æ‰€åœ¨è¡Œ</p></li><li><p>å°†å›¾ç‰‡åç§°å­˜ä¸‹æ¥ï¼Œå°†è¯¥è¡Œå˜æ¢ä¸ºå¯è¯†åˆ«å¼•ç”¨é‡æ–°å†™å…¥å‰¯æœ¬é‡Œï¼Œå°†å›¾ç‰‡ä»è€æ–‡ä»¶é‡Œå­˜å…¥æ–°æ–‡ä»¶å¤¹ï¼ˆä½¿ç”¨PILåº“ï¼‰</p></li><li><p>æœ€åå°†è€mdæ–‡ä»¶æ”¾å…¥final_urlæ–‡ä»¶å¤¹ä¸­æ–¹ä¾¿ä»¥åæœ¬åœ°æŸ¥çœ‹ï¼Œå‰¯æœ¬æ–‡ä»¶ä¿®æ”¹åç§°å³å¯ã€‚</p></li></ol><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></div></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> shutil<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">r ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚æ–‡ä»¶çš„æŒ‡é’ˆä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">w ä»¥å†™å…¥æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚æ–‡ä»¶å­˜åœ¨è¦†ç›–æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸å­˜åœ¨åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">a ä»¥è¿½åŠ æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆæ”¾åœ¨æ–‡ä»¶æœ«å°¾ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶å¹¶å¯å†™å…¥ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">r+ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚æ–‡ä»¶æŒ‡é’ˆä¼šæ”¾åœ¨æ–‡ä»¶çš„å¼€å¤´</span><br><span class="hljs-string"></span><br><span class="hljs-string">w+ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚æ–‡ä»¶å­˜åœ¨è¦†ç›–æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸å­˜åœ¨åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">a+ æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¯»å†™ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œæ–‡ä»¶æŒ‡é’ˆæ”¾åœ¨æ–‡ä»¶æœ«å°¾ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶å¹¶å¯å†™å…¥ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">è®°å¿†æ–¹æ³•ï¼šè®°ä½rè¯»ï¼Œwå†™ï¼Œaè¿½åŠ ï¼Œæ¯ä¸ªæ¨¡å¼ååŠ å…¥+å·å°±å˜æˆå¯è¯»å†™</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-comment"># typora è‡ªåŠ¨å­˜å‚¨å›¾ç‰‡æ‰€åœ¨ç›®å½•</span><br>old_url = <span class="hljs-string">&#x27;C:\\Users\æç‘èˆª\AppData\Roaming\Typora\\typora-user-images\\&#x27;</span><br><span class="hljs-comment"># blog markdownæ‰€åœ¨ç›®å½•</span><br>new_url = <span class="hljs-string">&#x27;D:\\Users\\blog\source\_posts\\&#x27;</span><br><span class="hljs-comment"># æœ€åæƒ³å­˜å‚¨åŸmarkdownç›®å½•</span><br>final_url = <span class="hljs-string">&#x27;D:\\Users\\blog\\markdown\\&#x27;</span><br><span class="hljs-comment"># æ–‡ä»¶åç§°</span><br>filename = <span class="hljs-string">&#x27;linux&#x27;</span><br><br><br><span class="hljs-comment"># å¤„ç†æ–‡ä»¶</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_file</span>(<span class="hljs-params">title</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    process .md or .txt format file</span><br><span class="hljs-string">    :param file: .md or .txt format file</span><br><span class="hljs-string">    :return: null</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-comment"># å¦‚æœè¿˜æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å¤¹å°±åˆ›å»ºè¿™ä¸ªæ–‡ä»¶å¤¹</span><br>    <span class="hljs-keyword">if</span> title + <span class="hljs-string">&#x27;.md&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> os.listdir(new_url):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æœªæ‰¾åˆ°è¯¥markdownæ–‡ä»¶ï¼&#x27;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">if</span> title <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> os.listdir(new_url):<br>        os.mkdir(new_url + title)<br>    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ªå‰¯æœ¬è®°å½•æœ€æ–°å¤„ç†å¥½çš„å›¾ç‰‡è·¯å¾„</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;new_url&#125;</span><span class="hljs-subst">&#123;title&#125;</span>_.md&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;new_url&#125;</span><span class="hljs-subst">&#123;title&#125;</span>.md&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>):<br>            <span class="hljs-keyword">if</span> old_url <span class="hljs-keyword">in</span> line:<br>                pic_name = line.split(old_url)[-<span class="hljs-number">1</span>][:-<span class="hljs-number">2</span>]<br>                process_pic(pic_name, title)<br>                f.write(<span class="hljs-string">&#x27;&#123;% asset_img &#x27;</span> + pic_name + <span class="hljs-string">&#x27; %&#125;\n&#x27;</span>)<br>            <span class="hljs-keyword">else</span>:<br>                f.write(line)<br>    <span class="hljs-comment"># ç§»åŠ¨è€çš„md</span><br>    shutil.move(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;new_url&#125;</span><span class="hljs-subst">&#123;title&#125;</span>.md&#x27;</span>, <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;final_url&#125;</span><span class="hljs-subst">&#123;title&#125;</span>.md&#x27;</span>)<br>    <span class="hljs-comment"># å°†æ–°çš„mdå‘½åä¸ºè€çš„md</span><br>    os.rename(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;new_url&#125;</span><span class="hljs-subst">&#123;title&#125;</span>_.md&#x27;</span>, <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;new_url&#125;</span><span class="hljs-subst">&#123;title&#125;</span>.md&#x27;</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_pic</span>(<span class="hljs-params">pic_name, title</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        remove picture</span><br><span class="hljs-string">        :param pic_name: ome picture name</span><br><span class="hljs-string">        :return: null</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    I = Image.<span class="hljs-built_in">open</span>(old_url + pic_name)<br>    I.save(new_url + title + <span class="hljs-string">&#x27;/&#x27;</span> + pic_name)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    <span class="hljs-comment"># æ¥æ”¶æ¥è‡ªcmdçš„å‚æ•°</span><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;å°è¯•å¤„ç† <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">1</span>]&#125;</span>&#x27;</span>)<br>        process_file(sys.argv[<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">except</span> IndexError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æœªæ‰¾åˆ°è¯¥æ ‡é¢˜æ‰€åœ¨ç›®å½•ï¼Œå·²ç»è‡ªé€‚åº”æ ‡é¢˜~&#x27;</span>)<br>        <span class="hljs-keyword">if</span> filename == <span class="hljs-string">&#x27;&#x27;</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;æ–‡ä»¶åä¸ºç©ºï¼&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            process_file(filename)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;è¿è¡Œç»“æŸ&#x27;</span>)<br><br><br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨è¯´æ˜"><a href="#ä½¿ç”¨è¯´æ˜" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h2><h3 id="ç¬¬ä¸‰æ–¹åº“"><a href="#ç¬¬ä¸‰æ–¹åº“" class="headerlink" title="ç¬¬ä¸‰æ–¹åº“"></a>ç¬¬ä¸‰æ–¹åº“</h3><p>æœ¬è„šæœ¬æ‰€ç”¨pythonç¬¬ä¸‰æ–¹åº“å‡ä¸ºå†…ç½®åº“ï¼Œæ— éœ€ä¸‹è½½ã€‚</p><h3 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><p>old_url: å³ä¸ºtyporaå­˜å‚¨å›¾ç‰‡çš„è·¯å¾„</p><p>new_url: å³ä¸ºhexoé¡¹ç›®markdownæ–‡ä»¶æ‰€åœ¨è·¯å¾„</p><p>final_url: æœ€åæƒ³å­˜å‚¨åŸmarkdownç›®å½•</p><p>title: æƒ³è¦å¤„ç†çš„markdownåç§°ï¼ˆé€‰å¡«ï¼Œä¸å¡«åˆ™ä¸ºç©ºï¼‰</p><h3 id="è¿è¡Œæ–¹æ³•"><a href="#è¿è¡Œæ–¹æ³•" class="headerlink" title="è¿è¡Œæ–¹æ³•"></a>è¿è¡Œæ–¹æ³•</h3><ul><li>è„šæœ¬è¿è¡Œï¼ˆæ¨èï¼‰</li></ul><p>å› ä¸ºé¡¹ç›®ä½¿ç”¨äº†sysåº“ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å‘½ä»¤è¡Œç›´æ¥å¯åŠ¨ï¼Œå…·ä½“ä¸ºï¼š</p><p>python xx.py filename.md</p><p>xxä¸ºè¯¥python æ–‡ä»¶åç§°ï¼Œfilenameä¸ºmarkdownæ–‡ä»¶åç§°, ä¸ç”¨åŠ å¼•å·</p><ul><li>ç›´æ¥è¿è¡Œ</li></ul><p>ç›´æ¥ä¿®æ”¹æ–‡ä»¶é‡Œfilenameå³å¯</p><h2 id="ç»“æœæ¬£èµ"><a href="#ç»“æœæ¬£èµ" class="headerlink" title="ç»“æœæ¬£èµ"></a>ç»“æœæ¬£èµ</h2><p>å¤„ç†å‰ï¼š</p><img src="/2022/02/14/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/Python%E8%87%AA%E5%8A%A8%E5%8C%96%E8%A7%A3%E5%86%B3Hexo%E5%9B%BE%E7%89%87%E5%BC%95%E7%94%A8%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/image-20220214115422400.png" class><p>å¤„ç†ä¸­ï¼š</p><img src="/2022/02/14/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/Python%E8%87%AA%E5%8A%A8%E5%8C%96%E8%A7%A3%E5%86%B3Hexo%E5%9B%BE%E7%89%87%E5%BC%95%E7%94%A8%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/image-20220214122757715.png" class><p>å¤„ç†åï¼š</p><img src="/2022/02/14/%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/Python%E8%87%AA%E5%8A%A8%E5%8C%96%E8%A7%A3%E5%86%B3Hexo%E5%9B%BE%E7%89%87%E5%BC%95%E7%94%A8%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/image-20220214122837301.png" class><p>æˆåŠŸï¼ï¼</p>]]></content>
    
    
    <categories>
      
      <category>è‡ªåŠ¨åŒ–åŠå…¬</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>Python</tag>
      
      <tag>è‡ªåŠ¨åŒ–åŠå…¬</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexoåšå®¢å¼•ç”¨å›¾ç‰‡æ— æ³•æ˜¾ç¤º</title>
    <link href="/2022/02/13/hexo/Hexo%E5%8D%9A%E5%AE%A2%E5%BC%95%E7%94%A8%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA/"/>
    <url>/2022/02/13/hexo/Hexo%E5%8D%9A%E5%AE%A2%E5%BC%95%E7%94%A8%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="Hexoåšå®¢å¼•ç”¨å›¾ç‰‡æ— æ³•æ˜¾ç¤º"><a href="#Hexoåšå®¢å¼•ç”¨å›¾ç‰‡æ— æ³•æ˜¾ç¤º" class="headerlink" title="Hexoåšå®¢å¼•ç”¨å›¾ç‰‡æ— æ³•æ˜¾ç¤º"></a>Hexoåšå®¢å¼•ç”¨å›¾ç‰‡æ— æ³•æ˜¾ç¤º</h1><p>ä»Šå¤©å¼€å§‹ç¼–å†™åšå®¢çš„æ—¶å€™ï¼Œå‘ç°ç”¨Typoraç¼–å†™çš„æ–‡ç« å¼•ç”¨å›¾ç‰‡ç¼–è¯‘åæ€»æ˜¯ä¸èƒ½æ­£å¸¸æ˜¾ç¤º</p><p>äºæ˜¯å¼€å§‹å„ç§ç™¾åº¦ï¼Œå‡ºæ¥çš„éƒ½æ˜¯ä¸‹è½½ä¸€ä¸ªè·¯å¾„è½¬æ¢<code>hexo-asset-image</code>çš„æ’ä»¶</p><p><code>hexo-asset-image</code>ä½¿ç”¨è¯´æ˜ï¼š</p><p><code>npm install hexo-asset-image --save</code></p><img src="/2022/02/13/hexo/Hexo%E5%8D%9A%E5%AE%A2%E5%BC%95%E7%94%A8%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA/image-20220213174631295.png" class title="This is an example image"><p>å¯ä¸€é¡¿æ“ä½œè¿‡åï¼Œè¿˜æ˜¯ä¸èƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºï¼›</p><img src="/2022/02/13/hexo/Hexo%E5%8D%9A%E5%AE%A2%E5%BC%95%E7%94%A8%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA/image-20220213174756400.png" class title="This is an example image"><p>ç„¶åå¾—åˆ°äº†ä¸€ä»½index.jsè„šæœ¬çš„è„šæœ¬ï¼Œæ›¿æ¢æ‰åšå®¢ç›®å½•ä¸‹node_modules&#x2F;hexo-ass-image&#x2F;index.jsï¼Œå¹¶ä½¿ç”¨æ ‡ç­¾æ’ä»¶æ–¹å¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></div></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-meta">&#x27;use strict&#x27;</span>;<br><span class="hljs-keyword">var</span> cheerio = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cheerio&#x27;</span>);<br><br><span class="hljs-comment">// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-string</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getPosition</span>(<span class="hljs-params">str, m, i</span>) &#123;<br>  <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">split</span>(m, i).<span class="hljs-title function_">join</span>(m).<span class="hljs-property">length</span>;<br>&#125;<br><br><span class="hljs-keyword">var</span> version = <span class="hljs-title class_">String</span>(hexo.<span class="hljs-property">version</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>);<br>hexo.<span class="hljs-property">extend</span>.<span class="hljs-property">filter</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">&#x27;after_post_render&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)&#123;<br>  <span class="hljs-keyword">var</span> config = hexo.<span class="hljs-property">config</span>;<br>  <span class="hljs-keyword">if</span>(config.<span class="hljs-property">post_asset_folder</span>)&#123;<br>    <span class="hljs-keyword">var</span> link = data.<span class="hljs-property">permalink</span>;<br><span class="hljs-keyword">if</span>(version.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-title class_">Number</span>(version[<span class="hljs-number">0</span>]) == <span class="hljs-number">3</span>)<br>   <span class="hljs-keyword">var</span> beginPos = <span class="hljs-title function_">getPosition</span>(link, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">1</span>) + <span class="hljs-number">1</span>;<br><span class="hljs-keyword">else</span><br>   <span class="hljs-keyword">var</span> beginPos = <span class="hljs-title function_">getPosition</span>(link, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">4</span>) + <span class="hljs-number">1</span>;     <span class="hljs-comment">//markdownçš„æœ¬åœ°è·¯å¾„æ˜¯xxx/x.jpg    hexo gç¼–è¯‘ååŠ ä¸Šè¿™å¥å°±æ˜¯public/2020/05/26/xxx/xx.jpg å‰4ä¸ªæ–‡ä»¶+åä¸€ä¸ªå›¾ç‰‡~</span><br><span class="hljs-comment">// In hexo 3.1.1, the permalink of &quot;about&quot; page is like &quot;.../about/index.html&quot;.</span><br><span class="hljs-keyword">var</span> endPos = link.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">&#x27;/&#x27;</span>) + <span class="hljs-number">1</span>;<br>    link = link.<span class="hljs-title function_">substring</span>(beginPos, endPos);<br><br>    <span class="hljs-keyword">var</span> toprocess = [<span class="hljs-string">&#x27;excerpt&#x27;</span>, <span class="hljs-string">&#x27;more&#x27;</span>, <span class="hljs-string">&#x27;content&#x27;</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; toprocess.<span class="hljs-property">length</span>; i++)&#123;<br>      <span class="hljs-keyword">var</span> key = toprocess[i];<br> <br>      <span class="hljs-keyword">var</span> $ = cheerio.<span class="hljs-title function_">load</span>(data[key], &#123;<br>        <span class="hljs-attr">ignoreWhitespace</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">xmlMode</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">lowerCaseTags</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">decodeEntities</span>: <span class="hljs-literal">false</span><br>      &#125;);<br><br>      $(<span class="hljs-string">&#x27;img&#x27;</span>).<span class="hljs-title function_">each</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span> ($(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;src&#x27;</span>))&#123;<br><span class="hljs-comment">// For windows style path, we replace &#x27;\&#x27; to &#x27;/&#x27;.</span><br><span class="hljs-keyword">var</span> src = $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;src&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-regexp">/http[s]*.*|\/\/.*/</span>.<span class="hljs-title function_">test</span>(src) &amp;&amp;<br>   !<span class="hljs-regexp">/^\s*\//</span>.<span class="hljs-title function_">test</span>(src)) &#123;<br>  <span class="hljs-comment">// For &quot;about&quot; page, the first part of &quot;src&quot; can&#x27;t be removed.</span><br>  <span class="hljs-comment">// In addition, to support multi-level local directory.</span><br>  <span class="hljs-keyword">var</span> linkArray = link.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;/&#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>)&#123;<br><span class="hljs-keyword">return</span> elem != <span class="hljs-string">&#x27;&#x27;</span>;<br>  &#125;);<br>  <span class="hljs-keyword">var</span> srcArray = src.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;/&#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>)&#123;<br><span class="hljs-keyword">return</span> elem != <span class="hljs-string">&#x27;&#x27;</span> &amp;&amp; elem != <span class="hljs-string">&#x27;.&#x27;</span>;<br>  &#125;);<br>  <span class="hljs-keyword">if</span>(srcArray.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span>)<br>srcArray.<span class="hljs-title function_">shift</span>();<br>  src = srcArray.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;/&#x27;</span>);<br>  $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;src&#x27;</span>, config.<span class="hljs-property">root</span> + link + src);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-property">info</span>&amp;&amp;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&quot;update link as:--&gt;&quot;</span>+config.<span class="hljs-property">root</span> + link + src);<br>&#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-property">info</span>&amp;&amp;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&quot;no src attr, skipped...&quot;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-property">info</span>&amp;&amp;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>($(<span class="hljs-variable language_">this</span>));<br>&#125;<br>      &#125;);<br>      data[key] = $.<span class="hljs-title function_">html</span>();<br>    &#125;<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡äº†<br>ä½†æ˜¯è¯·<strong>æ³¨æ„</strong>ï¼šè¿™é‡Œå›¾ç‰‡çš„å¼•å…¥å’Œé¡¹ç›®ç›®å½•ååˆ†é‡è¦</p><img src="/2022/02/13/hexo/Hexo%E5%8D%9A%E5%AE%A2%E5%BC%95%E7%94%A8%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA/5fa161ad.png" class title="This is an example image"><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œmarkdownæ–‡ä»¶åº”ä¸å…¶åŒåæ–‡ä»¶å¤¹åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œä¸”å¼•å…¥å›¾ç‰‡æ—¶æœ‰ç‰¹æ®Šè§„èŒƒ <code>asset_img</code>ä¸ºå›ºå®šå†™æ³•ï¼Œ åé¢ç›´æ¥è·Ÿæ–‡ä»¶å¤¹ä¸‹å›¾ç‰‡åç§°ï¼Œæœ€åä¸ºå›¾ç‰‡æè¿°ã€‚</p><p><strong>æœ€åå¼•å…¥ç»“æœï¼š</strong></p><img src="/2022/02/13/hexo/Hexo%E5%8D%9A%E5%AE%A2%E5%BC%95%E7%94%A8%E5%9B%BE%E7%89%87%E6%97%A0%E6%B3%95%E6%98%BE%E7%A4%BA/c8eb51ec.png" class title="This is an example image"><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼šå¼•å…¥æˆåŠŸï¼</p>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo æ­å»ºä¸ªäººåšå®¢</title>
    <link href="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Hexo-æ­å»ºä¸ªäººåšå®¢"><a href="#Hexo-æ­å»ºä¸ªäººåšå®¢" class="headerlink" title="Hexo æ­å»ºä¸ªäººåšå®¢"></a>Hexo æ­å»ºä¸ªäººåšå®¢</h1><h2 id="0-è¯´æ˜"><a href="#0-è¯´æ˜" class="headerlink" title="0.è¯´æ˜"></a>0.è¯´æ˜</h2><p>æœ¬é¡¹ç›®åŸºäºWindows10åˆ©ç”¨Hexoéƒ¨ç½²ä¸ªäººåšå®¢å¹¶ä¸”æŠ•æ”¾è‡³GitHub</p><h2 id="1-ä¸‹è½½node-js"><a href="#1-ä¸‹è½½node-js" class="headerlink" title="1.ä¸‹è½½node.js"></a>1.ä¸‹è½½node.js</h2><p>é¡ºå¸¦ä¸‹è½½npm</p><p>ç›´æ¥åœ¨å®˜ç½‘ä¸‹è½½ï¼Œæœ¬æ–‡ä¸ä½œè¯´æ˜</p><h2 id="2-æŸ¥çœ‹ç¯å¢ƒ"><a href="#2-æŸ¥çœ‹ç¯å¢ƒ" class="headerlink" title="2.æŸ¥çœ‹ç¯å¢ƒ"></a>2.æŸ¥çœ‹ç¯å¢ƒ</h2><p>node -v</p><p>npm -v</p><p>å¦‚æœæ²¡æœ‰å¼‚å¸¸åˆ™ä¸‹è½½æˆåŠŸ</p><h2 id="3-åˆ‡æ¢é•œåƒ"><a href="#3-åˆ‡æ¢é•œåƒ" class="headerlink" title="3.åˆ‡æ¢é•œåƒ"></a>3.åˆ‡æ¢é•œåƒ</h2><p>npm install -g cnpm â€“registry&#x3D;<a href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a></p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212123235109.png" class title="This is an example image"><h2 id="4-ä¸‹è½½hexo"><a href="#4-ä¸‹è½½hexo" class="headerlink" title="4.ä¸‹è½½hexo"></a>4.ä¸‹è½½hexo</h2><p>cnpm install -g hexo-cli</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212123235109.png" class title="This is an example image"><p>hexo -væŸ¥çœ‹ç‰ˆæœ¬</p><h2 id="5-åˆå§‹åŒ–åšå®¢"><a href="#5-åˆå§‹åŒ–åšå®¢" class="headerlink" title="5.åˆå§‹åŒ–åšå®¢"></a>5.åˆå§‹åŒ–åšå®¢</h2><p>hexo init</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212123658729.png" class title="This is an example image"><p>åˆå§‹åŒ–ç»“æœï¼š</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212123731036.png" class title="This is an example image"><h2 id="6-å¯åŠ¨åšå®¢"><a href="#6-å¯åŠ¨åšå®¢" class="headerlink" title="6.å¯åŠ¨åšå®¢"></a>6.å¯åŠ¨åšå®¢</h2><p>hexo s</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212124240300.png" class title="This is an example image"><p>åˆå§‹åŒ–ç»“æœ</p><h2 id="7-å†™åšå®¢"><a href="#7-å†™åšå®¢" class="headerlink" title="7.å†™åšå®¢"></a>7.å†™åšå®¢</h2><p>hexo n â€œMy first blogâ€</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212124523578.png" class title="This is an example image"><p>å¯¹è¯¥ç›®å½•ä¸‹markdownè¿›è¡Œç¼–è¾‘</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212124815007.png" class title="This is an example image"><p>ç¼–è¾‘ç»“æŸå</p><p>hexo clean</p><p>hexo g</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212125017647.png" class title="This is an example image"><p>hexo s</p><p>ç»“æœï¼š</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212125137499.png" class title="This is an example image"><h2 id="8-æŠ•æ”¾è‡³GitHub"><a href="#8-æŠ•æ”¾è‡³GitHub" class="headerlink" title="8.æŠ•æ”¾è‡³GitHub"></a>8.æŠ•æ”¾è‡³GitHub</h2><h3 id="8-1-åˆ›å»ºGitHubé¡¹ç›®"><a href="#8-1-åˆ›å»ºGitHubé¡¹ç›®" class="headerlink" title="8.1 åˆ›å»ºGitHubé¡¹ç›®"></a>8.1 åˆ›å»ºGitHubé¡¹ç›®</h3><p>å‘½åå¿…é¡»ç¬¦åˆè§„èŒƒï¼šname.github.io</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212130118069.png" class title="This is an example image"><h3 id="8-2ä¸‹è½½gitå¸®åŠ©"><a href="#8-2ä¸‹è½½gitå¸®åŠ©" class="headerlink" title="8.2ä¸‹è½½gitå¸®åŠ©"></a>8.2ä¸‹è½½gitå¸®åŠ©</h3><p>npm install hexo-deployer-git â€“save</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212130405182.png" class title="This is an example image"><h3 id="8-3è®¾ç½®-config-yml"><a href="#8-3è®¾ç½®-config-yml" class="headerlink" title="8.3è®¾ç½®_config.yml"></a>8.3è®¾ç½®_config.yml</h3><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212130741480.png" class title="This is an example image"><h3 id="8-4-ä¿®æ”¹Deployment"><a href="#8-4-ä¿®æ”¹Deployment" class="headerlink" title="8.4 ä¿®æ”¹Deployment"></a>8.4 ä¿®æ”¹Deployment</h3><p>ä¿®æ”¹å‰ï¼š</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212131006177.png" class title="This is an example image"><p>ä¿®æ”¹åï¼š</p><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212123235109.png" class title="This is an example image"><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212141732952.png" class title="This is an example image"><p>hexo g -d</p><h3 id="8-4æˆåŠŸéƒ¨ç½²"><a href="#8-4æˆåŠŸéƒ¨ç½²" class="headerlink" title="8.4æˆåŠŸéƒ¨ç½²"></a>8.4æˆåŠŸéƒ¨ç½²</h3><img src="/2022/02/13/hexo/Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%80%EF%BC%89/image-20220212141749479.png" class title="This is an example image"><p><strong>è‡³æ­¤æ‰€æœ‰éƒ¨ç½²å·²ç»å®Œæˆ</strong> </p>]]></content>
    
    
    <categories>
      
      <category>Hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
